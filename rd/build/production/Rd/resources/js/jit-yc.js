var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=a;if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(d,c,b){var e=this.length;d=Number(d);c=Number(c);b=Number(b!=null?b:e);if(d<c){b=Math.min(b,e);while(c<b){if(c in this){this[d++]=this[c++]}else {delete this[d++];c++}}}else {b=Math.min(b,e+c-d);d+=b-c;while(b>c){if(--b in this){this[--d]=this[b]}else {delete this[d]}}}return this};return b},'es6','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global['Symbol']){$jscomp.global['Symbol']=$jscomp.Symbol}};$jscomp.Symbol=function(){var a=0;function Symbol(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}return Symbol}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global['Symbol'].iterator;if(!a){a=$jscomp.global['Symbol'].iterator=$jscomp.global['Symbol']('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global['Symbol'].iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,c){return [b,c]})};return b},'es6','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(f,c,b){var d=this.length||0;if(c<0){c=Math.max(0,d+c)}if(b==null||b>d){b=d}b=Number(b);if(b<0){b=Math.max(0,d+b)}for(var e=Number(c||0);e<b;e++){this[e]=f}return this};return b},'es6','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=String(a)}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).v};return b},'es6','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).i};return b},'es6','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(b,c,g){$jscomp.initSymbolIterator();c=c!=null?c:function(d){return d};var e=[];var f=b[Symbol.iterator];if(typeof f=='function'){b=f.call(b);var h;var j=0;while(!(h=b.next()).done){e.push(c.call(g,h.value,j++))}}else {var i=b.length;for(var d=0;d<i;d++){e.push(c.call(g,b[d],d))}}return e};return b},'es6','es3');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(b,c){if(b===c){return b!==0||1/b===1/c}else {return b!==b&&c!==c}};return b},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){if(a){return a}var b=function(d,g){var c=this;if(c instanceof String){c=String(c)}var f=c.length;var b=g||0;if(b<0){b=Math.max(b+f,0)}for(;b<f;b++){var e=c[b];if(e===d||Object.is(e,d)){return !0}}return !1};return b},'es7','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b){return b})};return b},'es6','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(b){return Array.from(arguments)};return b},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(c,b){return b})};return b},'es8','es3');$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var d=b[a];b[a]=null;try{d()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(d){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(d){return function(e){if(!a){a=!0;d.call(b,e)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_(b)}else {if(isObject(b)){this.resolveToNonPromiseObj_(b)}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,b)}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(d,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+d+', '+a+'): Promise already settled in state'+this.state_)}this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){for(var a=0;a<this.onSettledCallbacks_.length;++a){d.asyncExecute(this.onSettledCallbacks_[a])}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,d){var a=this.createResolveAndReject_();try{b.call(d,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(f,g){var b;var d;var e=new a(function(a,e){b=a;d=e});function createCallback(a,e){if(typeof a=='function'){return function(h){try{b(a(h))}catch(i){d(i)}}}else {return e}}this.callWhenSettled_(createCallback(f,b),createCallback(g,d));return e};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(e,f){var a=this;function callback(){switch(a.state_){case b.FULFILLED:e(a.result_);break;case b.REJECTED:f(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(callback)}};function resolvingPromise(b){if(b instanceof a){return b}else {return new a(function(a,d){a(b)})}}a['resolve']=resolvingPromise;a['reject']=function(b){return new a(function(d,a){a(b)})};a['race']=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var a=d.next();!a.done;a=d.next()){resolvingPromise(a.value).callWhenSettled_(e,f)}})};a['all']=function(e){var d=$jscomp.makeIterator(e);var b=d.next();if(b.done){return resolvingPromise([])}else {return new a(function(g,h){var a=[];var f=0;function onFulfilled(b){return function(d){a[b]=d;f--;if(f==0){g(a)}}}do{a.push(undefined);f++;resolvingPromise(b.value).callWhenSettled_(onFulfilled(a.length-1),h);b=d.next()}while(!b.done)})}};return a},'es6','es3');$jscomp.polyfill('Promise.prototype.finally',function(a){if(a){return a}var b=function(b){return this.then(function(d){var c=Promise.resolve(b());return c.then(function(){return d})},function(d){var c=Promise.resolve(b());return c.then(function(){throw d})})};return b},'es9','es3');$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0};var a={};try{a.__proto__=b;return a.a}catch(c){}return !1};$jscomp.setPrototypeOf=typeof Object.setPrototypeOf=='function'?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(a instanceof Object){return}throw new TypeError('Iterator result '+a+' is not an object')};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=undefined;this.nextAddress=1;this.catchAddress_=0;this.finallyAddress_=0;this.abruptCompletion_=null;this.finallyContexts_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_){throw new TypeError('Generator is already running')}this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype['return']=function(a){this.abruptCompletion_={'return':a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(b,a){this.nextAddress=a;return {value:b}};$jscomp.generator.Context.prototype.yieldAll=function(d,b){var c=$jscomp.makeIterator(d);var a=c.next();$jscomp.generator.ensureIteratorResultIsObject_(a);if(a.done){this.yieldResult=a.value;this.nextAddress=b;return}this.yieldAllIterator_=c;return this.yield(a.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(b,a){this.catchAddress_=b;if(a!=undefined){this.finallyAddress_=a}};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(b,a){this.nextAddress=b;this.catchAddress_=a||0};$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;var b=this.abruptCompletion_.exception;this.abruptCompletion_=null;return b};$jscomp.generator.Context.prototype.enterFinallyBlock=function(c,b,a){if(!a){this.finallyContexts_=[this.abruptCompletion_]}else {this.finallyContexts_[a]=this.abruptCompletion_}this.catchAddress_=c||0;this.finallyAddress_=b||0};$jscomp.generator.Context.prototype.leaveFinallyBlock=function(d,c){var b=this.finallyContexts_.splice(c||0)[0];var a=this.abruptCompletion_=this.abruptCompletion_||b;if(a){if(a.isException){return this.jumpToErrorHandler_()}if(a.jumpTo!=undefined&&this.finallyAddress_<a.jumpTo){this.nextAddress=a.jumpTo;this.abruptCompletion_=null}else {this.nextAddress=this.finallyAddress_}}else {this.nextAddress=d}};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a){this.properties_.push(b)}this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){while(this.properties_.length>0){var a=this.properties_.pop();if(a in this.object_){return a}}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context();this.program_=a};$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_)}this.context_.next_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.return_=function(b){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a){var c='return' in a?a['return']:function(a){return {value:a,done:!0}};return this.yieldAllStep_(c,b,this.context_['return'])}this.context_['return'](b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_['throw'],a,this.context_.next_)}this.context_.throw_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.yieldAllStep_=function(d,e,c){try{var a=d.call(this.context_.yieldAllIterator_,e);$jscomp.generator.ensureIteratorResultIsObject_(a);if(!a.done){this.context_.stop_();return a}var b=a.value}catch(f){this.context_.yieldAllIterator_=null;this.context_.throw_(f);return this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.nextStep_=function(){while(this.context_.nextAddress){try{var b=this.program_(this.context_);if(b){this.context_.stop_();return {value:b.value,done:!1}}}catch(c){this.context_.yieldResult=undefined;this.context_.throw_(c)}}this.context_.stop_();if(this.context_.abruptCompletion_){var a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException){throw a.exception}return {value:a['return'],done:!0}}return {value:undefined,done:!0}};$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this['throw']=function(b){return a.throw_(b)};this['return']=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(b,c){var a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));if($jscomp.setPrototypeOf){$jscomp.setPrototypeOf(a,b.prototype)}return a};$jscomp.asyncExecutePromiseGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(d){if(d.done){b(d.value)}else {Promise.resolve(d.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={};var b=Object.create(new $jscomp.global['Proxy'](a,{'get':function(d,e,c){return d==a&&e=='q'&&c==b}}));return b['q']===!0}catch(c){return !1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new c([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE){return c}}else {if(isConformant()){return c}}var a='$jscomp_hidden_'+Math.random();function insert(b){if(!$jscomp.owns(b,a)){var d={};$jscomp.defineProperty(b,a,{value:d})}}function patch(a){var b=Object[a];if(b){Object[a]=function(d){insert(d);return b(d)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=$jscomp.makeIterator(a);var b;while(!(b=f.next()).done){var e=b.value;this.set(e[0],e[1])}}};b.prototype.set=function(b,d){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=d;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6','es3');$jscomp.MapEntry=function(){this.previous;this.next;this.head;this.key;this.value};$jscomp.polyfill('Map',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(i){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap();var a=function(a){this.data_={};this.head_=f();this.size=0;if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.set(d[0],d[1])}}};a.prototype.set=function(d,e){d=d===0?0:d;var a=c(this,d);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:d,value:e};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=e}return this};a.prototype['delete']=function(d){var a=c(this,d);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};a.prototype.has=function(a){return !!c(this,a).entry};a.prototype.get=function(d){var a=c(this,d).entry;return a&&a.value};a.prototype.entries=function(){return d(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return d(this,function(a){return a.key})};a.prototype.values=function(){return d(this,function(a){return a.value})};a.prototype.forEach=function(e,d){var f=this.entries();var c;while(!(c=f.next()).done){var a=c.value;e.call(d,a[1],a[0],this)}};a.prototype[Symbol.iterator]=a.prototype.entries;var c=function(g,e){var f=h(e);var a=g.data_[f];if(a&&$jscomp.owns(g.data_,f)){for(var d=0;d<a.length;d++){var c=a[d];if(e!==e&&c.key!==c.key||e===c.key){return {id:f,list:a,index:d,entry:c}}}}return {id:f,list:a,index:-1,entry:undefined}};var d=function(c,d){var a=c.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=c.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:d(a)}}a=null}return {done:!0,value:void 0}})};var f=function(){var a={};a.previous=a.next=a.head=a;return a};var g=0;var h=function(a){var c=a&&typeof a;if(c=='object'||c=='function'){a=a;if(!e.has(a)){var d=''+ ++g;e.set(a,d);return d}return e.get(a)}return 'p_'+a};return a},'es6','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};return b},'es6','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var f=b;var g=1;var c=b;var d=0;var e=1;while(d!=c){f*=b;e*=-1;c=(d=c)+e*f/++g}return c}return Math.log(1+b)};return b},'es6','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(c){c=Number(c);return (a(c)-a(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(b){if(b===0){return b}b=Number(b);var c=Math.pow(Math.abs(b),1/3);return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(b){b=Number(b)>>>0;if(b===0){return 32}var c=0;if((b&4.29490176E9)===0){b<<=16;c+=16}if((b&4.27819008E9)===0){b<<=8;c+=8}if((b&4.02653184E9)===0){b<<=4;c+=4}if((b&3.221225472E9)===0){b<<=2;c+=2}if((b&2.147483648E9)===0){c++}return c};return b},'es6','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);return (b(c)+b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var e=b;var f=1;var c=b;var d=0;while(d!=c){e*=b/++f;c=(d=c)+e}return c}return Math.exp(b)-1};return b},'es6','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(d,e,h){d=Number(d);e=Number(e);var b,g,f;var c=Math.max(Math.abs(d),Math.abs(e));for(b=2;b<arguments.length;b++){c=Math.max(c,Math.abs(arguments[b]))}if(c>1.0E100||c<1.0E-100){if(!c){return c}d=d/c;e=e/c;f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b])/c;f+=g*g}return Math.sqrt(f)*c}else {f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b]);f+=g*g}return Math.sqrt(f)}};return b},'es6','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(b,c){b=Number(b);c=Number(c);var f=b>>>16&65535;var d=b&65535;var g=c>>>16&65535;var e=c&65535;var h=f*e+d*g<<16>>>0;return d*e+h|0};return b},'es6','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN10};return b},'es6','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN2};return b},'es6','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(b){b=Number(b);return b===0||isNaN(b)?b:b>0?1:-1};return b},'es6','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);if(c===0){return c}return (b(c)-b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.exp(-2*Math.abs(b));var d=(1-c)/(1+c);return b<0?-d:d};return b},'es6','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0){return b}var c=Math.floor(Math.abs(b));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(b){if(typeof b!=='number'){return !1}return !isNaN(b)&&b!==Infinity&&b!==-Infinity};return b},'es6','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(b){if(!Number.isFinite(b)){return !1}return b===Math.floor(b)};return b},'es6','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(b){return typeof b==='number'&&isNaN(b)};return b},'es6','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER};return b},'es6','es3');$jscomp.polyfill('Number.parseFloat',function(a){return a||parseFloat},'es6','es3');$jscomp.polyfill('Number.parseInt',function(a){return a||parseInt},'es6','es3');$jscomp.assign=typeof Object.assign=='function'?Object.assign:function(d,e){for(var c=1;c<arguments.length;c++){var a=arguments[c];if(!a){continue}for(var b in a){if($jscomp.owns(a,b)){d[b]=a[b]}}}return d};$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');$jscomp.polyfill('Object.entries',function(a){if(a){return a}var b=function(c){var d=[];for(var b in c){if($jscomp.owns(c,b)){d.push([b,c[b]])}}return d};return b},'es8','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6','es5');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(c){return c.substring(0,a.length)==a}var c=function(e){var f=[];var c=Object.getOwnPropertyNames(e);var d=Object.getOwnPropertySymbols(e);for(var a=0;a<c.length;a++){(isSymbol(c[a])?d:f).push(c[a])}return f.concat(d)};return c},'es6','es5');$jscomp.polyfill('Object.getOwnPropertyDescriptors',function(a){if(a){return a}var b=function(e){var d={};var c=Reflect.ownKeys(e);for(var b=0;b<c.length;b++){d[c[b]]=Object.getOwnPropertyDescriptor(e,c[b])}return d};return b},'es8','es5');$jscomp.polyfill('Object.setPrototypeOf',function(a){return a||$jscomp.setPrototypeOf},'es6','es5');$jscomp.polyfill('Object.values',function(a){if(a){return a}var b=function(b){var c=[];for(var d in b){if($jscomp.owns(b,d)){c.push(b[d])}}return c};return b},'es8','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(e,d,b){return c.call(e,d,b)};return b},'es6','es3');$jscomp.objectCreate=$jscomp.ASSUME_ES5||typeof Object.create=='function'?Object.create:function(b){var a=function(){};a.prototype=b;return new a()};$jscomp.construct=function(){function reflectConstructWorks(){function Base(){}function Derived(){}new Base();Reflect.construct(Base,[],Derived);return new Base() instanceof Base}if(typeof Reflect!='undefined'&&Reflect.construct){if(reflectConstructWorks()){return Reflect.construct}var b=Reflect.construct;var a=function(e,d,a){var c=b(e,d);if(a){Reflect.setPrototypeOf(c,a.prototype)}return c};return a}function construct(b,d,a){if(a===undefined){a=b}var f=a.prototype||Object.prototype;var c=$jscomp.objectCreate(f);var e=Function.prototype.apply;var g=e.call(b,c,d);return g||c}return construct}();$jscomp.polyfill('Reflect.construct',function(a){return $jscomp.construct},'es6','es3');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(e,d,c){try{Object.defineProperty(e,d,c);var b=Object.getOwnPropertyDescriptor(e,d);if(!b){return !1}return b.configurable===(c.configurable||!1)&&b.enumerable===(c.enumerable||!1)&&('value' in b?b.value===c.value&&b.writable===(c.writable||!1):b.get===c.get&&b.set===c.set)}catch(f){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(c,b){if(!$jscomp.owns(c,b)){return !0}try{return delete c[b]}catch(d){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(d,c,e){if(arguments.length<=2){return d[c]}var b=$jscomp.findDescriptor(d,c);if(b){return b.get?b.get.call(e):b.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(c,b){return b in c};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if($jscomp.ASSUME_ES5||typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(!($jscomp.ASSUME_ES5||typeof Object.preventExtensions=='function')){return function(){return !1}}var b=function(b){Object.preventExtensions(b);return !Object.isExtensible(b)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(b,d,e,f){var c=$jscomp.findDescriptor(b,d);if(!c){if(Reflect.isExtensible(b)){b[d]=e;return !0}return !1}if(c.set){c.set.call(arguments.length>3?f:b,e);return !0}else {if(c.writable&&!Object.isFrozen(b)){b[d]=e;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}else {if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;var c=function(c,d){try{b(c,d);return !0}catch(e){return !1}};return c}else {return null}}},'es6','es5');$jscomp.polyfill('Set',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}this.size=this.map_.size};a.prototype.add=function(a){a=a===0?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(c){var a=this.map_['delete'](c);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(c,a){var d=this;this.map_.forEach(function(e){return c.call(a,e,e,d)})};return a},'es6','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(b){var e=$jscomp.checkStringArgs(this,null,'codePointAt');var f=e.length;b=Number(b)||0;if(!(b>=0&&b<f)){return void 0}b=b|0;var c=e.charCodeAt(b);if(c<55296||c>56319||b+1===f){return c}var d=e.charCodeAt(b+1);if(d<56320||d>57343){return c}return (c-55296)*1024+d+9216};return b},'es6','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'endsWith');b=b+'';if(c===void 0){c=d.length}var f=Math.max(0,Math.min(c|0,d.length));var e=b.length;while(e>0&&f>0){if(d[--f]!=b[--e]){return !1}}return e<=0};return b},'es6','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(e){var c='';for(var d=0;d<arguments.length;d++){var b=Number(arguments[d]);if(b<0||b>1114111||b!==Math.floor(b)){throw new RangeError('invalid_code_point '+b)}if(b<=65535){c+=String.fromCharCode(b)}else {b-=65536;c+=String.fromCharCode(b>>>10&1023|55296);c+=String.fromCharCode(b&1023|56320)}}return c};return b},'es6','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'includes');return d.indexOf(b,c||0)!==-1};return b},'es6','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(b){var c=$jscomp.checkStringArgs(this,null,'repeat');if(b<0||b>1342177279){throw new RangeError('Invalid count value')}b=b|0;var d='';while(b){if(b&1){d+=c}if(b>>>=1){c+=c}}return d};return b},'es6','es3');$jscomp.stringPadding=function(c,a){var b=c!==undefined?String(c):' ';if(!(a>0)||!b){return ''}var d=Math.ceil(a/b.length);return b.repeat(d).substring(0,a)};$jscomp.polyfill('String.prototype.padEnd',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return b+$jscomp.stringPadding(c,e)};return b},'es8','es3');$jscomp.polyfill('String.prototype.padStart',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return $jscomp.stringPadding(c,e)+b};return b},'es8','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(b,g){var c=$jscomp.checkStringArgs(this,b,'startsWith');b=b+'';var h=c.length;var e=b.length;var f=Math.max(0,Math.min(g|0,c.length));var d=0;while(d<e&&f<h){if(c[f++]!=b[d++]){return !1}}return d>=e};return b},'es6','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(a,b)}else {for(var c in b){if(c=='prototype'){continue}if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}}a.superClass_=b.prototype};$jscomp.polyfill('WeakSet',function(a){function isConformant(){if(!a||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var b=new a([c]);if(!b.has(c)||b.has(d)){return !1}b['delete'](c);b.add(d);return !b.has(c)&&b.has(d)}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE){return a}}else {if(isConformant()){return a}}var b=function(b){this.map_=new WeakMap();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(b);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}};b.prototype.add=function(b){this.map_.set(b,!0);return this};b.prototype.has=function(b){return this.map_.has(b)};b.prototype['delete']=function(b){return this.map_['delete'](b)};return b},'es6','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}(function(){window.$jit=function(a){a=a||window;for(var b in $jit){if($jit[b].$extend){a[b]=$jit[b]}}};$jit.version='2.0.1';var a=function(a){return document.getElementById(a)};a.empty=function(){};a.extend=function(c,a){for(var b in a||{}){c[b]=a[b]}return c};a.lambda=function(a){return typeof a=='function'?a:function(){return a}};a.time=Date.now||function(){return +new Date()};a.splat=function(b){var c=a.type(b);return c?c!='array'?[b]:b:[]};a.type=function(b){var c=a.type.s.call(b).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(c!='object'){return c}if(b&&b.$$family){return b.$$family}return b&&b.nodeName&&b.nodeType==1?'element':c};a.type.s=Object.prototype.toString;a.each=function(b,d){var g=a.type(b);if(g=='object'){for(var e in b){d(b[e],e)}}else {for(var c=0,f=b.length;c<f;c++){d(b[c],c)}}};a.indexOf=function(b,c){if(Array.indexOf){return b.indexOf(c)}for(var a=0,d=b.length;a<d;a++){if(b[a]===c){return a}}return -1};a.map=function(d,c){var b=[];a.each(d,function(a,e){b.push(c(a,e))});return b};a.reduce=function(b,e,d){var a=b.length;if(a==0){return d}var c=arguments.length==3?d:b[--a];while(a--){c=e(c,b[a])}return c};a.merge=function(){var b={};for(var g=0,h=arguments.length;g<h;g++){var e=arguments[g];if(a.type(e)!='object'){continue}for(var f in e){var d=e[f],c=b[f];b[f]=c&&a.type(d)=='object'&&a.type(c)=='object'?a.merge(c,d):a.unlink(d)}}return b};a.unlink=function(b){var c;switch(a.type(b)){case 'object':c={};for(var e in b){c[e]=a.unlink(b[e])};break;case 'array':c=[];for(var d=0,f=b.length;d<f;d++){c[d]=a.unlink(b[d])};break;default:return b;}return c};a.zip=function(){if(arguments.length===0){return []}for(var a=0,d=[],f=arguments.length,e=arguments[0].length;a<e;a++){for(var b=0,c=[];b<f;b++){c.push(arguments[b][a])}d.push(c)}return d};a.rgbToHex=function(a,e){if(a.length<3){return null}if(a.length==4&&a[3]==0&&!e){return 'transparent'}var c=[];for(var b=0;b<3;b++){var d=(a[b]-0).toString(16);c.push(d.length==1?'0'+d:d)}return e?c:'#'+c.join('')};a.hexToRgb=function(a){if(a.length!=7){a=a.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);a.shift();if(a.length!=3){return null}var d=[];for(var c=0;c<3;c++){var b=a[c];if(b.length==1){b+=b}d.push(parseInt(b,16))}return d}else {a=parseInt(a.slice(1),16);return [a>>16,a>>8&255,a&255]}};a.destroy=function(b){a.clean(b);if(b.parentNode){b.parentNode.removeChild(b)}if(b.clearAttributes){b.clearAttributes()}};a.clean=function(e){for(var c=e.childNodes,b=0,d=c.length;b<d;b++){a.destroy(c[b])}};a.addEvent=function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,!1)}else {a.attachEvent('on'+c,b)}};a.addEvents=function(d,c){for(var b in c){a.addEvent(d,b,c[b])}};a.hasClass=function(b,a){return (' '+b.className+' ').indexOf(' '+a+' ')>-1};a.addClass=function(b,c){if(!a.hasClass(b,c)){b.className=b.className+' '+c}};a.removeClass=function(a,b){a.className=a.className.replace(new RegExp('(^|\\s)'+b+'(?:\\s|$)'),'$1')};a.getPos=function(c){var a=A(c);var b=z(c);return {x:a.x-b.x,y:a.y-b.y};function A(a){var b={x:0,y:0};while(a&&!x(a)){b.x+=a.offsetLeft;b.y+=a.offsetTop;a=a.offsetParent}return b}function z(a){var b={x:0,y:0};while(a&&!x(a)){b.x+=a.scrollLeft;b.y+=a.scrollTop;a=a.parentNode}return b}function x(a){return /^(?:body|html)$/i.test(a.tagName)}};a.event={get:function(b,a){a=a||window;return b||a.event},getWheel:function(a){return a.wheelDelta?a.wheelDelta/120:-(a.detail||0)/3},isRightClick:function(a){return a.which==3||a.button==2},getPos:function(a,c){c=c||window;a=a||c.event;var b=c.document;b=b.documentElement||b.body;if(a.touches&&a.touches.length){a=a.touches[0]}var d={x:a.pageX||a.clientX+b.scrollLeft,y:a.pageY||a.clientY+b.scrollTop};return d},stop:function(a){if(a.stopPropagation){a.stopPropagation()}a.cancelBubble=!0;if(a.preventDefault){a.preventDefault()}else {a.returnValue=!1}}};$jit.util=$jit.id=a;var b=function(c){c=c||{};var d=function(){for(var e in this){if(typeof this[e]!='function'){this[e]=a.unlink(this[e])}}this.constructor=d;if(b.prototyping){return this}var f=this.initialize?this.initialize.apply(this,arguments):this;this.$$family='class';return f};for(var e in b.Mutators){if(!c[e]){continue}c=b.Mutators[e](c,c[e]);delete c[e]}a.extend(d,this);d.constructor=b;d.prototype=c;return d};b.Mutators={Implements:function(c,d){a.each(a.splat(d),function(a){b.prototyping=a;var f=typeof a=='function'?new a():a;for(var e in f){if(!(e in c)){c[e]=f[e]}}delete b.prototyping});return c}};a.extend(b,{inherit:function(c,h){for(var e in h){var d=h[e];var f=c[e];var g=a.type(d);if(f&&g=='function'){if(d!=f){b.override(c,e,d)}}else {if(g=='object'){c[e]=a.merge(f,d)}else {c[e]=d}}}return c},override:function(d,a,e){var c=b.prototyping;if(c&&d[a]!=c[a]){c=null}var f=function(){var b=this.parent;this.parent=c?c[a]:d[a];var f=e.apply(this,arguments);this.parent=b;return f};d[a]=f}});b.prototype.implement=function(){var c=this.prototype;a.each(Array.prototype.slice.call(arguments||[]),function(a){b.inherit(c,a)});return this};$jit.Class=b;$jit.json={prune:function(b,a){this.each(b,function(c,d){if(d==a&&c.children){delete c.children;c.children=[]}})},getParent:function(d,c){if(d.id==c){return !1}var a=d.children;if(a&&a.length>0){for(var b=0;b<a.length;b++){if(a[b].id==c){return d}else {var e=this.getParent(a[b],c);if(e){return e}}}}return !1},getSubtree:function(a,d){if(a.id==d){return a}for(var b=0,c=a.children;c&&b<c.length;b++){var e=this.getSubtree(c[b],d);if(e!=null){return e}}return null},eachLevel:function(b,a,e,d){if(a<=e){d(b,a);if(!b.children){return}for(var c=0,f=b.children;c<f.length;c++){this.eachLevel(f[c],a+1,e,d)}}},each:function(a,b){this.eachLevel(a,0,Number.MAX_VALUE,b)}};$jit.Trans={$extend:!0,linear:function(a){return a}};var l=$jit.Trans;(function(){var b=function(c,b){b=a.splat(b);return a.extend(c,{easeIn:function(a){return c(a,b)},easeOut:function(a){return 1-c(1-a,b)},easeInOut:function(a){return a<=0.5?c(2*a,b)/2:(2-c(2*(1-a),b))/2}})};var c={Pow:function(b,a){return Math.pow(b,a[0]||6)},Expo:function(a){return Math.pow(2,8*(a-1))},Circ:function(a){return 1-Math.sin(Math.acos(a))},Sine:function(a){return 1-Math.sin((1-a)*Math.PI/2)},Back:function(b,a){a=a[0]||1.618;return Math.pow(b,2)*((a+1)*b-a)},Bounce:function(d){var c;for(var b=0,a=1;1;b+=a,a/=2){if(d>=(7-4*b)/11){c=a*a-Math.pow((11-6*b-11*d)/4,2);break}}return c},Elastic:function(a,b){return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b[0]||1)/3)}};a.each(c,function(c,a){l[a]=b(c)});a.each(['Quad','Cubic','Quart','Quint'],function(c,a){l[c]=b(function(b){return Math.pow(b,[a+2])})})})();var r=new b({initialize:function(a){this.setOptions(a)},setOptions:function(b){var c={duration:2500,fps:40,transition:l.Quart.easeInOut,compute:a.empty,complete:a.empty,link:'ignore'};this.opt=a.merge(c,b||{});return this},step:function(){var c=a.time(),b=this.opt;if(c<this.time+b.duration){var d=b.transition((c-this.time)/b.duration);b.compute(d)}else {this.timer=clearInterval(this.timer);b.compute(1);b.complete()}},start:function(){if(!this.check()){return this}this.time=0;this.startTimer();return this},startTimer:function(){var b=this,c=this.opt.fps;if(this.timer){return !1}this.time=a.time()-this.time;this.timer=setInterval(function(){b.step()},Math.round(1000/c));return !0},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer){return !1}this.time=a.time()-this.time;this.timer=clearInterval(this.timer);return !0},check:function(){if(!this.timer){return !0}if(this.opt.link=='cancel'){this.stopTimer();return !0}return !1}});var d=function(){var e=arguments;for(var b=0,g=e.length,c={};b<g;b++){var f=d[e[b]];if(f.$extend){a.extend(c,f)}else {c[e[b]]=f}}return c};d.AreaChart={$extend:!0,animate:!0,labelOffset:3,type:'stacked',Tips:{enable:!1,onShow:a.empty,onHide:a.empty},Events:{enable:!1,onClick:a.empty},selectOnHover:!0,showAggregates:!0,showLabels:!0,filterOnClick:!1,restoreOnRightClick:!1};d.Margin={$extend:!1,top:0,left:0,right:0,bottom:0};d.Canvas={$extend:!0,injectInto:'id',type:'2D',width:!1,height:!1,useCanvas:!1,withLabels:!0,background:!1,Scene:{Lighting:{enable:!1,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[0.5,0.3,0.1]}}}};d.Tree={$extend:!0,orientation:'left',subtreeOffset:8,siblingOffset:5,indent:10,multitree:!1,align:'center'};d.Node={$extend:!1,overridable:!1,type:'circle',color:'#ccb',alpha:1,dim:3,height:20,width:90,autoHeight:!1,autoWidth:!1,lineWidth:1,transform:!0,align:'center',angularWidth:1,span:1,CanvasStyles:{}};d.Edge={$extend:!1,overridable:!1,type:'line',color:'#ccb',lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}};d.Fx={$extend:!0,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:!0};d.Label={$extend:!1,overridable:!1,type:'HTML',style:' ',size:10,family:'sans-serif',textAlign:'center',textBaseline:'alphabetic',color:'#fff'};d.Tips={$extend:!1,enable:!1,type:'auto',offsetX:20,offsetY:20,force:!1,onShow:a.empty,onHide:a.empty};d.NodeStyles={$extend:!1,enable:!1,type:'auto',stylesHover:!1,stylesClick:!1};d.Events={$extend:!1,enable:!1,enableForEdges:!1,type:'auto',onClick:a.empty,onRightClick:a.empty,onMouseMove:a.empty,onMouseEnter:a.empty,onMouseLeave:a.empty,onDragStart:a.empty,onDragMove:a.empty,onDragCancel:a.empty,onDragEnd:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onMouseWheel:a.empty};d.Navigation={$extend:!1,enable:!1,type:'auto',panning:!1,zooming:!1};d.Controller={$extend:!0,onBeforeCompute:a.empty,onAfterCompute:a.empty,onCreateLabel:a.empty,onPlaceLabel:a.empty,onComplete:a.empty,onBeforePlotLine:a.empty,onAfterPlotLine:a.empty,onBeforePlotNode:a.empty,onAfterPlotNode:a.empty,request:!1};var q={initialize:function(c,a){this.viz=a;this.canvas=a.canvas;this.config=a.config[c];this.nodeTypes=a.fx.nodeTypes;var b=this.config.type;this.dom=b=='auto'?a.config.Label.type!='Native':b!='Native';this.labelContainer=this.dom&&a.labels.getLabelContainer();this.isEnabled()&&this.initializePost()},initializePost:a.empty,setAsProperty:a.lambda(!1),isEnabled:function(){return this.config.enable},isLabel:function(b,f,g){b=a.event.get(b,f);var d=this.labelContainer,c=b.target||b.srcElement,e=b.relatedTarget;if(g){return e&&e==this.viz.canvas.getCtx().canvas&&!!c&&this.isDescendantOf(c,d)}else {return this.isDescendantOf(c,d)}},isDescendantOf:function(a,b){while(a&&a.parentNode){if(a.parentNode==b){return a}a=a.parentNode}return !1}};var n={onMouseUp:a.empty,onMouseDown:a.empty,onMouseMove:a.empty,onMouseOver:a.empty,onMouseOut:a.empty,onMouseWheel:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onTouchCancel:a.empty};var v=new b({initialize:function(a){this.viz=a;this.canvas=a.canvas;this.node=!1;this.edge=!1;this.registeredObjects=[];this.attachEvents()},attachEvents:function(){var c=this.canvas.getElement(),b=this;c.oncontextmenu=a.lambda(!1);a.addEvents(c,{mouseup:function(d,c){var e=a.event.get(d,c);b.handleEvent('MouseUp',d,c,b.makeEventObject(d,c),a.event.isRightClick(e))},mousedown:function(d,c){var e=a.event.get(d,c);b.handleEvent('MouseDown',d,c,b.makeEventObject(d,c),a.event.isRightClick(e))},mousemove:function(a,c){b.handleEvent('MouseMove',a,c,b.makeEventObject(a,c))},mouseover:function(a,c){b.handleEvent('MouseOver',a,c,b.makeEventObject(a,c))},mouseout:function(a,c){b.handleEvent('MouseOut',a,c,b.makeEventObject(a,c))},touchstart:function(a,c){b.handleEvent('TouchStart',a,c,b.makeEventObject(a,c))},touchmove:function(a,c){b.handleEvent('TouchMove',a,c,b.makeEventObject(a,c))},touchend:function(a,c){b.handleEvent('TouchEnd',a,c,b.makeEventObject(a,c))}});var d=function(d,c){var e=a.event.get(d,c);var f=a.event.getWheel(e);b.handleEvent('MouseWheel',d,c,f)};if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){a.addEvent(c,'mousewheel',d)}else {c.addEventListener('DOMMouseScroll',d,!1)}},register:function(a){this.registeredObjects.push(a)},handleEvent:function(){var c=Array.prototype.slice.call(arguments),d=c.shift();for(var a=0,b=this.registeredObjects,e=b.length;a<e;a++){b[a]['on'+d].apply(b[a],c)}},makeEventObject:function(f,e){var b=this,c=this.viz.graph,d=this.viz.fx,h=d.nodeTypes,g=d.edgeTypes;return {pos:!1,node:!1,edge:!1,contains:!1,getNodeCalled:!1,getEdgeCalled:!1,getPos:function(){var c=b.viz.canvas,d=c.getSize(),g=c.getPos(),j=c.translateOffsetX,i=c.translateOffsetY,l=c.scaleOffsetX,k=c.scaleOffsetY,h=a.event.getPos(f,e);this.pos={x:(h.x-g.x-d.width/2-j)*1/l,y:(h.y-g.y-d.height/2-i)*1/k};return this.pos},getNode:function(){if(this.getNodeCalled){return this.node}this.getNodeCalled=!0;for(var j in c.nodes){var a=c.nodes[j],g=a&&h[a.getData('type')],i=g&&g.contains&&g.contains.call(d,a,this.getPos());if(i){this.contains=i;return b.node=this.node=a}}return b.node=this.node=!1},getEdge:function(){if(this.getEdgeCalled){return this.edge}this.getEdgeCalled=!0;var j={};for(var m in c.edges){var k=c.edges[m];j[m]=!0;for(var l in k){if(l in j){continue}var a=k[l],h=a&&g[a.getData('type')],i=h&&h.contains&&h.contains.call(d,a,this.getPos());if(i){this.contains=i;return b.edge=this.edge=a}}}return b.edge=this.edge=!1},getContains:function(){if(this.getNodeCalled){return this.contains}this.getNode();return this.contains}}}});var j={initializeExtras:function(){var c=new v(this),b=this;a.each(['NodeStyles','Tips','Navigation','Events'],function(d){var a=new j.Classes[d](d,b);if(a.isEnabled()){c.register(a)}if(a.setAsProperty()){b[d.toLowerCase()]=a}})}};j.Classes={};j.Classes.Events=new b({Implements:[q,n],initializePost:function(){this.fx=this.viz.fx;this.ntypes=this.viz.fx.nodeTypes;this.etypes=this.viz.fx.edgeTypes;this.hovered=!1;this.pressed=!1;this.touched=!1;this.touchMoved=!1;this.moved=!1},setAsProperty:a.lambda(!0),onMouseUp:function(d,f,c,e){var b=a.event.get(d,f);if(!this.moved){if(e){this.config.onRightClick(this.hovered,c,b)}else {this.config.onClick(this.pressed,c,b)}}if(this.pressed){if(this.moved){this.config.onDragEnd(this.pressed,c,b)}else {this.config.onDragCancel(this.pressed,c,b)}this.pressed=this.moved=!1}},onMouseOut:function(e,d,g){var c=a.event.get(e,d),f;if(this.dom&&(f=this.isLabel(e,d,!0))){this.config.onMouseLeave(this.viz.graph.getNode(f.id),g,c);this.hovered=!1;return}var b=c.relatedTarget,h=this.canvas.getElement();while(b&&b.parentNode){if(h==b.parentNode){return}b=b.parentNode}if(this.hovered){this.config.onMouseLeave(this.hovered,g,c);this.hovered=!1}},onMouseOver:function(b,d,f){var e=a.event.get(b,d),c;if(this.dom&&(c=this.isLabel(b,d,!0))){this.hovered=this.viz.graph.getNode(c.id);this.config.onMouseEnter(this.hovered,f,e)}},onMouseMove:function(g,f,b){var i,d=a.event.get(g,f);if(this.pressed){this.moved=!0;this.config.onDragMove(this.pressed,b,d);return}if(this.dom){this.config.onMouseMove(this.hovered,b,d)}else {if(this.hovered){var c=this.hovered;var e=c.nodeFrom?this.etypes[c.getData('type')]:this.ntypes[c.getData('type')];var h=e&&e.contains&&e.contains.call(this.fx,c,b.getPos());if(h){this.config.onMouseMove(c,b,d);return}else {this.config.onMouseLeave(c,b,d);this.hovered=!1}}if(this.hovered=b.getNode()||this.config.enableForEdges&&b.getEdge()){this.config.onMouseEnter(this.hovered,b,d)}else {this.config.onMouseMove(!1,b,d)}}},onMouseWheel:function(c,b,d){this.config.onMouseWheel(d,a.event.get(c,b))},onMouseDown:function(c,e,b){var f=a.event.get(c,e),d;if(this.dom){if(d=this.isLabel(c,e)){this.pressed=this.viz.graph.getNode(d.id)}}else {this.pressed=b.getNode()||this.config.enableForEdges&&b.getEdge()}this.pressed&&this.config.onDragStart(this.pressed,b,f)},onTouchStart:function(c,e,b){var f=a.event.get(c,e),d;if(this.dom&&(d=this.isLabel(c,e))){this.touched=this.viz.graph.getNode(d.id)}else {this.touched=b.getNode()||this.config.enableForEdges&&b.getEdge()}this.touched&&this.config.onTouchStart(this.touched,b,f)},onTouchMove:function(e,d,c){var b=a.event.get(e,d);if(this.touched){this.touchMoved=!0;this.config.onTouchMove(this.touched,c,b)}},onTouchEnd:function(e,d,c){var b=a.event.get(e,d);if(this.touched){if(this.touchMoved){this.config.onTouchEnd(this.touched,c,b)}else {this.config.onTouchCancel(this.touched,c,b)}this.touched=this.touchMoved=!1}}});j.Classes.Tips=new b({Implements:[q,n],initializePost:function(){if(document.body){var b=a('_tooltip')||document.createElement('div');b.id='_tooltip';b.className='tip';a.extend(b.style,{position:'absolute',display:'none',zIndex:2147483647});document.body.appendChild(b);this.tip=b;this.node=!1}},setAsProperty:a.lambda(!0),onMouseOut:function(c,d){var f=a.event.get(c,d);if(this.dom&&this.isLabel(c,d,!0)){this.hide(!0);return}var b=c.relatedTarget,e=this.canvas.getElement();while(b&&b.parentNode){if(e==b.parentNode){return}b=b.parentNode}this.hide(!1)},onMouseOver:function(c,b){var a;if(this.dom&&(a=this.isLabel(c,b,!1))){this.node=this.viz.graph.getNode(a.id);this.config.onShow(this.tip,this.node,a)}},onMouseMove:function(d,c,e){if(this.dom&&this.isLabel(d,c)){this.setTooltipPosition(a.event.getPos(d,c))}if(!this.dom){var b=e.getNode();if(!b){this.hide(!0);return}if(this.config.force||!this.node||this.node.id!=b.id){this.node=b;this.config.onShow(this.tip,b,e.getContains())}this.setTooltipPosition(a.event.getPos(d,c))}},setTooltipPosition:function(a){var d=this.tip,c=d.style,h=this.config;c.display='';var g={height:document.body.clientHeight,width:document.body.clientWidth};var b={width:d.offsetWidth,height:d.offsetHeight};var f=h.offsetX,e=h.offsetY;c.top=(a.y+e+b.height>g.height?a.y-b.height-e:a.y+e)+'px';c.left=(a.x+b.width+f>g.width?a.x-b.width-f:a.x+f)+'px'},hide:function(a){this.tip.style.display='none';a&&this.config.onHide()}});j.Classes.NodeStyles=new b({Implements:[q,n],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.nStyles=this.config;this.nodeStylesOnHover=this.nStyles.stylesHover;this.nodeStylesOnClick=this.nStyles.stylesClick;this.hoveredNode=!1;this.fx.nodeFxAnimation=new r();this.down=!1;this.move=!1},onMouseOut:function(b,c){this.down=this.move=!1;if(!this.hoveredNode){return}if(this.dom&&this.isLabel(b,c,!0)){this.toggleStylesOnHover(this.hoveredNode,!1)}var a=b.relatedTarget,d=this.canvas.getElement();while(a&&a.parentNode){if(d==a.parentNode){return}a=a.parentNode}this.toggleStylesOnHover(this.hoveredNode,!1);this.hoveredNode=!1},onMouseOver:function(d,c){var a;if(this.dom&&(a=this.isLabel(d,c,!0))){var b=this.viz.graph.getNode(a.id);if(b.selected){return}this.hoveredNode=b;this.toggleStylesOnHover(this.hoveredNode,!0)}},onMouseDown:function(b,e,c,d){if(d){return}var a;if(this.dom&&(a=this.isLabel(b,e))){this.down=this.viz.graph.getNode(a.id)}else {if(!this.dom){this.down=c.getNode()}}this.move=!1},onMouseUp:function(d,c,a,b){if(b){return}if(!this.move){this.onClick(a.getNode())}this.down=this.move=!1},getRestoredStyles:function(d,c){var b={},e=this['nodeStylesOn'+c];for(var a in e){b[a]=d.styles['$'+a]}return b},toggleStylesOnHover:function(a,b){if(this.nodeStylesOnHover){this.toggleStylesOn('Hover',a,b)}},toggleStylesOnClick:function(a,b){if(this.nodeStylesOnClick){this.toggleStylesOn('Click',a,b)}},toggleStylesOn:function(c,b,g){var d=this.viz;var j=this.nStyles;if(g){var i=this;if(!b.styles){b.styles=a.merge(b.data,{})}for(var e in this['nodeStylesOn'+c]){var f='$'+e;if(!(f in b.styles)){b.styles[f]=b.getData(e)}}d.fx.nodeFx(a.extend({elements:{id:b.id,properties:i['nodeStylesOn'+c]},transition:l.Quart.easeOut,duration:300,fps:40},this.config))}else {var h=this.getRestoredStyles(b,c);d.fx.nodeFx(a.extend({elements:{id:b.id,properties:h},transition:l.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(a){if(!a){return}var b=this.nodeStylesOnClick;if(!b){return}if(a.selected){this.toggleStylesOnClick(a,!1);delete a.selected}else {this.viz.graph.eachNode(function(c){if(c.selected){for(var d in b){c.setData(d,c.styles['$'+d],'end')}delete c.selected}});this.toggleStylesOnClick(a,!0);a.selected=!0;delete a.hovered;this.hoveredNode=!1}},onMouseMove:function(f,e,d){if(this.down){this.move=!0}if(this.dom&&this.isLabel(f,e)){return}var c=this.nodeStylesOnHover;if(!c){return}if(!this.dom){if(this.hoveredNode){var b=this.types[this.hoveredNode.getData('type')];var g=b&&b.contains&&b.contains.call(this.fx,this.hoveredNode,d.getPos());if(g){return}}var a=d.getNode();if(!this.hoveredNode&&!a){return}if(a.hovered){return}if(a&&!a.selected){this.fx.nodeFxAnimation.stopTimer();this.viz.graph.eachNode(function(a){if(a.hovered&&!a.selected){for(var b in c){a.setData(b,a.styles['$'+b],'end')}delete a.hovered}});a.hovered=!0;this.hoveredNode=a;this.toggleStylesOnHover(a,!0)}else {if(this.hoveredNode&&!this.hoveredNode.selected){this.fx.nodeFxAnimation.stopTimer();this.toggleStylesOnHover(this.hoveredNode,!1);delete this.hoveredNode.hovered;this.hoveredNode=!1}}}}});j.Classes.Navigation=new b({Implements:[q,n],initializePost:function(){this.pos=!1;this.pressed=!1},onMouseWheel:function(f,e,d){if(!this.config.zooming){return}a.event.stop(a.event.get(f,e));var c=this.config.zooming/1000,b=1+d*c;this.canvas.scale(b,b)},onMouseDown:function(d,c,b){if(!this.config.panning){return}if(this.config.panning=='avoid nodes'&&(this.dom?this.isLabel(d,c):b.getNode())){return}this.pressed=!0;this.pos=b.getPos();var a=this.canvas,h=a.translateOffsetX,g=a.translateOffsetY,f=a.scaleOffsetX,e=a.scaleOffsetY;this.pos.x*=f;this.pos.x+=h;this.pos.y*=e;this.pos.y+=g},onMouseMove:function(i,h,d){if(!this.config.panning){return}if(!this.pressed){return}if(this.config.panning=='avoid nodes'&&(this.dom?this.isLabel(i,h):d.getNode())){return}var c=this.pos,a=d.getPos(),b=this.canvas,g=b.translateOffsetX,l=b.translateOffsetY,f=b.scaleOffsetX,e=b.scaleOffsetY;a.x*=f;a.y*=e;a.x+=g;a.y+=l;var k=a.x-c.x,j=a.y-c.y;this.pos=a;this.canvas.translate(k*1/f,j*1/e)},onMouseUp:function(d,c,b,a){if(!this.config.panning){return}this.pressed=!1}});var i;(function(){var c=typeof HTMLCanvasElement,d=c=='object'||c=='function';function x(f,e){var b=document.createElement(f);for(var c in e){if(typeof e[c]=='object'){a.extend(b[c],e[c])}else {b[c]=e[c]}}if(f=='canvas'&&!d&&G_vmlCanvasManager){b=G_vmlCanvasManager.initElement(document.body.appendChild(b))}return b}$jit.Canvas=i=new b({canvases:[],pos:!1,element:!1,labelContainer:!1,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(e,b){this.viz=e;this.opt=this.config=b;var c=a.type(b.injectInto)=='string'?b.injectInto:b.injectInto.id,l=b.type,n=c+'-label',h=a(c),k=b.width||h.offsetWidth,m=b.height||h.offsetHeight;this.id=c;var f={injectInto:c,width:k,height:m};this.element=x('div',{id:c+'-canvaswidget',style:{position:'relative',width:k+'px',height:m+'px'}});this.labelContainer=this.createLabelContainer(b.Label.type,n,f);this.canvases.push(new i.Base[l]({config:a.extend({idSuffix:'-canvas'},f),plot:function(a){e.fx.plot()},resize:function(){e.refresh()}}));var g=b.background;if(g){var p=new i.Background[g.type](e,a.extend(g,f));this.canvases.push(new i.Base[l](p))}var d=this.canvases.length;while(d--){this.element.appendChild(this.canvases[d].canvas);if(d>0){this.canvases[d].plot()}}this.element.appendChild(this.labelContainer);h.appendChild(this.element);var j=null,o=this;a.addEvent(window,'scroll',function(){clearTimeout(j);j=setTimeout(function(){o.getPos(!0)},500)})},getCtx:function(a){return this.canvases[a||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(a){return this.canvases[a||0].getSize()},resize:function(b,d){this.getPos(!0);this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;for(var a=0,e=this.canvases.length;a<e;a++){this.canvases[a].resize(b,d)}var c=this.element.style;c.width=b+'px';c.height=d+'px';if(this.labelContainer){this.labelContainer.style.width=b+'px'}},translate:function(c,b,e){this.translateOffsetX+=c*this.scaleOffsetX;this.translateOffsetY+=b*this.scaleOffsetY;for(var a=0,d=this.canvases.length;a<d;a++){this.canvases[a].translate(c,b,e)}},scale:function(c,b,i){var e=this.scaleOffsetX*c,d=this.scaleOffsetY*b;var g=this.translateOffsetX*(c-1)/e,f=this.translateOffsetY*(b-1)/d;this.scaleOffsetX=e;this.scaleOffsetY=d;for(var a=0,h=this.canvases.length;a<h;a++){this.canvases[a].scale(c,b,!0)}this.translate(g,f,!1)},getPos:function(b){if(b||!this.pos){return this.pos=a.getPos(this.getElement())}return this.pos},clear:function(a){this.canvases[a||0].clear()},path:function(b,c){var a=this.canvases[0].getCtx();a.beginPath();c(a);a[b]();a.closePath()},createLabelContainer:function(e,g,c){var f='http://www.w3.org/2000/svg';if(e=='HTML'||e=='Native'){return x('div',{id:g,style:{overflow:'visible',position:'absolute',top:0,left:0,width:c.width+'px',height:0}})}else {if(e=='SVG'){var b=document.createElementNS(f,'svg:svg');b.setAttribute('width',c.width);b.setAttribute('height',c.height);var d=b.style;d.position='absolute';d.left=d.top='0px';var a=document.createElementNS(f,'svg:g');a.setAttribute('width',c.width);a.setAttribute('height',c.height);a.setAttribute('x',0);a.setAttribute('y',0);a.setAttribute('id',g);b.appendChild(a);return b}}}});i.Base={};i.Base['2D']=new b({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(a){this.viz=a;this.opt=a.config;this.size=!1;this.createCanvas();this.translateToCenter()},createCanvas:function(){var a=this.opt,b=a.width,c=a.height;this.canvas=x('canvas',{id:a.injectInto+a.idSuffix,width:b,height:c,style:{position:'absolute',top:0,left:0,width:b+'px',height:c+'px'}})},getCtx:function(){if(!this.ctx){return this.ctx=this.canvas.getContext('2d')}return this.ctx},getSize:function(){if(this.size){return this.size}var a=this.canvas;return this.size={width:a.width,height:a.height}},translateToCenter:function(a){var b=this.getSize(),d=a?b.width-a.width-this.translateOffsetX*2:b.width;height=a?b.height-a.height-this.translateOffsetY*2:b.height;var c=this.getCtx();a&&c.scale(1/this.scaleOffsetX,1/this.scaleOffsetY);c.translate(d/2,height/2)},resize:function(b,c){var f=this.getSize(),a=this.canvas,e=a.style;this.size=!1;a.width=b;a.height=c;e.width=b+'px';e.height=c+'px';if(!d){this.translateToCenter(f)}else {this.translateToCenter()}this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;this.clear();this.viz.resize(b,c,this)},translate:function(b,a,c){var e=this.scaleOffsetX,d=this.scaleOffsetY;this.translateOffsetX+=b*e;this.translateOffsetY+=a*d;this.getCtx().translate(b,a);!c&&this.plot()},scale:function(b,a,c){this.scaleOffsetX*=b;this.scaleOffsetY*=a;this.getCtx().scale(b,a);!c&&this.plot()},clear:function(){var a=this.getSize(),d=this.translateOffsetX,e=this.translateOffsetY,c=this.scaleOffsetX,b=this.scaleOffsetY;this.getCtx().clearRect((-a.width/2-d)*1/c,(-a.height/2-e)*1/b,a.width*1/c,a.height*1/b)},plot:function(){this.clear();this.viz.plot(this)}});i.Background={};i.Background.Circles=new b({initialize:function(c,b){this.viz=c;this.config=a.merge({idSuffix:'-bkcanvas',levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},b)},resize:function(b,c,a){this.plot(a)},plot:function(f){var i=f.canvas,a=f.getCtx(),c=this.config,d=c.CanvasStyles;for(var e in d){a[e]=d[e]}var g=c.numberOfCircles,h=c.levelDistance;for(var b=1;b<=g;b++){a.beginPath();a.arc(0,0,h*b,0,2*Math.PI,!1);a.stroke();a.closePath()}}})})();var h=function(b,a){this.theta=b||0;this.rho=a||0};$jit.Polar=h;h.prototype={getc:function(a){return this.toComplex(a)},getp:function(){return this},set:function(a){a=a.getp();this.theta=a.theta;this.rho=a.rho},setc:function(a,b){this.rho=Math.sqrt(a*a+b*b);this.theta=Math.atan2(b,a);if(this.theta<0){this.theta+=Math.PI*2}},setp:function(b,a){this.theta=b;this.rho=a},clone:function(){return new h(this.theta,this.rho)},toComplex:function(c){var a=Math.cos(this.theta)*this.rho;var b=Math.sin(this.theta)*this.rho;if(c){return {x:a,y:b}}return new f(a,b)},add:function(a){return new h(this.theta+a.theta,this.rho+a.rho)},scale:function(a){return new h(this.theta,this.rho*a)},equals:function(a){return this.theta==a.theta&&this.rho==a.rho},$add:function(a){this.theta=this.theta+a.theta;this.rho+=a.rho;return this},$madd:function(a){this.theta=(this.theta+a.theta)%(Math.PI*2);this.rho+=a.rho;return this},$scale:function(a){this.rho*=a;return this},isZero:function(){var b=1.0E-4,a=Math.abs;return a(this.theta)<b&&a(this.rho)<b},interpolate:function(g,e){var h=Math.PI,c=h*2;var f=function(a){var b=a<0?a%c+c:a%c;return b};var b=this.theta,a=g.theta;var d,i=Math.abs(b-a);if(i==h){if(b>a){d=f(a+(b-c-a)*e)}else {d=f(a-c+(b-a)*e)}}else {if(i>=h){if(b>a){d=f(a+(b-c-a)*e)}else {d=f(a-c+(b-(a-c))*e)}}else {d=f(a+(b-a)*e)}}var j=(this.rho-g.rho)*e+g.rho;return {theta:d,rho:j}}};var p=function(b,a){return new h(b,a)};h.KER=p(0,0);var f=function(a,b){this.x=a||0;this.y=b||0};$jit.Complex=f;f.prototype={getc:function(){return this},getp:function(a){return this.toPolar(a)},set:function(a){a=a.getc(!0);this.x=a.x;this.y=a.y},setc:function(a,b){this.x=a;this.y=b},setp:function(b,a){this.x=Math.cos(b)*a;this.y=Math.sin(b)*a},clone:function(){return new f(this.x,this.y)},toPolar:function(c){var b=this.norm();var a=Math.atan2(this.y,this.x);if(a<0){a+=Math.PI*2}if(c){return {theta:a,rho:b}}return new h(a,b)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(a){return new f(this.x+a.x,this.y+a.y)},prod:function(a){return new f(this.x*a.x-this.y*a.y,this.y*a.x+this.x*a.y)},conjugate:function(){return new f(this.x,-this.y)},scale:function(a){return new f(this.x*a,this.y*a)},equals:function(a){return this.x==a.x&&this.y==a.y},$add:function(a){this.x+=a.x;this.y+=a.y;return this},$prod:function(a){var b=this.x,c=this.y;this.x=b*a.x-c*a.y;this.y=c*a.x+b*a.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(a){this.x*=a;this.y*=a;return this},$div:function(a){var c=this.x,b=this.y;var d=a.squaredNorm();this.x=c*a.x+b*a.y;this.y=b*a.x-c*a.y;return this.$scale(1/d)},isZero:function(){var b=1.0E-4,a=Math.abs;return a(this.x)<b&&a(this.y)<b}};var m=function(b,a){return new f(b,a)};f.KER=m(0,0);$jit.Graph=new b({initialize:function(i,h,g,e){var d={klass:f,Node:{}};this.Node=h;this.Edge=g;this.Label=e;this.opt=a.merge(d,i||{});this.nodes={};this.edges={};var c=this;this.nodeList={};for(var b in o){c.nodeList[b]=function(a){return function(){var b=Array.prototype.slice.call(arguments);c.eachNode(function(c){c[a].apply(c,b)})}}(b)}},getNode:function(a){if(this.hasNode(a)){return this.nodes[a]}return !1},get:function(a){return this.getNode(a)},getByName:function(b){for(var c in this.nodes){var a=this.nodes[c];if(a.name==b){return a}}return !1},getAdjacence:function(a,b){if(a in this.edges){return this.edges[a][b]}return !1},addNode:function(b){if(!this.nodes[b.id]){var d=this.edges[b.id]={};this.nodes[b.id]=new c.Node(a.extend({id:b.id,name:b.name,data:a.merge(b.data||{},{}),adjacencies:d},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[b.id]},addAdjacence:function(b,a,f){if(!this.hasNode(b.id)){this.addNode(b)}if(!this.hasNode(a.id)){this.addNode(a)}b=this.nodes[b.id];a=this.nodes[a.id];if(!b.adjacentTo(a)){var d=this.edges[b.id]=this.edges[b.id]||{};var e=this.edges[a.id]=this.edges[a.id]||{};d[a.id]=e[b.id]=new c.Adjacence(b,a,f,this.Edge,this.Label);return d[a.id]}return this.edges[b.id][a.id]},removeNode:function(a){if(this.hasNode(a)){delete this.nodes[a];var c=this.edges[a];for(var b in c){delete this.edges[b][a]}delete this.edges[a]}},removeAdjacence:function(b,a){delete this.edges[b][a];delete this.edges[a][b]},hasNode:function(a){return a in this.nodes},empty:function(){this.nodes={};this.edges={}}});var c=$jit.Graph;var o;(function(){var b=function(d,e,b,g,f){var a;b=b||'current';d='$'+(d?d+'-':'');if(b=='current'){a=this.data}else {if(b=='start'){a=this.startData}else {if(b=='end'){a=this.endData}}}var c=d+e;if(g){return a[c]}if(!this.Config.overridable){return f[e]||0}return c in a?a[c]:c in this.data?this.data[c]:f[e]||0};var d=function(c,e,d,a){a=a||'current';c='$'+(c?c+'-':'');var b;if(a=='current'){b=this.data}else {if(a=='start'){b=this.startData}else {if(a=='end'){b=this.endData}}}b[c+e]=d};var c=function(b,d){b='$'+(b?b+'-':'');var c=this;a.each(d,function(e){var a=b+e;delete c.data[a];delete c.endData[a];delete c.startData[a]})};o={getData:function(c,d,a){return b.call(this,'',c,d,a,this.Config)},setData:function(b,a,c){d.call(this,'',b,a,c)},setDataset:function(c,d){c=a.splat(c);for(var e in d){for(var b=0,g=a.splat(d[e]),f=c.length;b<f;b++){this.setData(e,g[b],c[b])}}},removeData:function(){c.call(this,'',Array.prototype.slice.call(arguments))},getCanvasStyle:function(c,d,a){return b.call(this,'canvas',c,d,a,this.Config.CanvasStyles)},setCanvasStyle:function(b,a,c){d.call(this,'canvas',b,a,c)},setCanvasStyles:function(c,d){c=a.splat(c);for(var e in d){for(var b=0,g=a.splat(d[e]),f=c.length;b<f;b++){this.setCanvasStyle(e,g[b],c[b])}}},removeCanvasStyle:function(){c.call(this,'canvas',Array.prototype.slice.call(arguments))},getLabelData:function(c,d,a){return b.call(this,'label',c,d,a,this.Label)},setLabelData:function(b,a,c){d.call(this,'label',b,a,c)},setLabelDataset:function(c,d){c=a.splat(c);for(var e in d){for(var b=0,g=a.splat(d[e]),f=c.length;b<f;b++){this.setLabelData(e,g[b],c[b])}}},removeLabelData:function(){c.call(this,'label',Array.prototype.slice.call(arguments))}}})();c.Node=new b({initialize:function(g,b,f,e,d){var c={id:'',name:'',data:{},startData:{},endData:{},adjacencies:{},selected:!1,drawn:!1,exist:!1,angleSpan:{begin:0,end:0},pos:new b(),startPos:new b(),endPos:new b()};a.extend(this,a.extend(c,g));this.Config=this.Node=f;this.Edge=e;this.Label=d},adjacentTo:function(a){return a.id in this.adjacencies},getAdjacency:function(a){return this.adjacencies[a]},getPos:function(a){a=a||'current';if(a=='current'){return this.pos}else {if(a=='end'){return this.endPos}else {if(a=='start'){return this.startPos}}}},setPos:function(c,a){a=a||'current';var b;if(a=='current'){b=this.pos}else {if(a=='end'){b=this.endPos}else {if(a=='start'){b=this.startPos}}}b.set(c)}});c.Node.implement(o);c.Adjacence=new b({initialize:function(c,a,d,b,e){this.nodeFrom=c;this.nodeTo=a;this.data=d||{};this.startData={};this.endData={};this.Config=this.Edge=b;this.Label=e}});c.Adjacence.implement(o);c.Util={filter:function(b){if(!b||!(a.type(b)=='string')){return function(){return !0}}var c=b.split(' ');return function(d){for(var a=0;a<c.length;a++){if(d[c[a]]){return !1}}return !0}},getNode:function(a,b){return a.nodes[b]},eachNode:function(a,e,c){var d=this.filter(c);for(var b in a.nodes){if(d(a.nodes[b])){e(a.nodes[b])}}},each:function(c,b,a){this.eachNode(c,b,a)},eachAdjacency:function(b,f,g){var d=b.adjacencies,e=this.filter(g);for(var c in d){var a=d[c];if(e(a)){if(a.nodeFrom!=b){var h=a.nodeFrom;a.nodeFrom=a.nodeTo;a.nodeTo=h}f(a,c)}}},computeLevels:function(e,h,a,d){a=a||0;var g=this.filter(d);this.eachNode(e,function(b){b._flag=!1;b._depth=-1},d);var f=e.getNode(h);f._depth=a;var c=[f];while(c.length!=0){var b=c.pop();b._flag=!0;this.eachAdjacency(b,function(i){var f=i.nodeTo;if(f._flag==!1&&g(f)){if(f._depth<0){f._depth=b._depth+1+a}c.unshift(f)}},d)}},eachBFS:function(c,f,e,d){var g=this.filter(d);this.clean(c);var b=[c.getNode(f)];while(b.length!=0){var a=b.pop();a._flag=!0;e(a,a._depth);this.eachAdjacency(a,function(h){var a=h.nodeTo;if(a._flag==!1&&g(a)){a._flag=!0;b.unshift(a)}},d)}},eachLevel:function(c,f,a,d,h){var b=c._depth,g=this.filter(h),e=this;a=a===!1?Number.MAX_VALUE-b:a;(function y(i,k,j){var b=i._depth;if(b>=k&&b<=j&&g(i)){d(i,b)}if(b<j){e.eachAdjacency(i,function(g){var e=g.nodeTo;if(e._depth>b){y(e,k,j)}})}})(c,f+b,a+b)},eachSubgraph:function(b,c,a){this.eachLevel(b,0,!1,c,a)},eachSubnode:function(b,c,a){this.eachLevel(b,1,1,c,a)},anySubnode:function(f,b,e){var c=!1;b=b||a.lambda(!0);var d=a.type(b)=='string'?function(a){return a[b]}:b;this.eachSubnode(f,function(a){if(d(a)){c=!0}},e);return c},getSubnodes:function(e,b,g){var f=[],h=this;b=b||0;var d,c;if(a.type(b)=='array'){d=b[0];c=b[1]}else {d=b;c=Number.MAX_VALUE-e._depth}this.eachLevel(e,d,c,function(a){f.push(a)},g);return f},getParents:function(b){var a=[];this.eachAdjacency(b,function(d){var c=d.nodeTo;if(c._depth<b._depth){a.push(c)}});return a},isDescendantOf:function(e,c){if(e.id==c){return !0}var d=this.getParents(e),a=!1;for(var b=0;!a&&b<d.length;b++){a=a||this.isDescendantOf(d[b],c)}return a},clean:function(a){this.eachNode(a,function(b){b._flag=!1})},getClosestNodeToOrigin:function(b,c,a){return this.getClosestNodeToPos(b,h.KER,c,a)},getClosestNodeToPos:function(g,a,c,e){var b=null;c=c||'current';a=a&&a.getc(!0)||f.KER;var d=function(d,b){var h=d.x-b.x,f=d.y-b.y;return h*h+f*f};this.eachNode(g,function(f){b=b==null||d(f.getPos(c).getc(!0),a)<d(b.getPos(c).getc(!0),a)?f:b},e);return b}};a.each(['get','getNode','each','eachNode','computeLevels','eachBFS','clean','getClosestNodeToPos','getClosestNodeToOrigin'],function(a){c.prototype[a]=function(){return c.Util[a].apply(c.Util,[this].concat(Array.prototype.slice.call(arguments)))}});a.each(['eachAdjacency','eachLevel','eachSubgraph','eachSubnode','anySubnode','getSubnodes','getParents','isDescendantOf'],function(a){c.Node.prototype[a]=function(){return c.Util[a].apply(c.Util,[this].concat(Array.prototype.slice.call(arguments)))}});c.Op={options:{type:'nothing',duration:2000,hideLabels:!0,fps:30},initialize:function(a){this.viz=a},removeNode:function(h,i){var b=this.viz;var e=a.merge(this.options,b.controller,i);var c=a.splat(h);var d,f,g;switch(e.type){case 'nothing':for(d=0;d<c.length;d++){b.graph.removeNode(c[d])};break;case 'replot':this.removeNode(c,{type:'nothing'});b.labels.clearLabels();b.refresh(!0);break;case 'fade:seq':case 'fade':f=this;for(d=0;d<c.length;d++){g=b.graph.getNode(c[d]);g.setData('alpha',0,'end')};b.fx.animate(a.merge(e,{modes:['node-property:alpha'],onComplete:function(){f.removeNode(c,{type:'nothing'});b.labels.clearLabels();b.reposition();b.fx.animate(a.merge(e,{modes:['linear']}))}}));break;case 'fade:con':f=this;for(d=0;d<c.length;d++){g=b.graph.getNode(c[d]);g.setData('alpha',0,'end');g.ignore=!0};b.reposition();b.fx.animate(a.merge(e,{modes:['node-property:alpha','linear'],onComplete:function(){f.removeNode(c,{type:'nothing'});e.onComplete&&e.onComplete()}}));break;case 'iter':f=this;b.fx.sequence({condition:function(){return c.length!=0},step:function(){f.removeNode(c.shift(),{type:'nothing'});b.labels.clearLabels()},onComplete:function(){e.onComplete&&e.onComplete()},duration:Math.ceil(e.duration/c.length)});break;default:this.doError();}},removeEdge:function(h,i){var d=this.viz;var e=a.merge(this.options,d.controller,i);var c=a.type(h[0])=='string'?[h]:h;var b,g,f;switch(e.type){case 'nothing':for(b=0;b<c.length;b++){d.graph.removeAdjacence(c[b][0],c[b][1])};break;case 'replot':this.removeEdge(c,{type:'nothing'});d.refresh(!0);break;case 'fade:seq':case 'fade':g=this;for(b=0;b<c.length;b++){f=d.graph.getAdjacence(c[b][0],c[b][1]);if(f){f.setData('alpha',0,'end')}};d.fx.animate(a.merge(e,{modes:['edge-property:alpha'],onComplete:function(){g.removeEdge(c,{type:'nothing'});d.reposition();d.fx.animate(a.merge(e,{modes:['linear']}))}}));break;case 'fade:con':g=this;for(b=0;b<c.length;b++){f=d.graph.getAdjacence(c[b][0],c[b][1]);if(f){f.setData('alpha',0,'end');f.ignore=!0}};d.reposition();d.fx.animate(a.merge(e,{modes:['edge-property:alpha','linear'],onComplete:function(){g.removeEdge(c,{type:'nothing'});e.onComplete&&e.onComplete()}}));break;case 'iter':g=this;d.fx.sequence({condition:function(){return c.length!=0},step:function(){g.removeEdge(c.shift(),{type:'nothing'});d.labels.clearLabels()},onComplete:function(){e.onComplete()},duration:Math.ceil(e.duration/c.length)});break;default:this.doError();}},sum:function(e,g){var b=this.viz;var c=a.merge(this.options,b.controller,g),i=b.root;var d;b.root=g.id||b.root;switch(c.type){case 'nothing':d=b.construct(e);d.eachNode(function(a){a.eachAdjacency(function(c){b.graph.addAdjacence(c.nodeFrom,c.nodeTo,c.data)})});break;case 'replot':b.refresh(!0);this.sum(e,{type:'nothing'});b.refresh(!0);break;case 'fade:seq':case 'fade':case 'fade:con':that=this;d=b.construct(e);var h=this.preprocessSum(d);var f=!h?['node-property:alpha']:['node-property:alpha','edge-property:alpha'];b.reposition();if(c.type!='fade:con'){b.fx.animate(a.merge(c,{modes:['linear'],onComplete:function(){b.fx.animate(a.merge(c,{modes:f,onComplete:function(){c.onComplete()}}))}}))}else {b.graph.eachNode(function(a){if(a.id!=i&&a.pos.isZero()){a.pos.set(a.endPos);a.startPos.set(a.endPos)}});b.fx.animate(a.merge(c,{modes:['linear'].concat(f)}))};break;default:this.doError();}},morph:function(f,k,c){c=c||{};var b=this.viz;var g=a.merge(this.options,b.controller,k),l=b.root;var d;b.root=k.id||b.root;switch(g.type){case 'nothing':d=b.construct(f);d.eachNode(function(a){var g=b.graph.hasNode(a.id);a.eachAdjacency(function(d){var h=!!b.graph.getAdjacence(d.nodeFrom.id,d.nodeTo.id);b.graph.addAdjacence(d.nodeFrom,d.nodeTo,d.data);if(h){var g=b.graph.getAdjacence(d.nodeFrom.id,d.nodeTo.id);for(var e in d.data||{}){g.data[e]=d.data[e]}}});if(g){var e=b.graph.getNode(a.id);for(var d in a.data||{}){e.data[d]=a.data[d]}}});b.graph.eachNode(function(a){a.eachAdjacency(function(e){if(!d.getAdjacence(e.nodeFrom.id,e.nodeTo.id)){b.graph.removeAdjacence(e.nodeFrom.id,e.nodeTo.id)}});if(!d.hasNode(a.id)){b.graph.removeNode(a.id)}});break;case 'replot':b.labels.clearLabels(!0);this.morph(f,{type:'nothing'});b.refresh(!0);b.refresh(!0);break;case 'fade:seq':case 'fade':case 'fade:con':that=this;d=b.construct(f);var i='node-property' in c&&a.map(a.splat(c['node-property']),function(a){return '$'+a});b.graph.eachNode(function(b){var h=d.getNode(b.id);if(!h){b.setData('alpha',1);b.setData('alpha',1,'start');b.setData('alpha',0,'end');b.ignore=!0}else {var g=h.data;for(var e in g){if(i&&a.indexOf(i,e)>-1){b.endData[e]=g[e]}else {b.data[e]=g[e]}}}});b.graph.eachNode(function(a){if(a.ignore){return}a.eachAdjacency(function(e){if(e.nodeFrom.ignore||e.nodeTo.ignore){return}var g=d.getNode(e.nodeFrom.id);var h=d.getNode(e.nodeTo.id);if(!g.adjacentTo(h)){var e=b.graph.getAdjacence(g.id,h.id);j=!0;e.setData('alpha',1);e.setData('alpha',1,'start');e.setData('alpha',0,'end')}})});var j=this.preprocessSum(d);var e=!j?['node-property:alpha']:['node-property:alpha','edge-property:alpha'];e[0]=e[0]+('node-property' in c?':'+a.splat(c['node-property']).join(':'):'');e[1]=(e[1]||'edge-property:alpha')+('edge-property' in c?':'+a.splat(c['edge-property']).join(':'):'');if('label-property' in c){e.push('label-property:'+a.splat(c['label-property']).join(':'))};if(b.reposition){b.reposition()}else {b.compute('end')};b.graph.eachNode(function(a){if(a.id!=l&&a.pos.getp().equals(h.KER)){a.pos.set(a.endPos);a.startPos.set(a.endPos)}});b.fx.animate(a.merge(g,{modes:[c.position||'polar'].concat(e),onComplete:function(){b.graph.eachNode(function(a){if(a.ignore){b.graph.removeNode(a.id)}});b.graph.eachNode(function(a){a.eachAdjacency(function(d){if(d.ignore){b.graph.removeAdjacence(d.nodeFrom.id,d.nodeTo.id)}})});g.onComplete()}}));break;default:}},contract:function(d,c){var b=this.viz;if(d.collapsed||!d.anySubnode(a.lambda(!0))){return}c=a.merge(this.options,b.config,c||{},{modes:['node-property:alpha:span','linear']});d.collapsed=!0;(function z(a){a.eachSubnode(function(b){b.ignore=!0;b.setData('alpha',0,c.type=='animate'?'end':'current');z(b)})})(d);if(c.type=='animate'){b.compute('end');if(b.rotated){b.rotate(b.rotated,'none',{property:'end'})}(function z(a){a.eachSubnode(function(b){b.setPos(d.getPos('end'),'end');z(b)})})(d);b.fx.animate(c)}else {if(c.type=='replot'){b.refresh()}}},expand:function(d,c){if(!('collapsed' in d)){return}var b=this.viz;c=a.merge(this.options,b.config,c||{},{modes:['node-property:alpha:span','linear']});delete d.collapsed;(function z(a){a.eachSubnode(function(b){delete b.ignore;b.setData('alpha',1,c.type=='animate'?'end':'current');z(b)})})(d);if(c.type=='animate'){b.compute('end');if(b.rotated){b.rotate(b.rotated,'none',{property:'end'})}b.fx.animate(c)}else {if(c.type=='replot'){b.refresh()}}},preprocessSum:function(b){var a=this.viz;b.eachNode(function(d){if(!a.graph.hasNode(d.id)){a.graph.addNode(d);var c=a.graph.getNode(d.id);c.setData('alpha',0);c.setData('alpha',0,'start');c.setData('alpha',1,'end')}});var c=!1;b.eachNode(function(d){d.eachAdjacency(function(e){var f=a.graph.getNode(e.nodeFrom.id);var g=a.graph.getNode(e.nodeTo.id);if(!f.adjacentTo(g)){var e=a.graph.addAdjacence(f,g,e.data);if(f.startAlpha==f.endAlpha&&g.startAlpha==g.endAlpha){c=!0;e.setData('alpha',0);e.setData('alpha',0,'start');e.setData('alpha',1,'end')}}})});return c}};var s={none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(e,b,c,d){var a=d.getCtx();a.beginPath();a.arc(b.x,b.y,c,0,Math.PI*2,!0);a.closePath();a[e]()},contains:function(b,a,c){var e=b.x-a.x,d=b.y-a.y,f=e*e+d*d;return f<=c*c}},ellipse:{render:function(j,g,c,b,k){var a=k.getCtx(),i=1,h=1,f=1,e=1,d=0;if(c>b){d=c/2;h=b/c;e=c/b}else {d=b/2;i=c/b;f=b/c}a.save();a.scale(i,h);a.beginPath();a.arc(g.x*f,g.y*e,d,0,Math.PI*2,!0);a.closePath();a[j]();a.restore()},contains:function(j,h,c,b){var a=0,g=1,f=1,e=0,d=0,i=0;if(c>b){a=c/2;f=b/c}else {a=b/2;g=c/b}e=(j.x-h.x)*(1/g);d=(j.y-h.y)*(1/f);i=e*e+d*d;return i<=a*a}},square:{render:function(d,b,a,c){c.getCtx()[d+'Rect'](b.x-a,b.y-a,2*a,2*a)},contains:function(c,b,a){return Math.abs(b.x-c.x)<=a&&Math.abs(b.y-c.y)<=a}},rectangle:{render:function(e,a,c,b,d){d.getCtx()[e+'Rect'](a.x-c/2,a.y-b/2,c,b)},contains:function(b,a,d,c){return Math.abs(a.x-b.x)<=d/2&&Math.abs(a.y-b.y)<=c/2}},triangle:{render:function(h,c,b,j){var a=j.getCtx(),d=c.x,k=c.y-b,i=d-b,e=c.y+b,g=d+b,f=e;a.beginPath();a.moveTo(d,k);a.lineTo(i,e);a.lineTo(g,f);a.closePath();a[h]()},contains:function(c,b,a){return s.circle.contains(c,b,a)}},star:{render:function(e,d,b,f){var a=f.getCtx(),g=Math.PI/5;a.save();a.translate(d.x,d.y);a.beginPath();a.moveTo(b,0);for(var c=0;c<9;c++){a.rotate(g);if(c%2==0){a.lineTo(b/0.525731*0.200811,0)}else {a.lineTo(b,0)}}a.closePath();a[e]();a.restore()},contains:function(c,b,a){return s.circle.contains(c,b,a)}}};var u={line:{render:function(c,b,d){var a=d.getCtx();a.beginPath();a.moveTo(c.x,c.y);a.lineTo(b.x,b.y);a.stroke()},contains:function(a,b,c,e){var f=Math.min,d=Math.max,k=f(a.x,b.x),i=d(a.x,b.x),j=f(a.y,b.y),h=d(a.y,b.y);if(c.x>=k&&c.x<=i&&c.y>=j&&c.y<=h){if(Math.abs(b.x-a.x)<=e){return !0}var g=(b.y-a.y)/(b.x-a.x)*(c.x-a.x)+a.y;return Math.abs(g-c.y)<=e}return !1}},arrow:{render:function(d,a,m,k,j){var b=j.getCtx();if(k){var l=d;d=a;a=l}var c=new f(a.x-d.x,a.y-d.y);c.$scale(m/c.norm());var e=new f(a.x-c.x,a.y-c.y),g=new f(-c.y/2,c.x/2),i=e.add(g),h=e.$add(g.$scale(-1));b.beginPath();b.moveTo(d.x,d.y);b.lineTo(a.x,a.y);b.stroke();b.beginPath();b.moveTo(i.x,i.y);b.lineTo(h.x,h.y);b.lineTo(a.x,a.y);b.closePath();b.fill()},contains:function(b,a,d,c){return u.line.contains(b,a,d,c)}},hyperline:{render:function(d,e,c,i){var b=i.getCtx();var a=A(d,e);if(a.a>1000||a.b>1000||a.ratio<0){b.beginPath();b.moveTo(d.x*c,d.y*c);b.lineTo(e.x*c,e.y*c);b.stroke()}else {var h=Math.atan2(e.y-a.y,e.x-a.x);var g=Math.atan2(d.y-a.y,d.x-a.x);var f=f(h,g);b.beginPath();b.arc(a.x*c,a.y*c,a.ratio*c,h,g,f);b.stroke()}function A(b,a){var h=b.x*a.y-b.y*a.x,n=h;var k=b.squaredNorm(),j=a.squaredNorm();if(h==0){return {x:0,y:0,ratio:-1}}var g=(b.y*j-a.y*k+b.y-a.y)/h;var f=(a.x*k-b.x*j+a.x-b.x)/n;var q=-g/2;var p=-f/2;var m=(g*g+f*f)/4-1;if(m<0){return {x:0,y:0,ratio:-1}}var l=Math.sqrt(m);var o={x:q,y:p,ratio:l>1000?-1:l,a:g,b:f};return o}function f(a,b){return a<b?a+Math.PI>b?!1:!0:b+Math.PI>a?!0:!1}},contains:a.lambda(!1)}};c.Plot={initialize:function(a,b){this.viz=a;this.config=a.config;this.node=a.config.Node;this.edge=a.config.Edge;this.animation=new r();this.nodeTypes=new b.Plot.NodeTypes();this.edgeTypes=new b.Plot.EdgeTypes();this.labels=a.labels},nodeHelper:s,edgeHelper:u,Interpolator:{map:{border:'color',color:'color',width:'number',height:'number',dim:'number',alpha:'number',lineWidth:'number',angularWidth:'number',span:'number',valueArray:'array-number',dimArray:'array-number'},canvas:{globalAlpha:'number',fillStyle:'color',strokeStyle:'color',lineWidth:'number',shadowBlur:'number',shadowColor:'color',shadowOffsetX:'number',shadowOffsetY:'number',miterLimit:'number'},label:{size:'number',color:'color'},compute:function(a,c,b){return a+(c-a)*b},moebius:function(c,h,e,g){var a=g.scale(-e);if(a.norm()<1){var f=a.x,d=a.y;var b=c.startPos.getc().moebiusTransformation(a);c.pos.setc(b.x,b.y);a.x=f;a.y=d}},linear:function(a,e,b){var d=a.startPos.getc(!0);var c=a.endPos.getc(!0);a.pos.setc(this.compute(d.x,c.x,b),this.compute(d.y,c.y,b))},polar:function(a,f,d){var c=a.startPos.getp(!0);var e=a.endPos.getp();var b=e.interpolate(c,d);a.pos.setp(b.theta,b.rho)},number:function(b,a,e,c,d){var g=b[c](a,'start');var f=b[c](a,'end');b[d](a,this.compute(g,f,e))},color:function(g,f,e,h,j){var c=a.hexToRgb(g[h](f,'start'));var d=a.hexToRgb(g[h](f,'end'));var b=this.compute;var i=a.rgbToHex([parseInt(b(c[0],d[0],e)),parseInt(b(c[1],d[1],e)),parseInt(b(c[2],d[2],e))]);g[j](f,i)},'array-number':function(f,e,j,h,m){var i=f[h](e,'start'),o=f[h](e,'end'),d=[];for(var b=0,l=i.length;b<l;b++){var c=i[b],k=o[b];if(c.length){for(var a=0,n=c.length,g=[];a<n;a++){g.push(this.compute(c[a],k[a],j))}d.push(g)}else {d.push(this.compute(c,k,j))}}f[m](e,d)},node:function(g,c,f,b,e,h){b=this[b];if(c){var i=c.length;for(var d=0;d<i;d++){var a=c[d];this[b[a]](g,a,f,e,h)}}else {for(var a in b){this[b[a]](g,a,f,e,h)}}},edge:function(g,f,d,h,e,c){var a=g.adjacencies;for(var b in a){this['node'](a[b],f,d,h,e,c)}},'node-property':function(b,a,c){this['node'](b,a,c,'map','getData','setData')},'edge-property':function(b,a,c){this['edge'](b,a,c,'map','getData','setData')},'label-property':function(b,a,c){this['node'](b,a,c,'label','getLabelData','setLabelData')},'node-style':function(b,a,c){this['node'](b,a,c,'canvas','getCanvasStyle','setCanvasStyle')},'edge-style':function(b,a,c){this['edge'](b,a,c,'canvas','getCanvasStyle','setCanvasStyle')}},sequence:function(b){var d=this;b=a.merge({condition:a.lambda(!1),step:a.empty,onComplete:a.empty,duration:200},b||{});var c=setInterval(function(){if(b.condition()){b.step()}else {clearInterval(c);b.onComplete()}d.viz.refresh(!0)},b.duration)},prepare:function(c){var h=this.viz.graph,d={'node-property':{getter:'getData',setter:'setData'},'edge-property':{getter:'getData',setter:'setData'},'node-style':{getter:'getCanvasStyle',setter:'setCanvasStyle'},'edge-style':{getter:'getCanvasStyle',setter:'setCanvasStyle'}};var b={};if(a.type(c)=='array'){for(var e=0,i=c.length;e<i;e++){var g=c[e].split(':');b[g.shift()]=g}}else {for(var f in c){if(f=='position'){b[c.position]=[]}else {b[f]=a.splat(c[f])}}}h.eachNode(function(e){e.startPos.set(e.pos);a.each(['node-property','node-style'],function(f){if(f in b){var g=b[f];for(var a=0,h=g.length;a<h;a++){e[d[f].setter](g[a],e[d[f].getter](g[a]),'start')}}});a.each(['edge-property','edge-style'],function(a){if(a in b){var f=b[a];e.eachAdjacency(function(g){for(var b=0,h=f.length;b<h;b++){g[d[a].setter](f[b],g[d[a].getter](f[b]),'start')}})}})});return b},animate:function(b,i){b=a.merge(this.viz.config,b||{});var c=this,h=this.viz,f=h.graph,g=this.Interpolator,e=b.type==='nodefx'?this.nodeFxAnimation:this.animation;var d=this.prepare(b.modes);if(b.hideLabels){this.labels.hideLabels(!0)}e.setOptions(a.extend(b,{$animating:!1,compute:function(a){f.eachNode(function(e){for(var c in d){g[c](e,d[c],a,i)}});c.plot(b,this.$animating,a);this.$animating=!0},complete:function(){if(b.hideLabels){c.labels.hideLabels(!1)}c.plot(b);b.onComplete()}})).start()},nodeFx:function(b){var e=this.viz,f=e.graph,h=this.nodeFxAnimation,i=a.merge(this.viz.config,{elements:{id:!1,properties:{}},reposition:!1});b=a.merge(i,b||{},{onBeforeCompute:a.empty,onAfterCompute:a.empty});h.stopTimer();var c=b.elements.properties;if(!b.elements.id){f.eachNode(function(d){for(var a in c){d.setData(a,c[a],'end')}})}else {var j=a.splat(b.elements.id);a.each(j,function(e){var d=f.getNode(e);if(d){for(var a in c){d.setData(a,c[a],'end')}}})}var d=[];for(var k in c){d.push(k)}var g=['node-property:'+d.join(':')];if(b.reposition){g.push('linear');e.compute('end')}this.animate(a.merge(b,{modes:g,type:'nodefx'}))},plot:function(a,b){var e=this.viz,f=e.graph,d=e.canvas,i=e.root,c=this,k=d.getCtx(),j=Math.min,a=a||this.viz.controller;a.clearCanvas&&d.clear();var g=f.getNode(i);if(!g){return}var h=!!g.visited;f.eachNode(function(e){var f=e.getData('alpha');e.eachAdjacency(function(f){var g=f.nodeTo;if(!!g.visited===h&&e.drawn&&g.drawn){!b&&a.onBeforePlotLine(f);c.plotLine(f,d,b);!b&&a.onAfterPlotLine(f)}});if(e.drawn){!b&&a.onBeforePlotNode(e);c.plotNode(e,d,b);!b&&a.onAfterPlotNode(e)}if(!c.labelsHidden&&a.withLabels){if(e.drawn&&f>=0.95){c.labels.plotLabel(d,e,a)}else {c.labels.hideLabel(e,!1)}}e.visited=!h})},plotTree:function(a,b,c){var e=this,f=this.viz,d=f.canvas,i=this.config,h=d.getCtx();var g=a.getData('alpha');a.eachSubnode(function(f){if(b.plotSubtree(a,f)&&f.exist&&f.drawn){var g=a.getAdjacency(f.id);!c&&b.onBeforePlotLine(g);e.plotLine(g,d,c);!c&&b.onAfterPlotLine(g);e.plotTree(f,b,c)}});if(a.drawn){!c&&b.onBeforePlotNode(a);this.plotNode(a,d,c);!c&&b.onAfterPlotNode(a);if(!b.hideLabels&&b.withLabels&&g>=0.95){this.labels.plotLabel(d,a,b)}else {this.labels.hideLabel(a,!1)}}else {this.labels.hideLabel(a,!0)}},plotNode:function(b,e,h){var c=b.getData('type'),g=this.node.CanvasStyles;if(c!='none'){var i=b.getData('lineWidth'),f=b.getData('color'),j=b.getData('alpha'),a=e.getCtx();a.save();a.lineWidth=i;a.fillStyle=a.strokeStyle=f;a.globalAlpha=j;for(var d in g){a[d]=b.getCanvasStyle(d)}this.nodeTypes[c].render.call(this,b,e,h);a.restore()}},plotLine:function(a,e,h){var c=a.getData('type'),k=this.edge.CanvasStyles;if(c!='none'){var i=a.getData('lineWidth'),j=a.getData('color'),b=e.getCtx(),f=a.nodeFrom,g=a.nodeTo;b.save();b.lineWidth=i;b.fillStyle=b.strokeStyle=j;b.globalAlpha=Math.min(f.getData('alpha'),g.getData('alpha'),a.getData('alpha'));for(var d in k){b[d]=a.getCanvasStyle(d)}this.edgeTypes[c].render.call(this,a,e,h);b.restore()}}};c.Plot3D=a.merge(c.Plot,{Interpolator:{linear:function(b,e,a){var d=b.startPos.getc(!0);var c=b.endPos.getc(!0);b.pos.setc(this.compute(d.x,c.x,a),this.compute(d.y,c.y,a),this.compute(d.z,c.z,a))}},plotNode:function(a,b){if(a.getData('type')=='none'){return}this.plotElement(a,b,{getAlpha:function(){return a.getData('alpha')}})},plotLine:function(a,b){if(a.getData('type')=='none'){return}this.plotElement(a,b,{getAlpha:function(){return Math.min(a.nodeFrom.getData('alpha'),a.nodeTo.getData('alpha'),a.getData('alpha'))}})},plotElement:function(c,r,E){var b=r.getCtx(),s=new Matrix4(),i=r.config.Scene.Lighting,C=r.canvases[0],e=C.program,B=C.camera;if(!c.geometry){c.geometry=new (O3D[c.getData('type')])()}c.geometry.update(c);if(!c.webGLVertexBuffer){var k=[],m=[],l=[],g=0,A=c.geometry;for(var v=0,n=A.vertices,x=A.faces,D=x.length;v<D;v++){var h=x[v],q=n[h.a],p=n[h.b],o=n[h.c],j=h.d?n[h.d]:!1,d=h.normal;k.push(q.x,q.y,q.z);k.push(p.x,p.y,p.z);k.push(o.x,o.y,o.z);if(j){k.push(j.x,j.y,j.z)}l.push(d.x,d.y,d.z);l.push(d.x,d.y,d.z);l.push(d.x,d.y,d.z);if(j){l.push(d.x,d.y,d.z)}m.push(g,g+1,g+2);if(j){m.push(g,g+2,g+3);g+=4}else {g+=3}}c.webGLVertexBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c.webGLVertexBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(k),b.STATIC_DRAW);c.webGLFaceBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.webGLFaceBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(m),b.STATIC_DRAW);c.webGLFaceCount=m.length;c.webGLNormalBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c.webGLNormalBuffer);b.bufferData(b.ARRAY_BUFFER,new Float32Array(l),b.STATIC_DRAW)}s.multiply(B.matrix,c.geometry.matrix);b.uniformMatrix4fv(e.viewMatrix,!1,s.flatten());b.uniformMatrix4fv(e.projectionMatrix,!1,B.projectionMatrix.flatten());var y=Matrix4.makeInvert(s);y.$transpose();b.uniformMatrix4fv(e.normalMatrix,!1,y.flatten());var f=a.hexToRgb(c.getData('color'));f.push(E.getAlpha());b.uniform4f(e.color,f[0]/255,f[1]/255,f[2]/255,f[3]);b.uniform1i(e.enableLighting,i.enable);if(i.enable){if(i.ambient){var u=i.ambient;b.uniform3f(e.ambientColor,u[0],u[1],u[2])}if(i.directional){var z=i.directional,f=z.color,t=z.direction,w=(new Vector3(t.x,t.y,t.z)).normalize().$scale(-1);b.uniform3f(e.lightingDirection,w.x,w.y,w.z);b.uniform3f(e.directionalColor,f[0],f[1],f[2])}}b.bindBuffer(b.ARRAY_BUFFER,c.webGLVertexBuffer);b.vertexAttribPointer(e.position,3,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,c.webGLNormalBuffer);b.vertexAttribPointer(e.normal,3,b.FLOAT,!1,0,0);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.webGLFaceBuffer);b.drawElements(b.TRIANGLES,c.webGLFaceCount,b.UNSIGNED_SHORT,0)}});c.Label={};c.Label.Native=new b({initialize:function(a){this.viz=a},plotLabel:function(c,a,d){var b=c.getCtx();var e=a.pos.getc(!0);b.font=a.getLabelData('style')+' '+a.getLabelData('size')+'px '+a.getLabelData('family');b.textAlign=a.getLabelData('textAlign');b.fillStyle=b.strokeStyle=a.getLabelData('color');b.textBaseline=a.getLabelData('textBaseline');this.renderLabel(c,a,d)},renderLabel:function(d,a,e){var c=d.getCtx();var b=a.pos.getc(!0);c.fillText(a.name,b.x,b.y+a.getData('height')/2)},hideLabel:a.empty,hideLabels:a.empty});c.Label.DOM=new b({labelsHidden:!1,labelContainer:!1,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(a){return a in this.labels&&this.labels[a]!=null?this.labels[a]:this.labels[a]=document.getElementById(a)},hideLabels:function(b){var a=this.getLabelContainer();if(b){a.style.display='none'}else {a.style.display=''}this.labelsHidden=b},clearLabels:function(b){for(var a in this.labels){if(b||!this.viz.graph.hasNode(a)){this.disposeLabel(a);delete this.labels[a]}}},disposeLabel:function(b){var a=this.getLabel(b);if(a&&a.parentNode){a.parentNode.removeChild(a)}},hideLabel:function(b,c){b=a.splat(b);var d=c?'':'none',f,e=this;a.each(b,function(f){var a=e.getLabel(f.id);if(a){a.style.display=d}})},fitsInCanvas:function(a,c){var b=c.getSize();if(a.x>=b.width||a.x<0||a.y>=b.height||a.y<0){return !1}return !0}});c.Label.HTML=new b({Implements:c.Label.DOM,plotLabel:function(f,b,d){var c=b.id,a=this.getLabel(c);if(!a&&!(a=document.getElementById(c))){a=document.createElement('div');var e=this.getLabelContainer();a.id=c;a.className='node';a.style.position='absolute';d.onCreateLabel(a,b);e.appendChild(a);this.labels[b.id]=a}this.placeLabel(a,b,d)}});c.Label.SVG=new b({Implements:c.Label.DOM,plotLabel:function(h,b,e){var c=b.id,a=this.getLabel(c);if(!a&&!(a=document.getElementById(c))){var d='http://www.w3.org/2000/svg';a=document.createElementNS(d,'svg:text');var f=document.createElementNS(d,'svg:tspan');a.appendChild(f);var g=this.getLabelContainer();a.setAttribute('id',c);a.setAttribute('class','node');g.appendChild(a);e.onCreateLabel(a,b);this.labels[b.id]=a}this.placeLabel(a,b,e)}});c.Geom=new b({initialize:function(a){this.viz=a;this.config=a.config;this.node=a.config.Node;this.edge=a.config.Edge},translate:function(c,b){b=a.splat(b);this.viz.graph.eachNode(function(d){a.each(b,function(a){d.getPos(a).$add(c)})})},setRightLevelToShow:function(c,f,e){var d=this.getRightLevelToShow(c,f),g=this.viz.labels,b=a.merge({execShow:!0,execHide:!0,onHide:a.empty,onShow:a.empty},e||{});c.eachLevel(0,this.config.levelsToShow,function(a){var h=a._depth-c._depth;if(h>d){b.onHide(a);if(b.execHide){a.drawn=!1;a.exist=!1;g.hideLabel(a,!1)}}else {b.onShow(a);if(b.execShow){a.exist=!0}}});c.drawn=!0},getRightLevelToShow:function(e,c){var b=this.config;var a=b.levelsToShow;var d=b.constrained;if(!d){return a}while(!this.treeFitsInCanvas(e,c,a)&&a>1){a--}return a}});var k={construct:function(d){var e=a.type(d)=='array';var b=new c(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);if(!e){(function(e,b){e.addNode(b);if(b.children){for(var a=0,c=b.children;a<c.length;a++){e.addAdjacence(b,c[a]);arguments.callee(e,c[a])}}})(b,d)}else {(function(h,b){var j=function(c){for(var a=0,e=b.length;a<e;a++){if(b[a].id==c){return b[a]}}var f={id:c,name:c};return h.addNode(f)};for(var c=0,k=b.length;c<k;c++){h.addNode(b[c]);var f=b[c].adjacencies;if(f){for(var e=0,l=f.length;e<l;e++){var g=f[e],i={};if(typeof f[e]!='string'){i=a.merge(g.data,{});g=g.nodeTo}h.addAdjacence(b[c],j(g),i)}}}})(b,d)}return b},loadJSON:function(b,c){this.json=b;if(this.labels&&this.labels.clearLabels){this.labels.clearLabels(!0)}this.graph=this.construct(b);if(a.type(b)!='array'){this.root=b.id}else {this.root=b[c?c:0].id}},toJSON:function(b){b=b||'tree';if(b=='tree'){var a={};var d=this.graph.getNode(this.root);var a=function w(c){var a={};a.id=c.id;a.name=c.name;a.data=c.data;var d=[];c.eachSubnode(function(a){d.push(w(a))});a.children=d;return a}(d);return a}else {var a=[];var c=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(e){var d={};d.id=e.id;d.name=e.name;d.data=e.data;var f=[];e.eachAdjacency(function(d){var g=d.nodeTo;if(!!g.visited===c){var a={};a.nodeTo=g.id;a.data=d.data;f.push(a)}});d.adjacencies=f;a.push(d);e.visited=!c});return a}}};var g=$jit.Layouts={};var t={label:null,compute:function(e,f,d){this.initializeLabel(d);var b=this.label,c=b.style;e.eachNode(function(g){var k=g.getData('autoWidth'),l=g.getData('autoHeight');if(k||l){delete g.data.$width;delete g.data.$height;delete g.data.$dim;var m=g.getData('width'),o=g.getData('height');c.width=k?'auto':m+'px';c.height=l?'auto':o+'px';b.innerHTML=g.name;var j=b.offsetWidth,h=b.offsetHeight;var n=g.getData('type');if(a.indexOf(['circle','square','triangle','star'],n)===-1){g.setData('width',j);g.setData('height',h)}else {var i=j>h?j:h;g.setData('width',i);g.setData('height',i);g.setData('dim',i)}}})},initializeLabel:function(a){if(!this.label){this.label=document.createElement('div');document.body.appendChild(this.label)}this.setLabelStyles(a)},setLabelStyles:function(b){a.extend(this.label.style,{visibility:'hidden',position:'absolute',width:'auto',height:'auto'});this.label.className='jit-autoadjust-label'}};g.Tree=function(){var c=Array.prototype.slice;function D(i,e,f,h,d){var c=e.Node;var g=e.multitree;if(c.overridable){var b=-1,a=-1;i.eachNode(function(c){if(c._depth==f&&(!g||'$orn' in c.data&&c.data.$orn==h)){var j=c.getData('width',d);var k=c.getData('height',d);b=b<j?j:b;a=a<k?k:a}});return {width:b<0?c.width:b,height:a<0?c.height:a}}else {return c}}function G(b,e,d,a){var c=a=='left'||a=='right'?'y':'x';b.getPos(e)[c]+=d}function B(e,d){var b=[];a.each(e,function(a){a=c.call(a);a[0]+=d;a[1]+=d;b.push(a)});return b}function E(b,a){if(b.length==0){return a}if(a.length==0){return b}var d=b.shift(),c=a.shift();return [[d[0],c[1]]].concat(E(b,a))}function z(b,a){a=a||[];if(b.length==0){return a}var c=b.pop();return z(b,E(c,a))}function C(c,b,e,d,a){if(c.length<=a||b.length<=a){return 0}var g=c[a][1],f=b[a][0];return Math.max(C(c,b,e,d,++a)+e,g-f+d)}function A(c,b,a){function J(g,e,d){if(e.length<=d){return []}var h=e[d],f=C(g,h,b,a,0);return [f].concat(J(E(g,B(h,f)),e,++d))}return J([],c,0)}function x(a,e,d){function H(g,c,b){if(c.length<=b){return []}var h=c[b],f=-C(h,g,e,d,0);return [f].concat(H(E(B(h,f),g),c,++b))}a=c.call(a);var b=H([],a.reverse(),0);return b.reverse()}function w(g,f,e,h){var b=A(g,f,e),c=x(g,f,e);if(h=='left'){c=b}else {if(h=='right'){b=c}}for(var a=0,d=[];a<b.length;a++){d[a]=(b[a]+c[a])/2}return d}function y(i,n,a,c,b){var j=c.multitree;var f=['x','y'],e=['width','height'];var d=+(b=='left'||b=='right');var m=f[d],h=f[1-d];var q=c.Node;var l=e[d],g=e[1-d];var k=c.siblingOffset;var p=c.subtreeOffset;var o=c.align;function P(d,x,q){var t=d.getData(l,a);var y=x||d.getData(g,a);var s=[],r=[],f=!1;var C=y+c.levelDistance;d.eachSubnode(function(e){if(e.exist&&(!j||'$orn' in e.data&&e.data.$orn==b)){if(!f){f=D(i,c,e._depth,b,a)}var h=P(e,f[g],q+C);s.push(h.tree);r.push(h.extent)}});var u=w(r,p,k,o);for(var e=0,E=[],v=[];e<s.length;e++){G(s[e],a,u[e],b);v.push(B(r[e],u[e]))}var A=[[-t/2,t/2]].concat(z(v));d.getPos(a)[m]=0;if(b=='top'||b=='left'){d.getPos(a)[h]=q}else {d.getPos(a)[h]=-q}return {tree:d,extent:A}}P(n,!1,0)}return new b({compute:function(e,d){var c=e||'start';var b=this.graph.getNode(this.root);a.extend(b,{drawn:!0,exist:!0,selected:!0});t.compute(this.graph,c,this.config);if(!!d||!('_depth' in b)){this.graph.computeLevels(this.root,0,'ignore')}this.computePositions(b,c)},computePositions:function(f,b){var c=this.config;var e=c.multitree;var h=c.align;var d=h!=='center'&&c.indent;var j=c.orientation;var i=e?['top','right','bottom','left']:[j];var g=this;a.each(i,function(a){y(g.graph,f,b,g.config,a,b);var c=['x','y'][+(a=='left'||a=='right')];(function S(g){g.eachSubnode(function(i){if(i.exist&&(!e||'$orn' in i.data&&i.data.$orn==a)){i.getPos(b)[c]+=g.getPos(b)[c];if(d){i.getPos(b)[c]+=h=='left'?d:-d}S(i)}})})(f)})}})}();$jit.ST=function(){var e=[];function y(a){a=a||this.clickedNode;if(!this.config.constrained){return []}var g=this.geom;var i=this.graph;var h=this.canvas;var j=a._depth,b=[];i.eachNode(function(c){if(c.exist&&!c.selected){if(c.isDescendantOf(a.id)){if(c._depth<=j){b.push(c)}}else {b.push(c)}}});var f=g.getRightLevelToShow(a,h);a.eachLevel(f,f,function(c){if(c.exist&&!c.selected){b.push(c)}});for(var c=0;c<e.length;c++){var d=this.graph.getNode(e[c]);if(!d.isDescendantOf(a.id)){b.push(d)}}return b}function w(b){var a=[],c=this.config;b=b||this.clickedNode;this.clickedNode.eachLevel(0,c.levelsToShow,function(d){if(c.multitree&&!('$orn' in d.data)&&d.anySubnode(function(a){return a.exist&&!a.drawn})){a.push(d)}else {if(d.drawn&&!d.anySubnode('drawn')){a.push(d)}}});return a}return new b({Implements:[k,j,g.Tree],initialize:function(h){var e=$jit.ST;var g={levelsToShow:2,levelDistance:30,constrained:!0,Node:{type:'rectangle'},duration:700,offsetX:0,offsetY:0};this.controller=this.config=a.merge(d('Canvas','Fx','Tree','Node','Edge','Controller','Tips','NodeStyles','Events','Navigation','Label'),g,h);var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:f};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this,e);this.op=new e.Op(this);this.group=new e.Group(this);this.geom=new e.Geom(this);this.clickedNode=null;this.initializeExtras()},plot:function(){this.fx.plot(this.controller)},switchPosition:function(e,d,c){var f=this.geom,b=this.fx,a=this;if(!b.busy){b.busy=!0;this.contract({onComplete:function(){f.switchOrientation(e);a.compute('end',!1);b.busy=!1;if(d=='animate'){a.onClick(a.clickedNode.id,c)}else {if(d=='replot'){a.select(a.clickedNode.id,c)}}}},e)}},switchAlignment:function(c,a,b){this.config.align=c;if(a=='animate'){this.select(this.clickedNode.id,b)}else {if(a=='replot'){this.onClick(this.clickedNode.id,b)}}},addNodeInPath:function(a){e.push(a);this.select(this.clickedNode&&this.clickedNode.id||this.root)},clearNodesInPath:function(a){e.length=0;this.select(this.clickedNode&&this.clickedNode.id||this.root)},refresh:function(){this.reposition();this.select(this.clickedNode&&this.clickedNode.id||this.root)},reposition:function(){this.graph.computeLevels(this.root,0,'ignore');this.geom.setRightLevelToShow(this.clickedNode,this.canvas);this.graph.eachNode(function(a){if(a.exist){a.drawn=!0}});this.compute('end')},requestNodes:function(c,f){var b=a.merge(this.controller,f),e=this.config.levelsToShow;if(b.request){var d=[],g=c._depth;c.eachLevel(0,e,function(a){if(a.drawn&&!a.anySubnode()){d.push(a);a._level=e-(a._depth-g)}});this.group.requestNodes(d,b)}else {b.onComplete()}},contract:function(g,b){var f=this.config.orientation;var c=this.geom,e=this.group;if(b){c.switchOrientation(b)}var d=y.call(this);if(b){c.switchOrientation(f)}e.contract(d,a.merge(this.controller,g))},move:function(d,c){this.compute('end',!1);var b=c.Move,e={x:b.offsetX,y:b.offsetY};if(b.enable){this.geom.translate(d.endPos.add(e).$scale(-1),'end')}this.fx.animate(a.merge(this.controller,{modes:['linear']},c))},expand:function(b,c){var d=w.call(this,b);this.group.expand(d,a.merge(this.controller,c))},selectPath:function(f){var d=this;this.graph.eachNode(function(a){a.selected=!1});function D(b){if(b==null||b.selected){return}b.selected=!0;a.each(d.group.getSiblings([b])[b.id],function(a){a.exist=!0;a.drawn=!0});var c=b.getParents();c=c.length>0?c[0]:null;D(c)}for(var b=0,c=[f.id].concat(e);b<c.length;b++){D(this.graph.getNode(c[b]))}},setRoot:function(b,f,e){if(this.busy){return}this.busy=!0;var c=this,g=this.canvas;var d=this.graph.getNode(this.root);var a=this.graph.getNode(b);function C(){if(this.config.multitree&&a.data.$orn){var i=a.data.$orn;var h={left:'right',right:'left',top:'bottom',bottom:'top'}[i];d.data.$orn=h;(function H(a){a.eachSubnode(function(c){if(c.id!=b){c.data.$orn=h;H(c)}})})(d);delete a.data.$orn}this.root=b;this.clickedNode=a;this.graph.computeLevels(this.root,0,'ignore');this.geom.setRightLevelToShow(a,g,{execHide:!1,onShow:function(c){if(!c.drawn){c.drawn=!0;c.setData('alpha',1,'end');c.setData('alpha',0);c.pos.setc(a.pos.x,a.pos.y)}}});this.compute('end');this.busy=!0;this.fx.animate({modes:['linear','node-property:alpha'],onComplete:function(){c.busy=!1;c.onClick(b,{onComplete:function(){e&&e.onComplete()}})}})}delete d.data.$orns;if(f=='animate'){C.call(this);c.selectPath(a)}else {if(f=='replot'){C.call(this);this.select(this.root)}}},addSubtree:function(d,c,b){if(c=='replot'){this.op.sum(d,a.extend({type:'replot'},b||{}))}else {if(c=='animate'){this.op.sum(d,a.extend({type:'fade:seq'},b||{}))}}},removeSubtree:function(g,e,d,c){var f=this.graph.getNode(g),b=[];f.eachLevel(+!e,!1,function(a){b.push(a.id)});if(d=='replot'){this.op.removeNode(b,a.extend({type:'replot'},c||{}))}else {if(d=='animate'){this.op.removeNode(b,a.extend({type:'fade:seq'},c||{}))}}},select:function(i,g){var e=this.group,h=this.geom;var d=this.graph.getNode(i),f=this.canvas;var j=this.graph.getNode(this.root);var c=a.merge(this.controller,g);var b=this;c.onBeforeCompute(d);this.selectPath(d);this.clickedNode=d;this.requestNodes(d,{onComplete:function(){e.hide(e.prepare(y.call(b)),c);h.setRightLevelToShow(d,f);b.compute('current');b.graph.eachNode(function(b){var a=b.pos.getc(!0);b.startPos.setc(a.x,a.y);b.endPos.setc(a.x,a.y);b.visited=!1});var a={x:c.offsetX,y:c.offsetY};b.geom.translate(d.endPos.add(a).$scale(-1),['start','current','end']);e.show(w.call(b));b.plot();c.onAfterCompute(b.clickedNode);c.onComplete()}})},onClick:function(e,i){var g=this.canvas,d=this,j=this.geom,f=this.config;var h={Move:{enable:!0,offsetX:f.offsetX||0,offsetY:f.offsetY||0},setRightLevelToShowConfig:!1,onBeforeRequest:a.empty,onBeforeContract:a.empty,onBeforeMove:a.empty,onBeforeExpand:a.empty};var c=a.merge(this.controller,h,i);if(!this.busy){this.busy=!0;var b=this.graph.getNode(e);this.selectPath(b,this.clickedNode);this.clickedNode=b;c.onBeforeCompute(b);c.onBeforeRequest(b);this.requestNodes(b,{onComplete:function(){c.onBeforeContract(b);d.contract({onComplete:function(){j.setRightLevelToShow(b,g,c.setRightLevelToShowConfig);c.onBeforeMove(b);d.move(b,{Move:c.Move,onComplete:function(){c.onBeforeExpand(b);d.expand(b,{onComplete:function(){d.busy=!1;c.onAfterCompute(e);c.onComplete()}})}})}})}})}}})}();$jit.ST.$extend=!0;$jit.ST.Op=new b({Implements:c.Op});$jit.ST.Group=new b({initialize:function(a){this.viz=a;this.canvas=a.canvas;this.config=a.config;this.animation=new r();this.nodes=null},requestNodes:function(b,e){var h=0,d=b.length,g={};var f=function(){e.onComplete()};var c=this.viz;if(d==0){f()}for(var a=0;a<d;a++){g[b[a].id]=b[a];e.request(b[a].id,b[a]._level,{onComplete:function(g,a){if(a&&a.children){a.id=g;c.op.sum(a,{type:'nothing'})}if(++h==d){c.graph.computeLevels(c.root,0);f()}}})}},contract:function(c,b){var e=this.viz;var d=this;c=this.prepare(c);this.animation.setOptions(a.merge(b,{$animating:!1,compute:function(a){if(a==1){a=0.99}d.plotStep(1-a,b,this.$animating);this.$animating='contract'},complete:function(){d.hide(c,b)}})).start()},hide:function(d,c){var f=this.viz;for(var b=0;b<d.length;b++){if(!0||!c||!c.request){d[b].eachLevel(1,!1,function(b){if(b.exist){a.extend(b,{drawn:!1,exist:!1})}})}else {var e=[];d[b].eachLevel(1,!1,function(a){e.push(a.id)});f.op.removeNode(e,{type:'nothing'});f.labels.clearLabels()}}c.onComplete()},expand:function(d,b){var c=this;this.show(d);this.animation.setOptions(a.merge(b,{$animating:!1,compute:function(a){c.plotStep(a,b,this.$animating);this.$animating='expand'},complete:function(){c.plotStep(undefined,b,!1);b.onComplete()}})).start()},show:function(b){var c=this.config;this.prepare(b);a.each(b,function(a){if(c.multitree&&!('$orn' in a.data)){delete a.data.$orns;var d=' ';a.eachSubnode(function(c){if('$orn' in c.data&&d.indexOf(c.data.$orn)<0&&c.exist&&!c.drawn){d+=c.data.$orn+' '}});a.data.$orns=d}a.eachLevel(0,c.levelsToShow,function(c){if(c.exist){c.drawn=!0}})})},prepare:function(a){this.nodes=this.getNodesWithChildren(a);return this.nodes},getNodesWithChildren:function(a){var e=[],f=this.config,g=this.viz.root;a.sort(function(c,b){return (c._depth<=b._depth)-(c._depth>=b._depth)});for(var b=0;b<a.length;b++){if(a[b].anySubnode('exist')){for(var d=b+1,c=!1;!c&&d<a.length;d++){if(!f.multitree||'$orn' in a[d].data){c=c||a[b].isDescendantOf(a[d].id)}}if(!c){e.push(a[b])}}}return e},plotStep:function(k,j,l){var h=this.viz,n=this.config,m=h.canvas,i=m.getCtx(),d=this.nodes;var c,b;var e={};for(c=0;c<d.length;c++){b=d[c];e[b.id]=[];var g=n.multitree&&!('$orn' in b.data);var f=g&&b.data.$orns;b.eachSubgraph(function(a){if(g&&f&&f.indexOf(a.data.$orn)>0&&a.drawn){a.drawn=!1;e[b.id].push(a)}else {if((!g||!f)&&a.drawn){a.drawn=!1;e[b.id].push(a)}}});b.drawn=!0}if(d.length>0){h.fx.plot()}for(c in e){a.each(e[c],function(a){a.drawn=!0})}for(c=0;c<d.length;c++){b=d[c];i.save();h.fx.plotSubtree(b,j,k,l);i.restore()}},getSiblings:function(c){var b={};a.each(c,function(a){var e=a.getParents();if(e.length==0){b[a.id]=[a]}else {var d=[];e[0].eachSubnode(function(b){d.push(b)});b[a.id]=d}});return b}});$jit.ST.Geom=new b({Implements:c.Geom,switchOrientation:function(a){this.config.orientation=a},dispatch:function(){var a=Array.prototype.slice.call(arguments);var c=a.shift(),d=a.length;var b=function(a){return typeof a=='function'?a():a};if(d==2){return c=='top'||c=='bottom'?b(a[0]):b(a[1])}else {if(d==4){switch(c){case 'top':return b(a[0]);case 'right':return b(a[1]);case 'bottom':return b(a[2]);case 'left':return b(a[3]);}}}return undefined},getSize:function(a,h){var e=a.data,b=this.config;var g=b.siblingOffset;var d=b.multitree&&'$orn' in e&&e.$orn||b.orientation;var f=a.getData('width')+g;var c=a.getData('height')+g;if(!h){return this.dispatch(d,c,f)}else {return this.dispatch(d,f,c)}},getTreeBaseSize:function(a,b,e){var d=this.getSize(a,!0),c=0,f=this;if(e(b,a)){return d}if(b===0){return 0}a.eachSubnode(function(d){c+=f.getTreeBaseSize(d,b-1,e)});return (d>c?d:c)+this.config.subtreeOffset},getEdge:function(g,h,d){var a=function(a,b){return function(){return g.pos.add(new f(a,b))}};var e=this.node;var b=g.getData('width');var c=g.getData('height');if(h=='begin'){if(e.align=='center'){return this.dispatch(d,a(0,c/2),a(-b/2,0),a(0,-c/2),a(b/2,0))}else {if(e.align=='left'){return this.dispatch(d,a(0,c),a(0,0),a(0,0),a(b,0))}else {if(e.align=='right'){return this.dispatch(d,a(0,0),a(-b,0),a(0,-c),a(0,0))}else {throw 'align: not implemented'}}}}else {if(h=='end'){if(e.align=='center'){return this.dispatch(d,a(0,-c/2),a(b/2,0),a(0,c/2),a(-b/2,0))}else {if(e.align=='left'){return this.dispatch(d,a(0,0),a(b,0),a(0,c),a(0,0))}else {if(e.align=='right'){return this.dispatch(d,a(0,-c),a(0,0),a(0,0),a(-b,0))}else {throw 'align: not implemented'}}}}}},getScaledTreePosition:function(b,h){var e=this.node;var d=b.getData('width');var c=b.getData('height');var g=this.config.multitree&&'$orn' in b.data&&b.data.$orn||this.config.orientation;var a=function(a,c){return function(){return b.pos.add(new f(a,c)).$scale(1-h)}};if(e.align=='left'){return this.dispatch(g,a(0,c),a(0,0),a(0,0),a(d,0))}else {if(e.align=='center'){return this.dispatch(g,a(0,c/2),a(-d/2,0),a(0,-c/2),a(d/2,0))}else {if(e.align=='right'){return this.dispatch(g,a(0,0),a(-d,0),a(0,-c),a(0,0))}else {throw 'align: not implemented'}}}},treeFitsInCanvas:function(a,e,d){var b=e.getSize();var g=this.config.multitree&&'$orn' in a.data&&a.data.$orn||this.config.orientation;var f=this.dispatch(g,b.width,b.height);var c=this.getTreeBaseSize(a,d,function(c,b){return c===0||!b.anySubnode()});return c<f}});$jit.ST.Plot=new b({Implements:c.Plot,plotSubtree:function(c,h,b,g){var d=this.viz,i=d.canvas,j=d.config;b=Math.min(Math.max(0.001,b),1);if(b>=0){c.drawn=!1;var f=i.getCtx();var e=d.geom.getScaledTreePosition(c,b);f.translate(e.x,e.y);f.scale(b,b)}this.plotTree(c,a.merge(h,{withLabels:!0,hideLabels:!!b,plotSubtree:function(f,e){var a=j.multitree&&!('$orn' in c.data);var d=a&&c.getData('orns');return !a||d.indexOf(c.getData('orn'))>-1}}),g);if(b>=0){c.drawn=!0}},getAlignedPos:function(a,e,d){var f=this.node;var b,c;if(f.align=='center'){b={x:a.x-e/2,y:a.y-d/2}}else {if(f.align=='left'){c=this.config.orientation;if(c=='bottom'||c=='top'){b={x:a.x-e/2,y:a.y}}else {b={x:a.x,y:a.y-d/2}}}else {if(f.align=='right'){c=this.config.orientation;if(c=='bottom'||c=='top'){b={x:a.x-e/2,y:a.y-d}}else {b={x:a.x-e,y:a.y-d/2}}}else {throw 'align: not implemented'}}}return b},getOrientation:function(b){var d=this.config;var c=d.orientation;if(d.multitree){var e=b.nodeFrom;var a=b.nodeTo;c='$orn' in e.data&&e.data.$orn||'$orn' in a.data&&a.data.$orn}return c}});$jit.ST.Label={};$jit.ST.Label.Native=new b({Implements:c.Label.Native,renderLabel:function(g,a,h){var f=g.getCtx(),e=a.pos.getc(!0),b=a.getData('width'),d=a.getData('height'),c=this.viz.fx.getAlignedPos(e,b,d);f.fillText(a.name,c.x+b/2,c.y+d/2)}});$jit.ST.Label.DOM=new b({Implements:c.Label.DOM,placeLabel:function(n,h,r){var m=h.pos.getc(!0),l=this.viz.config,j=l.Node,d=this.viz.canvas,g=h.getData('width'),i=h.getData('height'),a=d.getSize(),b,c;var o=d.translateOffsetX,s=d.translateOffsetY,q=d.scaleOffsetX,p=d.scaleOffsetY,f=m.x*q+o,e=m.y*p+s;if(j.align=='center'){b={x:Math.round(f-g/2+a.width/2),y:Math.round(e-i/2+a.height/2)}}else {if(j.align=='left'){c=l.orientation;if(c=='bottom'||c=='top'){b={x:Math.round(f-g/2+a.width/2),y:Math.round(e+a.height/2)}}else {b={x:Math.round(f+a.width/2),y:Math.round(e-i/2+a.height/2)}}}else {if(j.align=='right'){c=l.orientation;if(c=='bottom'||c=='top'){b={x:Math.round(f-g/2+a.width/2),y:Math.round(e-i+a.height/2)}}else {b={x:Math.round(f-g+a.width/2),y:Math.round(e-i/2+a.height/2)}}}else {throw 'align: not implemented'}}}var k=n.style;k.left=b.x+'px';k.top=b.y+'px';k.display=this.fitsInCanvas(b,d)?'':'none';r.onPlaceLabel(n,h)}});$jit.ST.Label.SVG=new b({Implements:[$jit.ST.Label.DOM,c.Label.SVG],initialize:function(a){this.viz=a}});$jit.ST.Label.HTML=new b({Implements:[$jit.ST.Label.DOM,c.Label.HTML],initialize:function(a){this.viz=a}});$jit.ST.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(d,e){var b=d.getData('dim'),c=this.getAlignedPos(d.pos.getc(!0),b,b),a=b/2;this.nodeHelper.circle.render('fill',{x:c.x+a,y:c.y+a},a,e)},contains:function(c,e){var b=c.getData('dim'),d=this.getAlignedPos(c.pos.getc(!0),b,b),a=b/2;this.nodeHelper.circle.contains({x:d.x+a,y:d.y+a},e,a)}},square:{render:function(d,e){var b=d.getData('dim'),a=b/2,c=this.getAlignedPos(d.pos.getc(!0),b,b);this.nodeHelper.square.render('fill',{x:c.x+a,y:c.y+a},a,e)},contains:function(c,e){var b=c.getData('dim'),d=this.getAlignedPos(c.pos.getc(!0),b,b),a=b/2;this.nodeHelper.square.contains({x:d.x+a,y:d.y+a},e,a)}},ellipse:{render:function(c,e){var b=c.getData('width'),a=c.getData('height'),d=this.getAlignedPos(c.pos.getc(!0),b,a);this.nodeHelper.ellipse.render('fill',{x:d.x+b/2,y:d.y+a/2},b,a,e)},contains:function(c,e){var b=c.getData('width'),a=c.getData('height'),d=this.getAlignedPos(c.pos.getc(!0),b,a);this.nodeHelper.ellipse.contains({x:d.x+b/2,y:d.y+a/2},e,b,a)}},rectangle:{render:function(c,e){var b=c.getData('width'),a=c.getData('height'),d=this.getAlignedPos(c.pos.getc(!0),b,a);this.nodeHelper.rectangle.render('fill',{x:d.x+b/2,y:d.y+a/2},b,a,e)},contains:function(c,e){var b=c.getData('width'),a=c.getData('height'),d=this.getAlignedPos(c.pos.getc(!0),b,a);this.nodeHelper.rectangle.contains({x:d.x+b/2,y:d.y+a/2},e,b,a)}}});$jit.ST.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(c,h){var e=this.getOrientation(c),a=c.nodeFrom,b=c.nodeTo,d=a._depth<b._depth,g=this.viz.geom.getEdge(d?a:b,'begin',e),f=this.viz.geom.getEdge(d?b:a,'end',e);this.edgeHelper.line.render(g,f,h)},contains:function(b,h){var e=this.getOrientation(b),c=b.nodeFrom,a=b.nodeTo,d=c._depth<a._depth,g=this.viz.geom.getEdge(d?c:a,'begin',e),f=this.viz.geom.getEdge(d?a:c,'end',e);return this.edgeHelper.line.contains(g,f,h,this.edge.epsilon)}},arrow:{render:function(a,i){var c=this.getOrientation(a),d=a.nodeFrom,h=a.nodeTo,e=a.getData('dim'),f=this.viz.geom.getEdge(d,'begin',c),g=this.viz.geom.getEdge(h,'end',c),b=a.data.$direction,j=b&&b.length>1&&b[0]!=d.id;this.edgeHelper.arrow.render(f,g,e,j,i)},contains:function(b,h){var e=this.getOrientation(b),c=b.nodeFrom,a=b.nodeTo,d=c._depth<a._depth,g=this.viz.geom.getEdge(d?c:a,'begin',e),f=this.viz.geom.getEdge(d?a:c,'end',e);return this.edgeHelper.arrow.contains(g,f,h,this.edge.epsilon)}},'quadratic:begin':{render:function(d,j){var g=this.getOrientation(d);var f=d.nodeFrom,h=d.nodeTo,i=f._depth<h._depth,a=this.viz.geom.getEdge(i?f:h,'begin',g),b=this.viz.geom.getEdge(i?h:f,'end',g),e=d.getData('dim'),c=j.getCtx();c.beginPath();c.moveTo(a.x,a.y);switch(g){case 'left':c.quadraticCurveTo(a.x+e,a.y,b.x,b.y);break;case 'right':c.quadraticCurveTo(a.x-e,a.y,b.x,b.y);break;case 'top':c.quadraticCurveTo(a.x,a.y+e,b.x,b.y);break;case 'bottom':c.quadraticCurveTo(a.x,a.y-e,b.x,b.y);break;}c.stroke()}},'quadratic:end':{render:function(c,j){var f=this.getOrientation(c);var e=c.nodeFrom,g=c.nodeTo,h=e._depth<g._depth,i=this.viz.geom.getEdge(h?e:g,'begin',f),a=this.viz.geom.getEdge(h?g:e,'end',f),d=c.getData('dim'),b=j.getCtx();b.beginPath();b.moveTo(i.x,i.y);switch(f){case 'left':b.quadraticCurveTo(a.x-d,a.y,a.x,a.y);break;case 'right':b.quadraticCurveTo(a.x+d,a.y,a.x,a.y);break;case 'top':b.quadraticCurveTo(a.x,a.y-d,a.x,a.y);break;case 'bottom':b.quadraticCurveTo(a.x,a.y+d,a.x,a.y);break;}b.stroke()}},bezier:{render:function(e,j){var g=this.getOrientation(e),f=e.nodeFrom,h=e.nodeTo,i=f._depth<h._depth,b=this.viz.geom.getEdge(i?f:h,'begin',g),a=this.viz.geom.getEdge(i?h:f,'end',g),c=e.getData('dim'),d=j.getCtx();d.beginPath();d.moveTo(b.x,b.y);switch(g){case 'left':d.bezierCurveTo(b.x+c,b.y,a.x-c,a.y,a.x,a.y);break;case 'right':d.bezierCurveTo(b.x-c,b.y,a.x+c,a.y,a.x,a.y);break;case 'top':d.bezierCurveTo(b.x,b.y+c,a.x,a.y-c,a.x,a.y);break;case 'bottom':d.bezierCurveTo(b.x,b.y-c,a.x,a.y+c,a.x,a.y);break;}d.stroke()}}});$jit.ST.Plot.NodeTypes.implement({'areachart-stacked':{render:function(d,G){var K=d.pos.getc(!0),h=d.getData('width'),F=d.getData('height'),z=this.getAlignedPos(K,h,F),f=z.x,e=z.y,A=d.getData('stringArray'),g=d.getData('dimArray'),o=d.getData('valueArray'),x=a.reduce(o,function(a,b){return a+b[0]},0),w=a.reduce(o,function(a,b){return a+b[1]},0),l=d.getData('colorArray'),n=l.length,m=d.getData('config'),H=d.getData('gradient'),E=m.showLabels,I=m.showAggregates,j=m.Label,J=d.getData('prev');var b=G.getCtx(),p=d.getData('border');if(l&&g&&A){for(var c=0,D=g.length,i=0,k=0,v=0;c<D;c++){b.fillStyle=b.strokeStyle=l[c%n];b.save();if(H&&(g[c][0]>0||g[c][1]>0)){var t=i+g[c][0],r=k+g[c][1],y=Math.atan((r-t)/h),C=55;var u=b.createLinearGradient(f+h/2,e-(t+r)/2,f+h/2+C*Math.sin(y),e-(t+r)/2+C*Math.cos(y));var s=a.rgbToHex(a.map(a.hexToRgb(l[c%n].slice(1)),function(a){return a*0.85>>0}));u.addColorStop(0,l[c%n]);u.addColorStop(1,s);b.fillStyle=u}b.beginPath();b.moveTo(f,e-i);b.lineTo(f+h,e-k);b.lineTo(f+h,e-k-g[c][1]);b.lineTo(f,e-i-g[c][0]);b.lineTo(f,e-i);b.fill();b.restore();if(p){var B=p.name==A[c];var L=B?0.7:0.8;var s=a.rgbToHex(a.map(a.hexToRgb(l[c%n].slice(1)),function(a){return a*L>>0}));b.strokeStyle=s;b.lineWidth=B?4:1;b.save();b.beginPath();if(p.index===0){b.moveTo(f,e-i);b.lineTo(f,e-i-g[c][0])}else {b.moveTo(f+h,e-k);b.lineTo(f+h,e-k-g[c][1])}b.stroke();b.restore()}i+=g[c][0]||0;k+=g[c][1]||0;if(g[c][0]>0){v+=o[c][0]||0}}if(J&&j.type=='Native'){b.save();b.beginPath();b.fillStyle=b.strokeStyle=j.color;b.font=j.style+' '+j.size+'px '+j.family;b.textAlign='center';b.textBaseline='middle';var q=I(d.name,x,w,d,v);if(q!==!1){b.fillText(q!==!0?q:v,f,e-i-m.labelOffset-j.size/2,h)}if(E(d.name,x,w,d)){b.fillText(d.name,f,e+j.size/2+m.labelOffset)}b.restore()}}},contains:function(a,b){var q=a.pos.getc(!0),e=a.getData('width'),l=a.getData('height'),k=this.getAlignedPos(q,e,l),g=k.x,d=k.y,m=a.getData('dimArray'),n=b.x-g;if(b.x<g||b.x>g+e||b.y>d||b.y<d-l){return !1}for(var c=0,o=m.length,f=d,h=d;c<o;c++){var i=m[c];f-=i[0];h-=i[1];var p=f+(h-f)*n/e;if(b.y>=p){var j=+(n>e/2);return {name:a.getData('stringArray')[c],color:a.getData('colorArray')[c],value:a.getData('valueArray')[c][j],index:j}}}return !1}}});$jit.AreaChart=new b({st:null,colors:['#416D9C','#70A35E','#EBB056','#C74243','#83548B','#909291','#557EAA'],selected:{},busy:!1,initialize:function(g){this.controller=this.config=a.merge(d('Canvas','Margin','Label','AreaChart'),{Label:{type:'Native'}},g);var c=this.config.showLabels,f=a.type(c),b=this.config.showAggregates,e=a.type(b);this.config.showLabels=f=='function'?c:a.lambda(c);this.config.showAggregates=e=='function'?b:a.lambda(b);this.initializeViz()},initializeViz:function(){var b=this.config,c=this,g=b.type.split(':')[0],f={};var d=new $jit.ST({injectInto:b.injectInto,width:b.width,height:b.height,orientation:'bottom',levelDistance:0,siblingOffset:0,subtreeOffset:0,withLabels:b.Label.type!='Native',useCanvas:b.useCanvas,Label:{type:b.Label.type},Node:{overridable:!0,type:'areachart-'+g,align:'left',width:1,height:1},Edge:{type:'none'},Tips:{enable:b.Tips.enable,type:'Native',force:!0,onShow:function(e,d,a){var c=a;b.Tips.onShow(e,c,d)}},Events:{enable:!0,type:'Native',onClick:function(f,d,e){if(!b.filterOnClick&&!b.Events.enable){return}var a=d.getContains();if(a){b.filterOnClick&&c.filter(a.name)}b.Events.enable&&b.Events.onClick(a,d,e)},onRightClick:function(d,e,a){if(!b.restoreOnRightClick){return}c.restore()},onMouseMove:function(d,e,f){if(!b.selectOnHover){return}if(d){var a=e.getContains();c.select(d.id,a.name,a.index)}else {c.select(!1,!1,!1)}}},onCreateLabel:function(j,c){var k=b.Label,n=c.getData('valueArray'),l=a.reduce(n,function(a,b){return a+b[0]},0),m=a.reduce(n,function(a,b){return a+b[1]},0);if(c.getData('prev')){var g={wrapper:document.createElement('div'),aggregate:document.createElement('div'),label:document.createElement('div')};var e=g.wrapper,h=g.label,i=g.aggregate,d=e.style,p=h.style,o=i.style;f[c.id]=g;e.appendChild(h);e.appendChild(i);if(!b.showLabels(c.name,l,m,c)){h.style.display='none'}if(!b.showAggregates(c.name,l,m,c)){i.style.display='none'}d.position='relative';d.overflow='visible';d.fontSize=k.size+'px';d.fontFamily=k.family;d.color=k.color;d.textAlign='center';o.position=p.position='absolute';j.style.width=c.getData('width')+'px';j.style.height=c.getData('height')+'px';h.innerHTML=c.name;j.appendChild(e)}},onPlaceLabel:function(i,c){if(!c.getData('prev')){return}var j=f[c.id],l=j.wrapper.style,d=j.label.style,g=j.aggregate.style,q=c.getData('width'),u=c.getData('height'),n=c.getData('dimArray'),e=c.getData('valueArray'),p=a.reduce(e,function(a,b){return a+b[0]},0),o=a.reduce(e,function(a,b){return a+b[1]},0),s=parseInt(l.fontSize,10),v=i.style;if(n&&e){if(b.showLabels(c.name,p,o,c)){d.display=''}else {d.display='none'}var m=b.showAggregates(c.name,p,o,c);if(m!==!1){g.display=''}else {g.display='none'}l.width=g.width=d.width=i.style.width=q+'px';g.left=d.left=-q/2+'px';for(var h=0,t=e.length,r=0,k=0;h<t;h++){if(n[h][0]>0){r+=e[h][0];k+=n[h][0]}}g.top=-s-b.labelOffset+'px';d.top=b.labelOffset+k+'px';i.style.top=parseInt(i.style.top,10)-k+'px';i.style.height=l.height=k+'px';j.aggregate.innerHTML=m!==!0?m:r}}});var h=d.canvas.getSize(),e=b.Margin;d.config.offsetY=-h.height/2+e.bottom+(b.showLabels&&b.labelOffset+b.Label.size);d.config.offsetX=(e.right-e.left)/2;this.delegate=d;this.canvas=this.delegate.canvas},loadJSON:function(e){var j=a.time(),h=[],d=this.delegate,q=a.splat(e.label),o=a.splat(e.color||this.colors),f=this.config,s=!!f.type.split(':')[1],t=f.animate;for(var b=0,c=e.values,n=c.length;b<n-1;b++){var k=c[b],i=c[b-1],l=c[b+1];var p=a.splat(c[b].values),r=a.splat(c[b+1].values);var g=a.zip(p,r);var v=0,u=0;h.push({id:j+k.label,name:k.label,data:{value:g,'$valueArray':g,'$colorArray':o,'$stringArray':q,'$next':l.label,'$prev':i?i.label:!1,'$config':f,'$gradient':s},children:[]})}var m={id:j+'$root',name:'',data:{'$type':'none','$width':1,'$height':1},children:h};d.loadJSON(m);this.normalizeDims();d.compute();d.select(d.root);if(t){d.fx.animate({modes:['node-property:height:dimArray'],duration:1500})}},updateJSON:function(f,h){if(this.busy){return}this.busy=!0;var b=this.delegate,j=b.graph,g=f.label&&a.splat(f.label),e=f.values,k=this.config.animate,i=this,d={};for(var c=0,l=e.length;c<l;c++){d[e[c].label]=e[c]}j.eachNode(function(c){var b=d[c.name],j=c.getData('stringArray'),e=c.getData('valueArray'),i=c.getData('next');if(b){b.values=a.splat(b.values);a.each(e,function(d,a){d[0]=b.values[a];if(g){j[a]=g[a]}});c.setData('valueArray',e)}if(i){b=d[i];if(b){a.each(e,function(a,d){a[1]=b.values[d]})}}});this.normalizeDims();b.compute();b.select(b.root);if(k){b.fx.animate({modes:['node-property:height:dimArray'],duration:1500,onComplete:function(){i.busy=!1;h&&h.onComplete()}})}},filter:function(f,b){if(this.busy){return}this.busy=!0;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(!1,!1,!1);var d=a.splat(f);var c=this.delegate.graph.getNode(this.delegate.root);var e=this;this.normalizeDims();c.eachAdjacency(function(e){var c=e.nodeTo,h=c.getData('dimArray','end'),g=c.getData('stringArray');c.setData('dimArray',a.map(h,function(h,c){return a.indexOf(d,g[c])>-1?h:[0,0]}),'end')});this.delegate.fx.animate({modes:['node-property:dimArray'],duration:1500,onComplete:function(){e.busy=!1;b&&b.onComplete()}})},restore:function(a){if(this.busy){return}this.busy=!0;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(!1,!1,!1);this.normalizeDims();var b=this;this.delegate.fx.animate({modes:['node-property:height:dimArray'],duration:1500,onComplete:function(){b.busy=!1;a&&a.onComplete()}})},select:function(c,f,d){if(!this.config.selectOnHover){return}var a=this.selected;if(a.id!=c||a.name!=f||a.index!=d){a.id=c;a.name=f;a.index=d;this.delegate.graph.eachNode(function(a){a.setData('border',!1)});if(c){var b=this.delegate.graph.getNode(c);b.setData('border',a);var e=d===0?'prev':'next';e=b.getData(e);if(e){b=this.delegate.graph.getByName(e);if(b){b.setData('border',{name:f,index:1-d})}}}this.delegate.plot()}},getLegend:function(){var d={};var b;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(a){b=a.nodeTo});var c=b.getData('colorArray'),e=c.length;a.each(b.getData('stringArray'),function(b,a){d[b]=c[a%e]});return d},getMaxValue:function(){var b=0;this.delegate.graph.eachNode(function(f){var g=f.getData('valueArray'),d=0,c=0;a.each(g,function(a){d+=+a[0];c+=+a[1]});var e=c>d?c:d;b=b>e?b:e});return b},normalizeDims:function(){var i=this.delegate.graph.getNode(this.delegate.root),h=0;i.eachAdjacency(function(){h++});var b=this.getMaxValue()||1,g=this.delegate.canvas.getSize(),d=this.config,e=d.Margin,f=d.labelOffset+d.Label.size,j=(g.width-(e.left+e.right))/h,k=d.animate,c=g.height-(e.top+e.bottom)-(d.showAggregates&&f)-(d.showLabels&&f);this.delegate.graph.eachNode(function(d){var e=0,f=0,g=[];a.each(d.getData('valueArray'),function(a){e+=+a[0];f+=+a[1];g.push([0,0])});var h=f>e?f:e;d.setData('width',j);if(k){d.setData('height',h*c/b,'end');d.setData('dimArray',a.map(d.getData('valueArray'),function(a){return [a[0]*c/b,a[1]*c/b]}),'end');var i=d.getData('dimArray');if(!i){d.setData('dimArray',g)}}else {d.setData('height',h*c/b);d.setData('dimArray',a.map(d.getData('valueArray'),function(a){return [a[0]*c/b,a[1]*c/b]}))}})}});d.BarChart={$extend:!0,animate:!0,type:'stacked',labelOffset:3,barsOffset:0,hoveredColor:'#9fd4ff',orientation:'horizontal',showAggregates:!0,showLabels:!0,Tips:{enable:!1,onShow:a.empty,onHide:a.empty},Events:{enable:!1,onClick:a.empty}};$jit.ST.Plot.NodeTypes.implement({'barchart-stacked':{render:function(c,x){var A=c.pos.getc(!0),n=c.getData('width'),k=c.getData('height'),u=this.getAlignedPos(A,n,k),f=u.x,e=u.y,g=c.getData('dimArray'),z=c.getData('valueArray'),q=c.getData('colorArray'),t=q.length,w=c.getData('stringArray');var b=x.getCtx(),l={},s=c.getData('border'),D=c.getData('gradient'),i=c.getData('config'),p=i.orientation=='horizontal',y=i.showAggregates,B=i.showLabels,j=i.Label;if(q&&g&&w){for(var d=0,C=g.length,h=0,r=0;d<C;d++){b.fillStyle=b.strokeStyle=q[d%t];if(D){var o;if(p){o=b.createLinearGradient(f+h+g[d]/2,e,f+h+g[d]/2,e+k)}else {o=b.createLinearGradient(f,e-h-g[d]/2,f+n,e-h-g[d]/2)}var v=a.rgbToHex(a.map(a.hexToRgb(q[d%t].slice(1)),function(a){return a*0.5>>0}));o.addColorStop(0,v);o.addColorStop(0.5,q[d%t]);o.addColorStop(1,v);b.fillStyle=o}if(p){b.fillRect(f+h,e,g[d],k)}else {b.fillRect(f,e-h-g[d],n,g[d])}if(s&&s.name==w[d]){l.acum=h;l.dimValue=g[d]}h+=g[d]||0;r+=z[d]||0}if(s){b.save();b.lineWidth=2;b.strokeStyle=s.color;if(p){b.strokeRect(f+l.acum+1,e+1,l.dimValue-2,k-2)}else {b.strokeRect(f+1,e-l.acum-l.dimValue+1,n-2,l.dimValue-2)}b.restore()}if(j.type=='Native'){b.save();b.fillStyle=b.strokeStyle=j.color;b.font=j.style+' '+j.size+'px '+j.family;b.textBaseline='middle';var m=y(c.name,r,c);if(m!==!1){m=m!==!0?m:r;if(p){b.textAlign='right';b.fillText(m,f+h-i.labelOffset,e+k/2)}else {b.textAlign='center';b.fillText(m,f+n/2,e-k-j.size/2-i.labelOffset)}}if(B(c.name,r,c)){if(p){b.textAlign='center';b.translate(f-i.labelOffset-j.size/2,e+k/2);b.rotate(Math.PI/2);b.fillText(c.name,0,0)}else {b.textAlign='center';b.fillText(c.name,f+n/2,e+j.size/2+i.labelOffset)}}b.restore()}}},contains:function(a,b){var p=a.pos.getc(!0),g=a.getData('width'),i=a.getData('height'),l=this.getAlignedPos(p,g,i),d=l.x,e=l.y,m=a.getData('dimArray'),n=a.getData('config'),q=b.x-d,j=n.orientation=='horizontal';if(j){if(b.x<d||b.x>d+g||b.y>e+i||b.y<e){return !1}}else {if(b.x<d||b.x>d+g||b.y>e||b.y<e-i){return !1}}for(var c=0,o=m.length,f=j?d:e;c<o;c++){var k=m[c];if(j){f+=k;var h=f;if(b.x<=h){return {name:a.getData('stringArray')[c],color:a.getData('colorArray')[c],value:a.getData('valueArray')[c],label:a.name}}}else {f-=k;var h=f;if(b.y>=h){return {name:a.getData('stringArray')[c],color:a.getData('colorArray')[c],value:a.getData('valueArray')[c],label:a.name}}}}return !1}},'barchart-grouped':{render:function(d,z){var B=d.pos.getc(!0),r=d.getData('width'),q=d.getData('height'),w=this.getAlignedPos(B,r,q),f=w.x,e=w.y,g=d.getData('dimArray'),v=d.getData('valueArray'),y=v.length,o=d.getData('colorArray'),t=o.length,u=d.getData('stringArray');var b=z.getCtx(),k={},s=d.getData('border'),F=d.getData('gradient'),i=d.getData('config'),m=i.orientation=='horizontal',A=i.showAggregates,C=i.showLabels,j=i.Label,h=(m?q:r)/y;if(o&&g&&u){for(var c=0,D=y,E=0,p=0;c<D;c++){b.fillStyle=b.strokeStyle=o[c%t];if(F){var l;if(m){l=b.createLinearGradient(f+g[c]/2,e+h*c,f+g[c]/2,e+h*(c+1))}else {l=b.createLinearGradient(f+h*c,e-g[c]/2,f+h*(c+1),e-g[c]/2)}var x=a.rgbToHex(a.map(a.hexToRgb(o[c%t].slice(1)),function(a){return a*0.5>>0}));l.addColorStop(0,x);l.addColorStop(0.5,o[c%t]);l.addColorStop(1,x);b.fillStyle=l}if(m){b.fillRect(f,e+h*c,g[c],h)}else {b.fillRect(f+h*c,e-g[c],h,g[c])}if(s&&s.name==u[c]){k.acum=h*c;k.dimValue=g[c]}E+=g[c]||0;p+=v[c]||0}if(s){b.save();b.lineWidth=2;b.strokeStyle=s.color;if(m){b.strokeRect(f+1,e+k.acum+1,k.dimValue-2,h-2)}else {b.strokeRect(f+k.acum+1,e-k.dimValue+1,h-2,k.dimValue-2)}b.restore()}if(j.type=='Native'){b.save();b.fillStyle=b.strokeStyle=j.color;b.font=j.style+' '+j.size+'px '+j.family;b.textBaseline='middle';var n=A(d.name,p,d);if(n!==!1){n=n!==!0?n:p;if(m){b.textAlign='right';b.fillText(n,f+Math.max.apply(null,g)-i.labelOffset,e+q/2)}else {b.textAlign='center';b.fillText(n,f+r/2,e-Math.max.apply(null,g)-j.size/2-i.labelOffset)}}if(C(d.name,p,d)){if(m){b.textAlign='center';b.translate(f-i.labelOffset-j.size/2,e+q/2);b.rotate(Math.PI/2);b.fillText(d.name,0,0)}else {b.textAlign='center';b.fillText(d.name,f+r/2,e+j.size/2+i.labelOffset)}}b.restore()}}},contains:function(b,a){var n=b.pos.getc(!0),h=b.getData('width'),g=b.getData('height'),l=this.getAlignedPos(n,h,g),d=l.x,e=l.y,j=b.getData('dimArray'),p=j.length,q=b.getData('config'),r=a.x-d,k=q.orientation=='horizontal',i=(k?g:h)/p;if(k){if(a.x<d||a.x>d+h||a.y>e+g||a.y<e){return !1}}else {if(a.x<d||a.x>d+h||a.y>e||a.y<e-g){return !1}}for(var c=0,o=j.length;c<o;c++){var m=j[c];if(k){var f=e+i*c;if(a.x<=d+m&&a.y>=f&&a.y<=f+i){return {name:b.getData('stringArray')[c],color:b.getData('colorArray')[c],value:b.getData('valueArray')[c],label:b.name}}}else {var f=d+i*c;if(a.x>=f&&a.x<=f+i&&a.y>=e-m){return {name:b.getData('stringArray')[c],color:b.getData('colorArray')[c],value:b.getData('valueArray')[c],label:b.name}}}}return !1}}});$jit.BarChart=new b({st:null,colors:['#416D9C','#70A35E','#EBB056','#C74243','#83548B','#909291','#557EAA'],selected:{},busy:!1,initialize:function(g){this.controller=this.config=a.merge(d('Canvas','Margin','Label','BarChart'),{Label:{type:'Native'}},g);var c=this.config.showLabels,f=a.type(c),b=this.config.showAggregates,e=a.type(b);this.config.showLabels=f=='function'?c:a.lambda(c);this.config.showAggregates=e=='function'?b:a.lambda(b);this.initializeViz()},initializeViz:function(){var b=this.config,f=this;var i=b.type.split(':')[0],g=b.orientation=='horizontal',e={};var d=new $jit.ST({injectInto:b.injectInto,width:b.width,height:b.height,orientation:g?'left':'bottom',levelDistance:0,siblingOffset:b.barsOffset,subtreeOffset:0,withLabels:b.Label.type!='Native',useCanvas:b.useCanvas,Label:{type:b.Label.type},Node:{overridable:!0,type:'barchart-'+i,align:'left',width:1,height:1},Edge:{type:'none'},Tips:{enable:b.Tips.enable,type:'Native',force:!0,onShow:function(e,d,a){var c=a;b.Tips.onShow(e,c,d)}},Events:{enable:!0,type:'Native',onClick:function(e,a,c){if(!b.Events.enable){return}var d=a.getContains();b.Events.onClick(d,a,c)},onMouseMove:function(c,d,e){if(!b.hoveredColor){return}if(c){var a=d.getContains();f.select(c.id,a.name,a.index)}else {f.select(!1,!1,!1)}}},onCreateLabel:function(i,c){var l=b.Label,o=c.getData('valueArray'),n=a.reduce(o,function(a,b){return a+b},0);var g={wrapper:document.createElement('div'),aggregate:document.createElement('div'),label:document.createElement('div')};var f=g.wrapper,k=g.label,m=g.aggregate,d=f.style,j=k.style,h=m.style;e[c.id]=g;f.appendChild(k);f.appendChild(m);if(!b.showLabels(c.name,n,c)){j.display='none'}if(!b.showAggregates(c.name,n,c)){h.display='none'}d.position='relative';d.overflow='visible';d.fontSize=l.size+'px';d.fontFamily=l.family;d.color=l.color;d.textAlign='center';h.position=j.position='absolute';i.style.width=c.getData('width')+'px';i.style.height=c.getData('height')+'px';h.left=j.left='0px';k.innerHTML=c.name;i.appendChild(f)},onPlaceLabel:function(f,a){if(!e[a.id]){return}var l=e[a.id],h=l.wrapper.style,c=l.label.style,d=l.aggregate.style,q=b.type.split(':')[0]=='grouped',o=b.orientation=='horizontal',i=a.getData('dimArray'),n=a.getData('valueArray'),r=q&&o?Math.max.apply(null,i):a.getData('width'),g=q&&!o?Math.max.apply(null,i):a.getData('height'),p=parseInt(h.fontSize,10),t=f.style;if(i&&n){h.width=d.width=c.width=f.style.width=r+'px';for(var k=0,s=n.length,j=0;k<s;k++){if(i[k]>0){j+=n[k]}}if(b.showLabels(a.name,j,a)){c.display=''}else {c.display='none'}var m=b.showAggregates(a.name,j,a);if(m!==!1){d.display=''}else {d.display='none'}if(b.orientation=='horizontal'){d.textAlign='right';c.textAlign='left';c.textIndex=d.textIndent=b.labelOffset+'px';d.top=c.top=(g-p)/2+'px';f.style.height=h.height=g+'px'}else {d.top=-p-b.labelOffset+'px';c.top=b.labelOffset+g+'px';f.style.top=parseInt(f.style.top,10)-g+'px';f.style.height=h.height=g+'px'}l.aggregate.innerHTML=m!==!0?m:j}}});var h=d.canvas.getSize(),c=b.Margin;if(g){d.config.offsetX=h.width/2-c.left-(b.showLabels&&b.labelOffset+b.Label.size);d.config.offsetY=(c.bottom-c.top)/2}else {d.config.offsetY=-h.height/2+c.bottom+(b.showLabels&&b.labelOffset+b.Label.size);d.config.offsetX=(c.right-c.left)/2}this.delegate=d;this.canvas=this.delegate.canvas},loadJSON:function(e){if(this.busy){return}this.busy=!0;var j=a.time(),i=[],b=this.delegate,o=a.splat(e.label),n=a.splat(e.color||this.colors),d=this.config,p=!!d.type.split(':')[1],r=d.animate,q=d.orientation=='horizontal',g=this;for(var c=0,f=e.values,m=f.length;c<m;c++){var k=f[c];var h=a.splat(f[c].values);var s=0;i.push({id:j+k.label,name:k.label,data:{value:h,'$valueArray':h,'$colorArray':n,'$stringArray':o,'$gradient':p,'$config':d},children:[]})}var l={id:j+'$root',name:'',data:{'$type':'none','$width':1,'$height':1},children:i};b.loadJSON(l);this.normalizeDims();b.compute();b.select(b.root);if(r){if(q){b.fx.animate({modes:['node-property:width:dimArray'],duration:1500,onComplete:function(){g.busy=!1}})}else {b.fx.animate({modes:['node-property:height:dimArray'],duration:1500,onComplete:function(){g.busy=!1}})}}else {this.busy=!1}},updateJSON:function(d,c){if(this.busy){return}this.busy=!0;this.select(!1,!1,!1);var b=this.delegate;var f=b.graph;var i=d.values;var h=this.config.animate;var e=this;var g=this.config.orientation=='horizontal';a.each(i,function(e){var b=f.getByName(e.label);if(b){b.setData('valueArray',a.splat(e.values));if(d.label){b.setData('stringArray',a.splat(d.label))}}});this.normalizeDims();b.compute();b.select(b.root);if(h){if(g){b.fx.animate({modes:['node-property:width:dimArray'],duration:1500,onComplete:function(){e.busy=!1;c&&c.onComplete()}})}else {b.fx.animate({modes:['node-property:height:dimArray'],duration:1500,onComplete:function(){e.busy=!1;c&&c.onComplete()}})}}},select:function(b,c){if(!this.config.hoveredColor){return}var a=this.selected;if(a.id!=b||a.name!=c){a.id=b;a.name=c;a.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(d){if(b==d.id){d.setData('border',a)}else {d.setData('border',!1)}});this.delegate.plot()}},getLegend:function(){var d={};var b;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(a){b=a.nodeTo});var c=b.getData('colorArray'),e=c.length;a.each(b.getData('stringArray'),function(b,a){d[b]=c[a%e]});return d},getMaxValue:function(){var b=0,c=this.config.type.split(':')[0]=='stacked';this.delegate.graph.eachNode(function(f){var e=f.getData('valueArray'),d=0;if(!e){return}if(c){a.each(e,function(a){d+=+a})}else {d=Math.max.apply(null,e)}b=b>d?b:d});return b},setBarType:function(a){this.config.type=a;this.delegate.config.Node.type='barchart-'+a.split(':')[0]},normalizeDims:function(){var m=this.delegate.graph.getNode(this.delegate.root),g=0;m.eachAdjacency(function(){g++});var e=this.getMaxValue()||1,k=this.delegate.canvas.getSize(),b=this.config,d=b.Margin,j=d.left+d.right,h=d.top+d.bottom,c=b.orientation=='horizontal',n=(k[c?'height':'width']-(c?h:j)-(g-1)*b.barsOffset)/g,o=b.animate,f=k[c?'width':'height']-(c?j:h)-(!c&&b.showAggregates&&b.Label.size+b.labelOffset)-(b.showLabels&&b.Label.size+b.labelOffset),l=c?'height':'width',i=c?'width':'height';this.delegate.graph.eachNode(function(b){var c=0,d=[];a.each(b.getData('valueArray'),function(a){c+=+a;d.push(0)});b.setData(l,n);if(o){b.setData(i,c*f/e,'end');b.setData('dimArray',a.map(b.getData('valueArray'),function(a){return a*f/e}),'end');var g=b.getData('dimArray');if(!g){b.setData('dimArray',d)}}else {b.setData(i,c*f/e);b.setData('dimArray',a.map(b.getData('valueArray'),function(a){return a*f/e}))}})}});d.PieChart={$extend:!0,animate:!0,offset:25,sliceOffset:0,labelOffset:3,type:'stacked',hoveredColor:'#9fd4ff',Events:{enable:!1,onClick:a.empty},Tips:{enable:!1,onShow:a.empty,onHide:a.empty},showLabels:!0,resizeLabels:!1,updateHeights:!1};g.Radial=new b({compute:function(d){var b=a.splat(d||['current','start','end']);t.compute(this.graph,b,this.config);this.graph.computeLevels(this.root,0,'ignore');var c=this.createLevelDistanceFunc();this.computeAngularWidths(b);this.computePositions(b,c)},computePositions:function(h,g){var a=h;var e=this.graph;var b=e.getNode(this.root);var d=this.parent;var j=this.config;for(var c=0,i=a.length;c<i;c++){var f=a[c];b.setPos(p(0,0),f);b.setData('span',Math.PI*2,f)}b.angleSpan={begin:0,end:2*Math.PI};e.eachBFS(this.root,function(e){var s=e.angleSpan.end-e.angleSpan.begin;var j=e.angleSpan.begin;var t=g(e);var n=0,c=[],f={};e.eachSubnode(function(d){n+=d._treeAngularWidth;for(var i=0,k=a.length;i<k;i++){var b=a[i],j=d.getData('dim',b);f[b]=b in f?j>f[b]?j:f[b]:j}c.push(d)},'ignore');if(d&&d.id==e.id&&c.length>0&&c[0].dist){c.sort(function(b,a){return (b.dist>=a.dist)-(b.dist<=a.dist)})}for(var l=0,r=c.length;l<r;l++){var b=c[l];if(!b._flag){var k=b._treeAngularWidth/n*s;var o=j+k/2;for(var m=0,q=a.length;m<q;m++){var i=a[m];b.setPos(p(o,t),i);b.setData('span',k,i);b.setData('dim-quotient',b.getData('dim',i)/f[i],i)}b.angleSpan={begin:j,end:j+k};j+=k}}},'ignore')},setAngularWidthForNodes:function(a){this.graph.eachBFS(this.root,function(b,c){var d=b.getData('angularWidth',a[0])||5;b._angularWidth=d/c},'ignore')},setSubtreesAngularWidth:function(){var a=this;this.graph.eachNode(function(b){a.setSubtreeAngularWidth(b)},'ignore')},setSubtreeAngularWidth:function(a){var d=this,c=a._angularWidth,b=0;a.eachSubnode(function(c){d.setSubtreeAngularWidth(c);b+=c._treeAngularWidth},'ignore');a._treeAngularWidth=Math.max(c,b)},computeAngularWidths:function(a){this.setAngularWidthForNodes(a);this.setSubtreesAngularWidth()}});$jit.Sunburst=new b({Implements:[k,j,g.Radial],initialize:function(f){var e=$jit.Sunburst;var g={interpolation:'linear',levelDistance:100,Node:{type:'multipie',height:0},Edge:{type:'none'},Label:{textAlign:'start',textBaseline:'middle'}};this.controller=this.config=a.merge(d('Canvas','Node','Edge','Fx','Tips','NodeStyles','Events','Navigation','Controller','Label'),g,f);var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:h,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this,e);this.op=new e.Op(this);this.json=null;this.root=null;this.rotated=null;this.busy=!1;this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return (b._depth+1)*a}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute('end')},rotate:function(b,d,a){var c=b.getPos(a.property||'current').getp(!0).theta;this.rotated=b;this.rotateAngle(-c,d,a)},rotateAngle:function(f,b,c){var g=this;var e=a.merge(this.config,c||{},{modes:['polar']});var d=c.property||(b==='animate'?'end':'current');if(b==='animate'){this.fx.animation.pause()}this.graph.eachNode(function(e){var a=e.getPos(d);a.theta+=f;if(a.theta<0){a.theta+=Math.PI*2}});if(b=='animate'){this.fx.animate(e)}else {if(b=='replot'){this.fx.plot();this.busy=!1}}},plot:function(){this.fx.plot()}});$jit.Sunburst.$extend=!0;(function(d){d.Op=new b({Implements:c.Op});d.Plot=new b({Implements:c.Plot});d.Label={};d.Label.Native=new b({Implements:c.Label.Native,initialize:function(a){this.viz=a;this.label=a.config.Label;this.config=a.config},renderLabel:function(o,a,p){var n=a.getData('span');if(n<Math.PI/2&&Math.tan(n)*this.config.levelDistance*a._depth<10){return}var c=o.getCtx();var e=c.measureText(a.name);if(a.id==this.viz.root){var f=-e.width/2,i=0,m=0;var q=0}else {var j=5;var q=p.levelDistance-j;var h=a.pos.clone();h.rho+=j;var b=h.getp(!0);var k=h.getc(!0);var f=k.x,i=k.y;var g=Math.PI;var l=b.theta>g/2&&b.theta<3*g/2;var m=l?b.theta+g:b.theta;if(l){f-=Math.abs(Math.cos(b.theta)*e.width);i+=Math.sin(b.theta)*e.width}else {if(a.id==this.viz.root){f-=e.width/2}}}c.save();c.translate(f,i);c.rotate(m);c.fillText(a.name,0,0);c.restore()}});d.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,n){var l=b.pos.getc(!0),p=this.viz,m=this.viz.canvas;var i=m.getSize();var h={x:Math.round(l.x+i.width/2),y:Math.round(l.y+i.height/2)};a.setAttribute('x',h.x);a.setAttribute('y',h.y);var e=a.getBBox();if(e){var g=a.getAttribute('x');var k=a.getAttribute('y');var f=b.pos.getp(!0);var c=Math.PI;var j=f.theta>c/2&&f.theta<3*c/2;if(j){a.setAttribute('x',g-e.width);a.setAttribute('y',k-e.height)}else {if(b.id==p.root){a.setAttribute('x',g-e.width/2)}}var o=j?f.theta+c:f.theta;if(b._depth){a.setAttribute('transform','rotate('+o*360/(2*c)+' '+g+' '+k+')')}}n.onPlaceLabel(a,b)}});d.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(h,b,k){var a=b.pos.clone(),i=this.viz.canvas,g=b.getData('height'),j=(g||b._depth==0?g:this.viz.config.levelDistance)/2,f=i.getSize();a.rho+=j;a=a.getc(!0);var e={x:Math.round(a.x+f.width/2),y:Math.round(a.y+f.height/2)};var c=h.style;c.left=e.x+'px';c.top=e.y+'px';c.display=this.fitsInCanvas(e,i)?'':'none';k.onPlaceLabel(h,b)}});d.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1),anglecontains:function(f,g){var e=f.getData('span')/2,h=f.pos.theta;var b=h-e,c=h+e;if(b<0){b+=Math.PI*2}var a=Math.atan2(g.y,g.x);if(a<0){a+=Math.PI*2}if(b>c){return a>b&&a<=Math.PI*2||a<c}else {return a>b&&a<c}}},pie:{render:function(b,m){var j=b.getData('span')/2,l=b.pos.theta;var e=l-j,f=l+j;var i=b.pos.getp(!0);var c=new h(i.rho,e);var k=c.getc(!0);c.theta=f;var g=c.getc(!0);var a=m.getCtx();a.beginPath();a.moveTo(0,0);a.lineTo(k.x,k.y);a.moveTo(0,0);a.lineTo(g.x,g.y);a.moveTo(0,0);a.arc(0,0,i.rho*b.getData('dim-quotient'),e,f,!1);a.fill()},contains:function(b,a){if(this.nodeTypes.none.anglecontains.call(this,b,a)){var e=Math.sqrt(a.x*a.x+a.y*a.y);var f=this.config.levelDistance,c=b._depth;return e<=f*c}return !1}},multipie:{render:function(e,q){var n=e.getData('height');var i=n?n:this.config.levelDistance;var m=e.getData('span')/2,j=e.pos.theta;var c=j-m,f=j+m;var g=e.pos.getp(!0);var b=new h(g.rho,c);var p=b.getc(!0);b.theta=f;var l=b.getc(!0);b.rho+=i;var o=b.getc(!0);b.theta=c;var k=b.getc(!0);var a=q.getCtx();a.moveTo(0,0);a.beginPath();a.arc(0,0,g.rho,c,f,!1);a.arc(0,0,g.rho+i,f,c,!0);a.moveTo(p.x,p.y);a.lineTo(k.x,k.y);a.moveTo(l.x,l.y);a.lineTo(o.x,o.y);a.fill();if(e.collapsed){a.save();a.lineWidth=2;a.moveTo(0,0);a.beginPath();a.arc(0,0,g.rho+i+5,f-0.01,c+0.01,!0);a.stroke();a.restore()}},contains:function(b,a){if(this.nodeTypes.none.anglecontains.call(this,b,a)){var f=Math.sqrt(a.x*a.x+a.y*a.y);var e=b.getData('height');var h=e?e:this.config.levelDistance;var g=this.config.levelDistance,c=b._depth;return f>=g*c&&f<=g*c+h}return !1}},'gradient-multipie':{render:function(b,h){var g=h.getCtx();var f=b.getData('height');var i=f?f:this.config.levelDistance;var c=g.createRadialGradient(0,0,b.getPos().rho,0,0,b.getPos().rho+i);var j=a.hexToRgb(b.getData('color')),e=[];a.each(j,function(a){e.push(parseInt(a*0.5,10))});var k=a.rgbToHex(e);c.addColorStop(0,k);c.addColorStop(1,b.getData('color'));g.fillStyle=c;this.nodeTypes.multipie.render.call(this,b,h)},contains:function(a,b){return this.nodeTypes.multipie.contains.call(this,a,b)}},'gradient-pie':{render:function(b,g){var e=g.getCtx();var c=e.createRadialGradient(0,0,0,0,0,b.getPos().rho);var i=a.hexToRgb(b.getData('color')),f=[];a.each(i,function(a){f.push(parseInt(a*0.5,10))});var h=a.rgbToHex(f);c.addColorStop(1,h);c.addColorStop(0,b.getData('color'));e.fillStyle=c;this.nodeTypes.pie.render.call(this,b,g)},contains:function(a,b){return this.nodeTypes.pie.contains.call(this,a,b)}}});d.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,c){var b=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(b,e,c)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(e,c,b,this.edge.epsilon)}},arrow:{render:function(a,h){var f=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0),c=a.getData('dim'),b=a.data.$direction,g=b&&b.length>1&&b[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(f,e,c,g,h)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(e,c,b,this.edge.epsilon)}},hyperline:{render:function(e,f){var c=e.nodeFrom.pos.getc(),b=e.nodeTo.pos.getc(),a=Math.max(c.norm(),b.norm());this.edgeHelper.hyperline.render(c.$scale(1/a),b.$scale(1/a),a,f)},contains:a.lambda(!1)}})})($jit.Sunburst);$jit.Sunburst.Plot.NodeTypes.implement({'piechart-stacked':{render:function(c,C){var Q=c.pos.getp(!0),r=c.getData('dimArray'),E=c.getData('valueArray'),u=c.getData('colorArray'),K=u.length,y=c.getData('stringArray'),z=c.getData('span')/2,x=c.pos.theta,g=x-z,k=x+z,d=new h();var b=C.getCtx(),e={},D=c.getData('gradient'),s=c.getData('border'),f=c.getData('config'),B=f.showLabels,v=f.resizeLabels,o=f.Label;var l=f.sliceOffset*Math.cos((g+k)/2);var n=f.sliceOffset*Math.sin((g+k)/2);if(u&&r&&y){for(var j=0,A=r.length,i=0,H=0;j<A;j++){var m=r[j],q=u[j%K];if(m<=0){continue}b.fillStyle=b.strokeStyle=q;if(D&&m){var p=b.createRadialGradient(l,n,i+f.sliceOffset,l,n,i+m+f.sliceOffset);var I=a.hexToRgb(q),G=a.map(I,function(a){return a*0.8>>0}),J=a.rgbToHex(G);p.addColorStop(0,q);p.addColorStop(0.5,q);p.addColorStop(1,J);b.fillStyle=p}d.rho=i+f.sliceOffset;d.theta=g;var M=d.getc(!0);d.theta=k;var O=d.getc(!0);d.rho+=m;var N=d.getc(!0);d.theta=g;var P=d.getc(!0);b.beginPath();b.arc(l,n,i+0.01,g,k,!1);b.arc(l,n,i+m+0.01,k,g,!0);b.fill();if(s&&s.name==y[j]){e.acum=i;e.dimValue=r[j];e.begin=g;e.end=k}i+=m||0;H+=E[j]||0}if(s){b.save();b.globalCompositeOperation='source-over';b.lineWidth=2;b.strokeStyle=s.color;var L=g<k?1:-1;b.beginPath();b.arc(l,n,e.acum+0.01+1,e.begin,e.end,!1);b.arc(l,n,e.acum+e.dimValue+0.01-1,e.end,e.begin,!0);b.closePath();b.stroke();b.restore()}if(B&&o.type=='Native'){b.save();b.fillStyle=b.strokeStyle=o.color;var F=v?c.getData('normalizedDim'):1,t=o.size*F>>0;t=t<+v?+v:t;b.font=o.style+' '+t+'px '+o.family;b.textBaseline='middle';b.textAlign='center';d.rho=i+f.labelOffset+f.sliceOffset;d.theta=c.pos.theta;var w=d.getc(!0);b.fillText(c.name,w.x,w.y);b.restore()}}},contains:function(a,c){if(this.nodeTypes.none.anglecontains.call(this,a,c)){var e=Math.sqrt(c.x*c.x+c.y*c.y);var k=this.config.levelDistance,j=a._depth;var g=a.getData('config');if(e<=k*j+g.sliceOffset){var f=a.getData('dimArray');for(var b=0,i=f.length,d=g.sliceOffset;b<i;b++){var h=f[b];if(e>=d&&e<=d+h){return {name:a.getData('stringArray')[b],color:a.getData('colorArray')[b],value:a.getData('valueArray')[b],label:a.name}}d+=h}}return !1}return !1}}});$jit.PieChart=new b({sb:null,colors:['#416D9C','#70A35E','#EBB056','#C74243','#83548B','#909291','#557EAA'],selected:{},busy:!1,initialize:function(b){this.controller=this.config=a.merge(d('Canvas','PieChart','Label'),{Label:{type:'Native'}},b);this.initializeViz()},initializeViz:function(){var a=this.config,c=this;var e=a.type.split(':')[0];var b=new $jit.Sunburst({injectInto:a.injectInto,width:a.width,height:a.height,useCanvas:a.useCanvas,withLabels:a.Label.type!='Native',Label:{type:a.Label.type},Node:{overridable:!0,type:'piechart-'+e,width:1,height:1},Edge:{type:'none'},Tips:{enable:a.Tips.enable,type:'Native',force:!0,onShow:function(e,d,b){var c=b;a.Tips.onShow(e,c,d)}},Events:{enable:!0,type:'Native',onClick:function(e,b,c){if(!a.Events.enable){return}var d=b.getContains();a.Events.onClick(d,b,c)},onMouseMove:function(d,e,f){if(!a.hoveredColor){return}if(d){var b=e.getContains();c.select(d.id,b.name,b.index)}else {c.select(!1,!1,!1)}}},onCreateLabel:function(d,e){var c=a.Label;if(a.showLabels){var b=d.style;b.fontSize=c.size+'px';b.fontFamily=c.family;b.color=c.color;b.textAlign='center';d.innerHTML=e.name}},onPlaceLabel:function(j,b){if(!a.showLabels){return}var f=b.pos.getp(!0),g=b.getData('dimArray'),p=b.getData('span')/2,m=b.pos.theta,t=m-p,q=m+p,k=new h();var v=a.showLabels,e=a.resizeLabels,r=a.Label;if(g){for(var i=0,s=g.length,o=0;i<s;i++){o+=g[i]}var u=e?b.getData('normalizedDim'):1,d=r.size*u>>0;d=d<+e?+e:d;j.style.fontSize=d+'px';k.rho=o+a.labelOffset+a.sliceOffset;k.theta=(t+q)/2;var f=k.getc(!0);var l=c.canvas.getSize();var n={x:Math.round(f.x+l.width/2),y:Math.round(f.y+l.height/2)};j.style.left=n.x+'px';j.style.top=n.y+'px'}}});var d=b.canvas.getSize(),f=Math.min;b.config.levelDistance=f(d.width,d.height)/2-a.offset-a.sliceOffset;this.delegate=b;this.canvas=this.delegate.canvas;this.canvas.getCtx().globalCompositeOperation='lighter'},loadJSON:function(f){var j=a.time(),i=[],e=this.delegate,k=a.splat(f.label),n=k.length,d=a.splat(f.color||this.colors),r=d.length,g=this.config,q=!!g.type.split(':')[1],s=g.animate,p=n==1;for(var b=0,l=f.values,o=l.length;b<o;b++){var h=l[b];var c=a.splat(h.values);i.push({id:j+h.label,name:h.label,data:{value:c,'$valueArray':c,'$colorArray':p?a.splat(d[b%r]):d,'$stringArray':k,'$gradient':q,'$config':g,'$angularWidth':a.reduce(c,function(a,b){return a+b})},children:[]})}var m={id:j+'$root',name:'',data:{'$type':'none','$width':1,'$height':1},children:i};e.loadJSON(m);this.normalizeDims();e.refresh();if(s){e.fx.animate({modes:['node-property:dimArray'],duration:1500})}},updateJSON:function(c,d){if(this.busy){return}this.busy=!0;var b=this.delegate;var f=b.graph;var h=c.values;var g=this.config.animate;var e=this;a.each(h,function(e){var b=f.getByName(e.label),g=a.splat(e.values);if(b){b.setData('valueArray',g);b.setData('angularWidth',a.reduce(g,function(a,b){return a+b}));if(c.label){b.setData('stringArray',a.splat(c.label))}}});this.normalizeDims();if(g){b.compute('end');b.fx.animate({modes:['node-property:dimArray:span','linear'],duration:1500,onComplete:function(){e.busy=!1;d&&d.onComplete()}})}else {b.refresh()}},select:function(b,c){if(!this.config.hoveredColor){return}var a=this.selected;if(a.id!=b||a.name!=c){a.id=b;a.name=c;a.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(d){if(b==d.id){d.setData('border',a)}else {d.setData('border',!1)}});this.delegate.plot()}},getLegend:function(){var d={};var b;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(a){b=a.nodeTo});var c=b.getData('colorArray'),e=c.length;a.each(b.getData('stringArray'),function(b,a){d[b]=c[a%e]});return d},getMaxValue:function(){var b=0;this.delegate.graph.eachNode(function(e){var d=e.getData('valueArray'),c=0;a.each(d,function(a){c+=+a});b=b>c?b:c});return b},normalizeDims:function(){var f=this.delegate.graph.getNode(this.delegate.root),e=0;f.eachAdjacency(function(){e++});var c=this.getMaxValue()||1,d=this.config,g=d.animate,b=this.delegate.config.levelDistance;this.delegate.graph.eachNode(function(e){var i=0,f=[];a.each(e.getData('valueArray'),function(a){i+=+a;f.push(1)});var h=f.length==1&&!d.updateHeights;if(g){e.setData('dimArray',a.map(e.getData('valueArray'),function(a){return h?b:a*b/c}),'end');var j=e.getData('dimArray');if(!j){e.setData('dimArray',f)}}else {e.setData('dimArray',a.map(e.getData('valueArray'),function(a){return h?b:a*b/c}))}e.setData('normalizedDim',i/c)})}});g.TM={};g.TM.SliceAndDice=new b({compute:function(b){var a=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(a);var e=this.canvas.getSize(),f=this.config,c=e.width,d=e.height;this.graph.computeLevels(this.root,0,'ignore');a.getPos(b).setc(-c/2,-d/2);a.setData('width',c,b);a.setData('height',d+f.titleHeight,b);this.computePositions(a,a,this.layout.orientation,b);this.controller.onAfterCompute(a)},computePositions:function(e,b,f,a){var p=0;e.eachSubnode(function(c){p+=c.getData('area',a)});var g=this.config,u=g.offset,n=e.getData('width',a),m=Math.max(e.getData('height',a)-g.titleHeight,0),r=e==b?1:b.getData('area',a)/p;var k,j,l,d,c,i,h;var s=f=='h';if(s){f='v';k=m;j=n*r;l='height';d='y';c='x';i=g.titleHeight;h=0}else {f='h';k=m*r;j=n;l='width';d='x';c='y';i=0;h=g.titleHeight}var q=b.getPos(a);b.setData('width',j,a);b.setData('height',k,a);var o=0,t=this;b.eachSubnode(function(g){var j=g.getPos(a);j[d]=o+q[d]+i;j[c]=q[c]+h;t.computePositions(b,g,f,a);o+=g.getData(l,a)})}});g.TM.Area={compute:function(b){b=b||'current';var a=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(a);var e=this.config,g=this.canvas.getSize(),d=g.width,c=g.height,f=e.offset,j=d-f,i=c-f;this.graph.computeLevels(this.root,0,'ignore');a.getPos(b).setc(-d/2,-c/2);a.setData('width',d,b);a.setData('height',c,b);var h={top:-c/2+e.titleHeight,left:-d/2,width:j,height:i-e.titleHeight};this.computePositions(a,h,b);this.controller.onAfterCompute(a)},computeDim:function(b,a,c,e,f,d){if(b.length+a.length==1){var i=b.length==1?b:a;this.layoutLast(i,c,e,d);return}if(b.length>=2&&a.length==0){a=[b.shift()]}if(b.length==0){if(a.length>0){this.layoutRow(a,c,e,d)}return}var g=b[0];if(f(a,c)>=f([g].concat(a),c)){this.computeDim(b.slice(1),a.concat([g]),c,e,f,d)}else {var h=this.layoutRow(a,c,e,d);this.computeDim(b,[],h.dim,h,f,d)}},worstAspectRatio:function(d,i){if(!d||d.length==0){return Number.MAX_VALUE}var f=0,c=0,b=Number.MAX_VALUE;for(var e=0,j=d.length;e<j;e++){var a=d[e]._area;f+=a;b=b<a?b:a;c=c>a?c:a}var h=i*i,g=f*f;return Math.max(h*c/g,g/(h*b))},avgAspectRatio:function(a,b){if(!a||a.length==0){return Number.MAX_VALUE}var e=0;for(var d=0,f=a.length;d<f;d++){var g=a[d]._area;var c=g/b;e+=b>c?b/c:c/b}return e/f},layoutLast:function(d,e,a,b){var c=d[0];c.getPos(b).setc(a.left,a.top);c.setData('width',a.width,b);c.setData('height',a.height,b)}};g.TM.Squarified=new b({Implements:g.TM.Area,computePositions:function(g,a,b){var f=this.config,i=Math.max;if(a.width>=a.height){this.layout.orientation='h'}else {this.layout.orientation='v'}var d=g.getSubnodes([1,1],'ignore');if(d.length>0){this.processChildrenLayout(g,d,a,b);for(var e=0,k=d.length;e<k;e++){var c=d[e],j=f.offset,l=i(c.getData('height',b)-j-f.titleHeight,0),m=i(c.getData('width',b)-j,0),h=c.getPos(b);a={width:m,height:l,top:h.y+f.titleHeight,left:h.x};this.computePositions(c,a,b)}}},processChildrenLayout:function(l,b,c,f){var h=c.width*c.height;var a,g=b.length,e=0,d=[];for(a=0;a<g;a++){d[a]=parseFloat(b[a].getData('area',f));e+=d[a]}for(a=0;a<g;a++){b[a]._area=h*d[a]/e}var k=this.layout.horizontal()?c.height:c.width;b.sort(function(d,a){var e=a._area-d._area;return e?e:a.id==d.id?0:a.id<d.id?1:-1});var j=[b[0]];var i=b.slice(1);this.squarify(i,j,k,c,f)},squarify:function(d,b,c,a,e){this.computeDim(d,b,c,a,this.worstAspectRatio,e)},layoutRow:function(c,b,a,d){if(this.layout.horizontal()){return this.layoutV(c,b,a,d)}else {return this.layoutH(c,b,a,d)}},layoutV:function(e,n,b,h){var l=0,i=function(a){return a};a.each(e,function(a){l+=a._area});var f=i(l/n),k=0;for(var d=0,m=e.length;d<m;d++){var j=i(e[d]._area/f);var g=e[d];g.getPos(h).setc(b.left,b.top+k);g.setData('width',f,h);g.setData('height',j,h);k+=j}var c={height:b.height,width:b.width-f,top:b.top,left:b.left+f};c.dim=Math.min(c.width,c.height);if(c.dim!=c.height){this.layout.change()}return c},layoutH:function(h,e,b,i){var j=0;a.each(h,function(a){j+=a._area});var f=j/e,m=b.top,k=0;for(var g=0,l=h.length;g<l;g++){var d=h[g];var e=d._area/f;d.getPos(i).setc(b.left+k,m);d.setData('width',e,i);d.setData('height',f,i);k+=e}var c={height:b.height-f,width:b.width,top:b.top+f,left:b.left};c.dim=Math.min(c.width,c.height);if(c.dim!=c.width){this.layout.change()}return c}});g.TM.Strip=new b({Implements:g.TM.Area,computePositions:function(g,e,a){var c=g.getSubnodes([1,1],'ignore'),f=this.config,i=Math.max;if(c.length>0){this.processChildrenLayout(g,c,e,a);for(var d=0,k=c.length;d<k;d++){var b=c[d];var j=f.offset,l=i(b.getData('height',a)-j-f.titleHeight,0),m=i(b.getData('width',a)-j,0);var h=b.getPos(a);e={width:m,height:l,top:h.y+f.titleHeight,left:h.x};this.computePositions(b,e,a)}}},processChildrenLayout:function(l,c,b,f){var k=b.width*b.height;var a,g=c.length,e=0,d=[];for(a=0;a<g;a++){d[a]=+c[a].getData('area',f);e+=d[a]}for(a=0;a<g;a++){c[a]._area=k*d[a]/e}var j=this.layout.horizontal()?b.width:b.height;var i=[c[0]];var h=c.slice(1);this.stripify(h,i,j,b,f)},stripify:function(d,b,c,a,e){this.computeDim(d,b,c,a,this.avgAspectRatio,e)},layoutRow:function(c,b,a,d){if(this.layout.horizontal()){return this.layoutH(c,b,a,d)}else {return this.layoutV(c,b,a,d)}},layoutV:function(h,g,b,i){var k=0;a.each(h,function(a){k+=a._area});var d=k/g,j=0;for(var e=0,l=h.length;e<l;e++){var c=h[e];var f=c._area/d;c.getPos(i).setc(b.left,b.top+(g-f-j));c.setData('width',d,i);c.setData('height',f,i);j+=f}return {height:b.height,width:b.width-d,top:b.top,left:b.left+d,dim:g}},layoutH:function(f,h,b,g){var i=0;a.each(f,function(a){i+=a._area});var d=i/h,m=b.height-d,k=0;for(var e=0,l=f.length;e<l;e++){var c=f[e];var j=c._area/d;c.getPos(g).setc(b.left+k,b.top+m);c.setData('width',j,g);c.setData('height',d,g);k+=j}return {height:b.height-d,width:b.width,top:b.top,left:b.left,dim:h}}});g.Icicle=new b({compute:function(b){b=b||'current';var a=this.graph.getNode(this.root),i=this.config,k=this.canvas.getSize(),e=k.width,d=k.height,m=i.offset,l=i.constrained?i.levelsToShow:Number.MAX_VALUE;this.controller.onBeforeCompute(a);c.Util.computeLevels(this.graph,a.id,0,'ignore');var g=0;c.Util.eachLevel(a,0,!1,function(c,a){if(a>g){g=a}});var h=this.graph.getNode(this.clickedNode&&this.clickedNode.id||a.id);var f=Math.min(g,l-1);var j=h._depth;if(this.layout.horizontal()){this.computeSubtree(h,-e/2,-d/2,e/(f+1),d,j,f,b)}else {this.computeSubtree(h,-e/2,-d/2,e,d/(f+1),j,f,b)}},computeSubtree:function(h,i,g,k,j,n,m,f){h.getPos(f).setc(i,g);h.setData('width',k,f);h.setData('height',j,f);var d,p=0,l=0;var b=c.Util.getSubnodes(h,[1,1],'ignore');if(!b.length){return}a.each(b,function(a){l+=a.getData('dim')});for(var e=0,o=b.length;e<o;e++){if(this.layout.horizontal()){d=j*b[e].getData('dim')/l;this.computeSubtree(b[e],i+k,g,k,d,n,m,f);g+=d}else {d=k*b[e].getData('dim')/l;this.computeSubtree(b[e],i,g+j,d,j,n,m,f);i+=d}}}});$jit.Icicle=new b({Implements:[k,j,g.Icicle],layout:{orientation:'h',vertical:function(){return this.orientation=='v'},horizontal:function(){return this.orientation=='h'},change:function(){this.orientation=this.vertical()?'h':'v'}},initialize:function(e){var g={animate:!1,orientation:'h',offset:2,levelsToShow:Number.MAX_VALUE,constrained:!1,Node:{type:'rectangle',overridable:!0},Edge:{type:'none'},Label:{type:'Native'},duration:700,fps:45};var h=d('Canvas','Node','Edge','Fx','Tips','NodeStyles','Events','Navigation','Controller','Label');this.controller=this.config=a.merge(h,g,e);this.layout.orientation=this.config.orientation;var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:f,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);this.labels=new $jit.Icicle.Label[this.config.Label.type](this);this.fx=new $jit.Icicle.Plot(this,$jit.Icicle);this.op=new $jit.Icicle.Op(this);this.group=new $jit.Icicle.Group(this);this.clickedNode=null;this.initializeExtras()},refresh:function(){var a=this.config.Label.type;if(a!='Native'){var b=this;this.graph.eachNode(function(a){b.labels.hideLabel(a,!1)})}this.compute();this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(b){if(this.busy){return}this.busy=!0;var a=this,d=this.config;var e={onComplete:function(){if(d.request){a.compute()}if(d.animate){a.graph.nodeList.setDataset(['current','end'],{alpha:[1,0]});c.Util.eachSubgraph(b,function(a){a.setData('alpha',1,'end')},'ignore');a.fx.animate({duration:500,modes:['node-property:alpha'],onComplete:function(){a.clickedNode=b;a.compute('end');a.fx.animate({modes:['linear','node-property:width:height'],duration:1000,onComplete:function(){a.busy=!1;a.clickedNode=b}})}})}else {a.clickedNode=b;a.busy=!1;a.refresh()}}};if(d.request){this.requestNodes(clickedNode,e)}else {e.onComplete()}},out:function(){if(this.busy){return}var a=this,d=c.Util,h=this.config,f=this.graph,i=d.getParents(f.getNode(this.clickedNode&&this.clickedNode.id||this.root)),b=i[0],g=b,e=this.clickedNode;this.busy=!0;this.events.hoveredNode=!1;if(!b){this.busy=!1;return}callback={onComplete:function(){a.clickedNode=b;if(h.request){a.requestNodes(b,{onComplete:function(){a.compute();a.plot();a.busy=!1}})}else {a.compute();a.plot();a.busy=!1}}};if(h.animate){this.clickedNode=g;this.compute('end');this.clickedNode=e;this.fx.animate({modes:['linear','node-property:width:height'],duration:1000,onComplete:function(){a.clickedNode=g;f.nodeList.setDataset(['current','end'],{alpha:[0,1]});d.eachSubgraph(e,function(a){a.setData('alpha',1)},'ignore');a.fx.animate({duration:500,modes:['node-property:alpha'],onComplete:function(){callback.onComplete()}})}})}else {callback.onComplete()}},requestNodes:function(f,h){var b=a.merge(this.controller,h),e=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(b.request){var d=[],g=f._depth;c.Util.eachLevel(f,0,e,function(a){if(a.drawn&&!c.Util.anySubnode(a)){d.push(a);a._level=a._depth-g;if(this.config.constrained){a._level=e-a._level}}});this.group.requestNodes(d,b)}else {b.onComplete()}}});$jit.Icicle.Op=new b({Implements:c.Op});$jit.Icicle.Group=new b({initialize:function(a){this.viz=a;this.canvas=a.canvas;this.config=a.config},requestNodes:function(b,f){var i=0,e=b.length,h={};var g=function(){f.onComplete()};var d=this.viz;if(e==0){g()}for(var a=0;a<e;a++){h[b[a].id]=b[a];f.request(b[a].id,b[a]._level,{onComplete:function(h,a){if(a&&a.children){a.id=h;d.op.sum(a,{type:'nothing'})}if(++i==e){c.Util.computeLevels(d.graph,d.root,0);g()}}})}}});$jit.Icicle.Plot=new b({Implements:c.Plot,plot:function(c,f){c=c||this.viz.controller;var b=this.viz,e=b.graph,d=e.getNode(b.clickedNode&&b.clickedNode.id||b.root),g=d._depth;b.canvas.clear();this.plotTree(d,a.merge(c,{withLabels:!0,hideLabels:!1,plotSubtree:function(d,a){return !b.config.constrained||a._depth-g<b.config.levelsToShow}}),f)}});$jit.Icicle.Label={};$jit.Icicle.Label.Native=new b({Implements:c.Label.Native,renderLabel:function(g,a,i){var d=g.getCtx(),e=a.getData('width'),c=a.getData('height'),f=a.getLabelData('size'),h=d.measureText(a.name);if(c<f*1.5||e<h.width){return}var b=a.pos.getc(!0);d.fillText(a.name,b.x+e/2,b.y+c/2)}});$jit.Icicle.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,f){var d=b.pos.getc(!0),g=this.viz.canvas;var e=g.getSize();var c={x:Math.round(d.x+e.width/2),y:Math.round(d.y+e.height/2)};a.setAttribute('x',c.x);a.setAttribute('y',c.y);f.onPlaceLabel(a,b)}});$jit.Icicle.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(f,b,g){var d=b.pos.getc(!0),h=this.viz.canvas;var e=h.getSize();var c={x:Math.round(d.x+e.width/2),y:Math.round(d.y+e.height/2)};var a=f.style;a.left=c.x+'px';a.top=c.y+'px';a.display='';g.onPlaceLabel(f,b)}});$jit.Icicle.Plot.NodeTypes=new b({none:{render:a.empty},rectangle:{render:function(f,o,p){var m=this.viz.config;var b=m.offset;var d=f.getData('width');var c=f.getData('height');var h=f.getData('border');var g=f.pos.getc(!0);var j=g.x+b/2,i=g.y+b/2;var e=o.getCtx();if(d-b<2||c-b<2){return}if(m.cushion){var l=f.getData('color');var k=e.createRadialGradient(j+(d-b)/2,i+(c-b)/2,1,j+(d-b)/2,i+(c-b)/2,d<c?c:d);var n=a.rgbToHex(a.map(a.hexToRgb(l),function(a){return a*0.3>>0}));k.addColorStop(0,l);k.addColorStop(1,n);e.fillStyle=k}if(h){e.strokeStyle=h;e.lineWidth=3}e.fillRect(j,i,Math.max(0,d-b),Math.max(0,c-b));h&&e.strokeRect(g.x,g.y,d,c)},contains:function(a,e){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(a,this.viz.clickedNode.id)){return !1}var d=a.pos.getc(!0),c=a.getData('width'),b=a.getData('height');return this.nodeHelper.rectangle.contains({x:d.x+c/2,y:d.y+b/2},e,c,b)}}});$jit.Icicle.Plot.EdgeTypes=new b({none:a.empty});g.ForceDirected=new b({getOptions:function(h){var c=this.canvas.getSize();var a=c.width,b=c.height;var d=0;this.graph.eachNode(function(a){d++});var e=a*b/d,g=Math.sqrt(e);var f=this.config.levelDistance;return {width:a,height:b,tstart:a*0.1,nodef:function(a){return e/(a||1)},edgef:function(a){return g*(a-f)}}},compute:function(d,e){var b=a.splat(d||['current','start','end']);var c=this.getOptions();t.compute(this.graph,b,this.config);this.graph.computeLevels(this.root,0,'ignore');this.graph.eachNode(function(g){a.each(b,function(i){var h=g.getPos(i);if(h.equals(f.KER)){h.x=c.width/5*(Math.random()-0.5);h.y=c.height/5*(Math.random()-0.5)}g.disp={};a.each(b,function(a){g.disp[a]=m(0,0)})})});this.computePositions(b,c,e)},computePositions:function(e,b,d){var a=this.config.iterations,c=0,f=this;if(d){(function w(){for(var h=d.iter,g=0;g<h;g++){b.t=b.tstart;if(a){b.t*=1-c++/(a-1)}f.computePositionStep(e,b);if(a&&c>=a){d.onComplete();return}}d.onStep(Math.round(c/(a-1)*100));setTimeout(w,1)})()}else {for(;c<a;c++){b.t=b.tstart*(1-c/(a-1));this.computePositionStep(e,b)}}},computePositionStep:function(e,d){var c=this.graph;var f=Math.min,h=Math.max;var b=m(0,0);c.eachNode(function(f){a.each(e,function(a){f.disp[a].x=0;f.disp[a].y=0});c.eachNode(function(c){if(c.id!=f.id){a.each(e,function(a){var h=f.getPos(a),g=c.getPos(a);b.x=h.x-g.x;b.y=h.y-g.y;var i=b.norm()||1;f.disp[a].$add(b.$scale(d.nodef(i)/i))})}})});var j=!!c.getNode(this.root).visited;c.eachNode(function(c){c.eachAdjacency(function(g){var f=g.nodeTo;if(!!f.visited===j){a.each(e,function(a){var i=c.getPos(a),h=f.getPos(a);b.x=i.x-h.x;b.y=i.y-h.y;var j=b.norm()||1;c.disp[a].$add(b.$scale(-d.edgef(j)/j));f.disp[a].$add(b.$scale(-1))})}});c.visited=!j});var i=d.t,k=d.width/2,g=d.height/2;c.eachNode(function(b){a.each(e,function(a){var c=b.disp[a];var j=c.norm()||1;var a=b.getPos(a);a.$add(m(c.x*f(Math.abs(c.x),i)/j,c.y*f(Math.abs(c.y),i)/j));a.x=f(k,h(-k,a.x));a.y=f(g,h(-g,a.y))})})}});$jit.ForceDirected=new b({Implements:[k,j,g.ForceDirected],initialize:function(g){var e=$jit.ForceDirected;var h={iterations:50,levelDistance:50};this.controller=this.config=a.merge(d('Canvas','Node','Edge','Fx','Tips','NodeStyles','Events','Navigation','Controller','Label'),h,g);var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:f,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this,e);this.op=new e.Op(this);this.json=null;this.busy=!1;this.initializeExtras()},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute('end')},computeIncremental:function(b){b=a.merge({iter:20,property:'end',onStep:a.empty,onComplete:a.empty},b||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.compute(b.property,b)},plot:function(){this.fx.plot()},animate:function(b){this.fx.animate(a.merge({modes:['linear']},b||{}))}});$jit.ForceDirected.$extend=!0;(function(d){d.Op=new b({Implements:c.Op});d.Plot=new b({Implements:c.Plot});d.Label={};d.Label.Native=new b({Implements:c.Label.Native});d.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(b,e,h){var g=e.pos.getc(!0),a=this.viz.canvas,l=a.translateOffsetX,k=a.translateOffsetY,j=a.scaleOffsetX,i=a.scaleOffsetY,f=a.getSize();var c={x:Math.round(g.x*j+l+f.width/2),y:Math.round(g.y*i+k+f.height/2)};b.setAttribute('x',c.x);b.setAttribute('y',c.y);h.onPlaceLabel(b,e)}});d.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(h,e,j){var g=e.pos.getc(!0),a=this.viz.canvas,i=a.translateOffsetX,m=a.translateOffsetY,l=a.scaleOffsetX,k=a.scaleOffsetY,f=a.getSize();var b={x:Math.round(g.x*l+i+f.width/2),y:Math.round(g.y*k+m+f.height/2)};var c=h.style;c.left=b.x+'px';c.top=b.y+'px';c.display=this.fitsInCanvas(b,a)?'':'none';j.onPlaceLabel(h,e)}});d.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.circle.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.circle.contains(e,b,c)}},ellipse:{render:function(a,e){var b=a.pos.getc(!0),f=a.getData('width'),c=a.getData('height');this.nodeHelper.ellipse.render('fill',b,f,c,e)},contains:function(a,c){var b=a.pos.getc(!0),f=a.getData('width'),e=a.getData('height');return this.nodeHelper.ellipse.contains(b,c,f,e)}},square:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.square.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.square.contains(e,b,c)}},rectangle:{render:function(a,e){var b=a.pos.getc(!0),f=a.getData('width'),c=a.getData('height');this.nodeHelper.rectangle.render('fill',b,f,c,e)},contains:function(a,c){var b=a.pos.getc(!0),f=a.getData('width'),e=a.getData('height');return this.nodeHelper.rectangle.contains(b,c,f,e)}},triangle:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.triangle.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.triangle.contains(e,b,c)}},star:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.star.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.star.contains(e,b,c)}}});d.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,c){var b=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(b,e,c)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(e,c,b,this.edge.epsilon)}},arrow:{render:function(a,h){var f=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0),c=a.getData('dim'),b=a.data.$direction,g=b&&b.length>1&&b[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(f,e,c,g,h)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(e,c,b,this.edge.epsilon)}}})})($jit.ForceDirected);$jit.TM={};var e=$jit.TM;$jit.TM.$extend=!0;e.Base={layout:{orientation:'h',vertical:function(){return this.orientation=='v'},horizontal:function(){return this.orientation=='h'},change:function(){this.orientation=this.vertical()?'h':'v'}},initialize:function(g){var h={orientation:'h',titleHeight:13,offset:2,levelsToShow:0,constrained:!1,animate:!1,Node:{type:'rectangle',overridable:!0,width:3,height:3,color:'#444'},Label:{textAlign:'center',textBaseline:'top'},Edge:{type:'none'},duration:700,fps:45};this.controller=this.config=a.merge(d('Canvas','Node','Edge','Fx','Controller','Tips','NodeStyles','Events','Navigation','Label'),h,g);this.layout.orientation=this.config.orientation;var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:f,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this);this.op=new e.Op(this);this.group=new e.Group(this);this.geom=new e.Geom(this);this.clickedNode=null;this.busy=!1;this.initializeExtras()},refresh:function(){if(this.busy){return}this.busy=!0;var b=this;if(this.config.animate){this.compute('end');this.config.levelsToShow>0&&this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.fx.animate(a.merge(this.config,{modes:['linear','node-property:width:height'],onComplete:function(){b.busy=!1}}))}else {var c=this.config.Label.type;if(c!='Native'){var b=this;this.graph.eachNode(function(a){b.labels.hideLabel(a,!1)})}this.busy=!1;this.compute();this.config.levelsToShow>0&&this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.plot()}},plot:function(){this.fx.plot()},leaf:function(a){return a.getSubnodes([1,1],'ignore').length==0},enter:function(c){if(this.busy){return}this.busy=!0;var a=this,b=this.config,f=this.graph,d=c,g=this.clickedNode;var e={onComplete:function(){if(b.levelsToShow>0){a.geom.setRightLevelToShow(c)}if(b.levelsToShow>0||b.request){a.compute()}if(b.animate){f.nodeList.setData('alpha',0,'end');c.eachSubgraph(function(a){a.setData('alpha',1,'end')},'ignore');a.fx.animate({duration:500,modes:['node-property:alpha'],onComplete:function(){a.clickedNode=d;a.compute('end');a.clickedNode=g;a.fx.animate({modes:['linear','node-property:width:height'],duration:1000,onComplete:function(){a.busy=!1;a.clickedNode=d}})}})}else {a.busy=!1;a.clickedNode=c;a.refresh()}}};if(b.request){this.requestNodes(d,e)}else {e.onComplete()}},out:function(){if(this.busy){return}this.busy=!0;this.events.hoveredNode=!1;var a=this,c=this.config,e=this.graph,g=e.getNode(this.clickedNode&&this.clickedNode.id||this.root).getParents(),b=g[0],f=b,d=this.clickedNode;if(!b){this.busy=!1;return}callback={onComplete:function(){a.clickedNode=b;if(c.request){a.requestNodes(b,{onComplete:function(){a.compute();a.plot();a.busy=!1}})}else {a.compute();a.plot();a.busy=!1}}};if(c.levelsToShow>0){this.geom.setRightLevelToShow(b)}if(c.animate){this.clickedNode=f;this.compute('end');this.clickedNode=d;this.fx.animate({modes:['linear','node-property:width:height'],duration:1000,onComplete:function(){a.clickedNode=f;e.eachNode(function(a){a.setDataset(['current','end'],{alpha:[0,1]})},'ignore');d.eachSubgraph(function(a){a.setData('alpha',1)},'ignore');a.fx.animate({duration:500,modes:['node-property:alpha'],onComplete:function(){callback.onComplete()}})}})}else {callback.onComplete()}},requestNodes:function(e,g){var b=a.merge(this.controller,g),d=this.config.levelsToShow;if(b.request){var c=[],f=e._depth;e.eachLevel(0,d,function(a){var b=d-(a._depth-f);if(a.drawn&&!a.anySubnode()&&b>0){c.push(a);a._level=b}});this.group.requestNodes(c,b)}else {b.onComplete()}},reposition:function(){this.compute('end')}};e.Op=new b({Implements:c.Op,initialize:function(a){this.viz=a}});e.Geom=new b({Implements:c.Geom,getRightLevelToShow:function(){return this.viz.config.levelsToShow},setRightLevelToShow:function(a){var b=this.getRightLevelToShow(),c=this.viz.labels;a.eachLevel(0,b+1,function(d){var e=d._depth-a._depth;if(e>b){d.drawn=!1;d.exist=!1;d.ignore=!0;c.hideLabel(d,!1)}else {d.drawn=!0;d.exist=!0;delete d.ignore}});a.drawn=!0;delete a.ignore}});e.Group=new b({initialize:function(a){this.viz=a;this.canvas=a.canvas;this.config=a.config},requestNodes:function(b,e){var h=0,d=b.length,g={};var f=function(){e.onComplete()};var c=this.viz;if(d==0){f()}for(var a=0;a<d;a++){g[b[a].id]=b[a];e.request(b[a].id,b[a]._level,{onComplete:function(g,a){if(a&&a.children){a.id=g;c.op.sum(a,{type:'nothing'})}if(++h==d){c.graph.computeLevels(c.root,0);f()}}})}}});e.Plot=new b({Implements:c.Plot,initialize:function(a){this.viz=a;this.config=a.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new r();this.nodeTypes=new e.Plot.NodeTypes();this.edgeTypes=new e.Plot.EdgeTypes();this.labels=a.labels},plot:function(d,c){var b=this.viz,e=b.graph;b.canvas.clear();this.plotTree(e.getNode(b.clickedNode&&b.clickedNode.id||b.root),a.merge(b.config,d||{},{withLabels:!0,hideLabels:!1,plotSubtree:function(a,b){return a.anySubnode('exist')}}),c)}});e.Label={};e.Label.Native=new b({Implements:c.Label.Native,initialize:function(a){this.config=a.config;this.leaf=a.leaf},renderLabel:function(g,a,h){if(!this.leaf(a)&&!this.config.titleHeight){return}var b=a.pos.getc(!0),f=g.getCtx(),c=a.getData('width'),i=a.getData('height'),e=b.x+c/2,d=b.y;f.fillText(a.name,e,d,c)}});e.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a;this.leaf=a.leaf;this.config=a.config},placeLabel:function(b,c,g){var e=c.pos.getc(!0),a=this.viz.canvas,k=a.translateOffsetX,j=a.translateOffsetY,i=a.scaleOffsetX,h=a.scaleOffsetY,d=a.getSize();var f={x:Math.round(e.x*i+k+d.width/2),y:Math.round(e.y*h+j+d.height/2)};b.setAttribute('x',f.x);b.setAttribute('y',f.y);if(!this.leaf(c)&&!this.config.titleHeight){b.style.display='none'}g.onPlaceLabel(b,c)}});e.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a;this.leaf=a.leaf;this.config=a.config},placeLabel:function(d,a,j){var h=a.pos.getc(!0),c=this.viz.canvas,l=c.translateOffsetX,k=c.translateOffsetY,i=c.scaleOffsetX,g=c.scaleOffsetY,f=c.getSize();var e={x:Math.round(h.x*i+l+f.width/2),y:Math.round(h.y*g+k+f.height/2)};var b=d.style;b.left=e.x+'px';b.top=e.y+'px';b.width=a.getData('width')*i+'px';b.height=a.getData('height')*g+'px';b.zIndex=a._depth*100;b.display='';if(!this.leaf(a)&&!this.config.titleHeight){d.style.display='none'}j.onPlaceLabel(d,a)}});e.Plot.NodeTypes=new b({none:{render:a.empty},rectangle:{render:function(g,q,r){var o=this.viz.leaf(g),l=this.config,b=l.offset,n=l.titleHeight,f=g.pos.getc(!0),d=g.getData('width'),e=g.getData('height'),h=g.getData('border'),c=q.getCtx(),j=f.x+b/2,i=f.y+b/2;if(d<=b||e<=b){return}if(o){if(l.cushion){var k=c.createRadialGradient(j+(d-b)/2,i+(e-b)/2,1,j+(d-b)/2,i+(e-b)/2,d<e?e:d);var m=g.getData('color');var p=a.rgbToHex(a.map(a.hexToRgb(m),function(a){return a*0.2>>0}));k.addColorStop(0,m);k.addColorStop(1,p);c.fillStyle=k}c.fillRect(j,i,d-b,e-b);if(h){c.save();c.strokeStyle=h;c.strokeRect(j,i,d-b,e-b);c.restore()}}else {if(n>0){c.fillRect(f.x+b/2,f.y+b/2,d-b,n-b);if(h){c.save();c.strokeStyle=h;c.strokeRect(f.x+b/2,f.y+b/2,d-b,e-b);c.restore()}}}},contains:function(a,e){if(this.viz.clickedNode&&!a.isDescendantOf(this.viz.clickedNode.id)||a.ignore){return !1}var b=a.pos.getc(!0),d=a.getData('width'),f=this.viz.leaf(a),c=f?a.getData('height'):this.config.titleHeight;return this.nodeHelper.rectangle.contains({x:b.x+d/2,y:b.y+c/2},e,d,c)}}});e.Plot.EdgeTypes=new b({none:a.empty});e.SliceAndDice=new b({Implements:[k,j,e.Base,g.TM.SliceAndDice]});e.Squarified=new b({Implements:[k,j,e.Base,g.TM.Squarified]});e.Strip=new b({Implements:[k,j,e.Base,g.TM.Strip]});$jit.RGraph=new b({Implements:[k,j,g.Radial],initialize:function(f){var e=$jit.RGraph;var g={interpolation:'linear',levelDistance:100};this.controller=this.config=a.merge(d('Canvas','Node','Edge','Fx','Controller','Tips','NodeStyles','Events','Navigation','Label'),g,f);var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:h,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this,e);this.op=new e.Op(this);this.json=null;this.root=null;this.busy=!1;this.parent=!1;this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return (b._depth+1)*a}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute('end')},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(g){var a=!1;var d=this.graph.getNode(g);var c=d.getParents();var b=c.length>0?c[0]:!1;if(b){var h=b.pos.getc(),f=d.pos.getc();var e=h.add(f.scale(-1));a=Math.atan2(e.y,e.x);if(a<0){a+=2*Math.PI}}return {parent:b,theta:a}},tagChildren:function(e,f){if(e.angleSpan){var a=[];e.eachAdjacency(function(b){a.push(b.nodeTo)},'ignore');var d=a.length;for(var c=0;c<d&&f!=a[c].id;c++){}for(var b=(c+1)%d,g=0;f!=a[b].id;b=(b+1)%d){a[b].dist=g++}}},onClick:function(b,c){if(this.root!=b&&!this.busy){this.busy=!0;this.root=b;var g=this;this.controller.onBeforeCompute(this.graph.getNode(b));var d=this.getNodeAndParentAngle(b);this.tagChildren(d.parent,b);this.parent=d.parent;this.compute('end');var f=d.theta-d.parent.endPos.theta;this.graph.eachNode(function(a){a.endPos.set(a.endPos.getp().add(p(f,0)))});var e=this.config.interpolation;c=a.merge({onComplete:a.empty},c||{});this.fx.animate(a.merge({hideLabels:!0,modes:[e]},c,{onComplete:function(){g.busy=!1;c.onComplete()}}))}}});$jit.RGraph.$extend=!0;(function(d){d.Op=new b({Implements:c.Op});d.Plot=new b({Implements:c.Plot});d.Label={};d.Label.Native=new b({Implements:c.Label.Native});d.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(b,e,h){var g=e.pos.getc(!0),a=this.viz.canvas,l=a.translateOffsetX,k=a.translateOffsetY,j=a.scaleOffsetX,i=a.scaleOffsetY,f=a.getSize();var c={x:Math.round(g.x*j+l+f.width/2),y:Math.round(g.y*i+k+f.height/2)};b.setAttribute('x',c.x);b.setAttribute('y',c.y);h.onPlaceLabel(b,e)}});d.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(h,e,j){var g=e.pos.getc(!0),a=this.viz.canvas,i=a.translateOffsetX,m=a.translateOffsetY,l=a.scaleOffsetX,k=a.scaleOffsetY,f=a.getSize();var b={x:Math.round(g.x*l+i+f.width/2),y:Math.round(g.y*k+m+f.height/2)};var c=h.style;c.left=b.x+'px';c.top=b.y+'px';c.display=this.fitsInCanvas(b,a)?'':'none';j.onPlaceLabel(h,e)}});d.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.circle.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.circle.contains(e,b,c)}},ellipse:{render:function(a,e){var b=a.pos.getc(!0),f=a.getData('width'),c=a.getData('height');this.nodeHelper.ellipse.render('fill',b,f,c,e)},contains:function(a,c){var b=a.pos.getc(!0),f=a.getData('width'),e=a.getData('height');return this.nodeHelper.ellipse.contains(b,c,f,e)}},square:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.square.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.square.contains(e,b,c)}},rectangle:{render:function(a,e){var b=a.pos.getc(!0),f=a.getData('width'),c=a.getData('height');this.nodeHelper.rectangle.render('fill',b,f,c,e)},contains:function(a,c){var b=a.pos.getc(!0),f=a.getData('width'),e=a.getData('height');return this.nodeHelper.rectangle.contains(b,c,f,e)}},triangle:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.triangle.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.triangle.contains(e,b,c)}},star:{render:function(a,c){var b=a.pos.getc(!0),e=a.getData('dim');this.nodeHelper.star.render('fill',b,e,c)},contains:function(a,b){var e=a.pos.getc(!0),c=a.getData('dim');return this.nodeHelper.star.contains(e,b,c)}}});d.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,c){var b=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(b,e,c)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(e,c,b,this.edge.epsilon)}},arrow:{render:function(a,h){var f=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0),c=a.getData('dim'),b=a.data.$direction,g=b&&b.length>1&&b[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(f,e,c,g,h)},contains:function(a,b){var e=a.nodeFrom.pos.getc(!0),c=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(e,c,b,this.edge.epsilon)}}})})($jit.RGraph);f.prototype.moebiusTransformation=function(b){var c=this.add(b);var a=b.$conjugate().$prod(this);a.x++;return c.$div(a)};c.Util.moebiusTransformation=function(e,c,a,b,d){this.eachNode(e,function(g){for(var f=0;f<a.length;f++){var i=c[f].scale(-1),h=b?b:a[f];g.getPos(a[f]).set(g.getPos(h).getc().moebiusTransformation(i))}},d)};$jit.Hypertree=new b({Implements:[k,j,g.Radial],initialize:function(f){var e=$jit.Hypertree;var g={radius:'auto',offset:0,Edge:{type:'hyperline'},duration:1500,fps:35};this.controller=this.config=a.merge(d('Canvas','Node','Edge','Fx','Tips','NodeStyles','Events','Navigation','Controller','Label'),g,f);var b=this.config;if(b.useCanvas){this.canvas=b.useCanvas;this.config.labelContainer=this.canvas.id+'-label'}else {if(b.background){b.background=a.merge({type:'Circles'},b.background)}this.canvas=new i(this,b);this.config.labelContainer=(typeof b.injectInto=='string'?b.injectInto:b.injectInto.id)+'-label'}this.graphOptions={klass:h,Node:{selected:!1,exist:!0,drawn:!0}};this.graph=new c(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new e.Label[b.Label.type](this);this.fx=new e.Plot(this,e);this.op=new e.Op(this);this.json=null;this.root=null;this.busy=!1;this.initializeExtras()},createLevelDistanceFunc:function(){var d=this.getRadius();var b=0,e=Math.max,f=this.config;this.graph.eachNode(function(a){b=e(a._depth,b)},'ignore');b++;var c=function(a){return function(b){b.scale=d;var e=b._depth+1;var c=0,g=Math.pow;while(e){c+=g(a,e--)}return c-f.offset}};for(var a=0.51;a<=1;a+=0.01){var g=(1-Math.pow(a,b))/(1-a);if(g>=2){return c(a-0.01)}}return c(0.75)},getRadius:function(){var a=this.config.radius;if(a!=='auto'){return a}var b=this.canvas.getSize();return Math.min(b.width,b.height)/2},refresh:function(a){if(a){this.reposition();this.graph.eachNode(function(b){b.startPos.rho=b.pos.rho=b.endPos.rho;b.startPos.theta=b.pos.theta=b.endPos.theta})}else {this.compute()}this.plot()},reposition:function(){this.compute('end');var a=this.graph.getNode(this.root).pos.getc().scale(-1);c.Util.moebiusTransformation(this.graph,[a],['end'],'end','ignore');this.graph.eachNode(function(a){if(a.ignore){a.endPos.rho=a.pos.rho;a.endPos.theta=a.pos.theta}})},plot:function(){this.fx.plot()},onClick:function(c,a){var b=this.graph.getNode(c).pos.getc(!0);this.move(b,a)},move:function(d,b){var c=m(d.x,d.y);if(this.busy===!1&&c.norm()<1){this.busy=!0;var e=this.graph.getClosestNodeToPos(c),f=this;this.graph.computeLevels(e.id,0);this.controller.onBeforeCompute(e);b=a.merge({onComplete:a.empty},b||{});this.fx.animate(a.merge({modes:['moebius'],hideLabels:!0},b,{onComplete:function(){f.busy=!1;b.onComplete()}}),c)}}});$jit.Hypertree.$extend=!0;(function(d){d.Op=new b({Implements:c.Op});d.Plot=new b({Implements:c.Plot});d.Label={};d.Label.Native=new b({Implements:c.Label.Native,initialize:function(a){this.viz=a},renderLabel:function(f,b,g){var e=f.getCtx();var c=b.pos.getc(!0);var a=this.viz.getRadius();e.fillText(b.name,c.x*a,c.y*a)}});d.Label.SVG=new b({Implements:c.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(b,e,j){var g=e.pos.getc(!0),a=this.viz.canvas,i=a.translateOffsetX,m=a.translateOffsetY,l=a.scaleOffsetX,k=a.scaleOffsetY,f=a.getSize(),h=this.viz.getRadius();var c={x:Math.round(g.x*l*h+i+f.width/2),y:Math.round(g.y*k*h+m+f.height/2)};b.setAttribute('x',c.x);b.setAttribute('y',c.y);j.onPlaceLabel(b,e)}});d.Label.HTML=new b({Implements:c.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(h,e,k){var g=e.pos.getc(!0),a=this.viz.canvas,j=a.translateOffsetX,n=a.translateOffsetY,m=a.scaleOffsetX,l=a.scaleOffsetY,f=a.getSize(),i=this.viz.getRadius();var b={x:Math.round(g.x*m*i+j+f.width/2),y:Math.round(g.y*l*i+n+f.height/2)};var c=h.style;c.left=b.x+'px';c.top=b.y+'px';c.display=this.fitsInCanvas(b,a)?'':'none';k.onPlaceLabel(h,e)}});d.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(c,e){var f=this.node,a=c.getData('dim'),b=c.pos.getc();a=f.transform?a*(1-b.squaredNorm()):a;b.$scale(c.scale);if(a>0.2){this.nodeHelper.circle.render('fill',b,a,e)}},contains:function(a,b){var c=a.getData('dim'),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.circle.contains(e,b,c)}},ellipse:{render:function(a,e){var b=a.pos.getc().$scale(a.scale),f=a.getData('width'),c=a.getData('height');this.nodeHelper.ellipse.render('fill',b,f,c,e)},contains:function(a,c){var f=a.getData('width'),e=a.getData('height'),b=a.pos.getc().$scale(a.scale);return this.nodeHelper.circle.contains(b,c,f,e)}},square:{render:function(c,e){var f=this.node,a=c.getData('dim'),b=c.pos.getc();a=f.transform?a*(1-b.squaredNorm()):a;b.$scale(c.scale);if(a>0.2){this.nodeHelper.square.render('fill',b,a,e)}},contains:function(a,b){var c=a.getData('dim'),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.square.contains(e,b,c)}},rectangle:{render:function(c,g){var f=this.node,b=c.getData('width'),a=c.getData('height'),e=c.pos.getc();b=f.transform?b*(1-e.squaredNorm()):b;a=f.transform?a*(1-e.squaredNorm()):a;e.$scale(c.scale);if(b>0.2&&a>0.2){this.nodeHelper.rectangle.render('fill',e,b,a,g)}},contains:function(a,c){var f=a.getData('width'),e=a.getData('height'),b=a.pos.getc().$scale(a.scale);return this.nodeHelper.rectangle.contains(b,c,f,e)}},triangle:{render:function(c,e){var f=this.node,a=c.getData('dim'),b=c.pos.getc();a=f.transform?a*(1-b.squaredNorm()):a;b.$scale(c.scale);if(a>0.2){this.nodeHelper.triangle.render('fill',b,a,e)}},contains:function(a,b){var c=a.getData('dim'),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.triangle.contains(e,b,c)}},star:{render:function(c,e){var f=this.node,a=c.getData('dim'),b=c.pos.getc();a=f.transform?a*(1-b.squaredNorm()):a;b.$scale(c.scale);if(a>0.2){this.nodeHelper.star.render('fill',b,a,e)}},contains:function(a,b){var c=a.getData('dim'),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.star.contains(e,b,c)}}});d.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(b,f){var e=b.nodeFrom.pos.getc(!0),c=b.nodeTo.pos.getc(!0),a=b.nodeFrom.scale;this.edgeHelper.line.render({x:e.x*a,y:e.y*a},{x:c.x*a,y:c.y*a},f)},contains:function(b,f){var c=b.nodeFrom.pos.getc(!0),e=b.nodeTo.pos.getc(!0),a=b.nodeFrom.scale;this.edgeHelper.line.contains({x:c.x*a,y:c.y*a},{x:e.x*a,y:e.y*a},f,this.edge.epsilon)}},arrow:{render:function(a,i){var f=a.nodeFrom.pos.getc(!0),e=a.nodeTo.pos.getc(!0),b=a.nodeFrom.scale,g=a.getData('dim'),c=a.data.$direction,h=c&&c.length>1&&c[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render({x:f.x*b,y:f.y*b},{x:e.x*b,y:e.y*b},g,h,i)},contains:function(b,f){var c=b.nodeFrom.pos.getc(!0),e=b.nodeTo.pos.getc(!0),a=b.nodeFrom.scale;this.edgeHelper.arrow.contains({x:c.x*a,y:c.y*a},{x:e.x*a,y:e.y*a},f,this.edge.epsilon)}},hyperline:{render:function(a,e){var c=a.nodeFrom.pos.getc(),b=a.nodeTo.pos.getc(),f=this.viz.getRadius();this.edgeHelper.hyperline.render(c,b,f,e)},contains:a.lambda(!1)}})})($jit.Hypertree)})();